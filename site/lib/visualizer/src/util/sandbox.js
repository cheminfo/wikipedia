define(function(){function Sandbox(){this.contextData=[],this.contextString="",this.scriptID=0}function safeEval(script,ctxString,__ctx__,Sandbox){return eval(ctxString+script)}return Sandbox.prototype.setContext=function(a){var b="",c=[];Object.keys(a).forEach(function(d,e){b+="var "+d+" = __ctx__["+e+"]; ",c.push(a[d])}),this.contextString=b,this.contextData=c},Sandbox.prototype.run=function(a,b){return b&&(a+="//# sourceURL="+b+"@"+this.scriptID++),safeEval(a,this.contextString,this.contextData.slice())},Sandbox});