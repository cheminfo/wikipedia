'use strict';define(["lodash","d3","src/util/util","chroma"],function(a,b,c,d){"use strict";function e(a){return"left"===a||"right"===a?["0%","0%","0%","100%"]:["0%","0%","100%","0%"]}function f(a){var b=0,c=h(a);return i(a)?(("bottom"===c||"top"===c)&&(b+=k/2),"left"===c&&(b+=k),b):b}function g(a){var b=0;if(!i(a))return b;var c=h(a);return("left"===c||"right"===c)&&(b+=k/2),"top"===c&&(b+=k),b}function h(a){return a.orientation||a.axis&&a.axis.orientation||"top"}function i(a){return!!a.axis}var j={};const k=30;return c.loadCss("src/util/colorbar.css"),j.getColorScale=function(c){var e,f=b.min(c.domain),g=b.max(c.domain);e="values"===c.stopType?a.cloneDeep(c.stopPositions):c.stopPositions.map(function(a){return f+a*(g-f)});var h=c.stops.map(function(a){var b=d(a),c={color:b.hex(),opacity:b.alpha()};return c});return e.unshift(Number.MIN_VALUE),e.push(Number.MAX_VALUE),h.push(h[h.length-1]),h.unshift(h[0]),b.scale.linear().domain(e).range(h)},j.getSvg=function(a){var b=$("<div>")[0];return j.renderSvg(b,a)},j.renderSvg=function(a,d){var j,l=b.min(d.domain),m=b.max(d.domain);j="values"===d.stopType?d.stopPositions.map(function(a){return(a-l)/(m-l)}):d.stopPositions;var n,o,p=h(d),q=e(p),r=d.width,s=d.height;d.axis?(o=s-k,n=r-k):(n=r,o=s);var t=b.select(a).append("svg").attr("width",r).attr("height",s),u=c.getNextUniqueId();t.append("defs").append("linearGradient").attr({x1:q[0],y1:q[1],x2:q[2],y2:q[3],id:u}).selectAll("stop").data(d.stops).enter().append("stop").attr("offset",function(a,b){return`${100*j[b]}%`}).style("stop-color",function(a){return a}).style("stop-opacity",1);var v=t.append("g").attr("class","key").attr("transform",function(){var a=f(d),b=g(d);return`translate(${a},${b})`});v.append("rect").style("fill",`url(#${u})`).attr("width",n).attr("height",o);var w=b.scale.linear().domain(d.domain);if(d.axis&&d.axis.tickValues||(w=w.nice()),w.range([0,"bottom"===p||"top"===p?n:o]),i(d)){var y=b.svg.axis().scale(w).orient(p).tickSize(6);d.axis.ticks?y.ticks(d.axis.ticks):d.axis.tickValues&&y.tickValues(d.axis.tickValues),v.append("g").attr("class","key").attr("transform",function(){var a=0,b=0;return"bottom"===p?b+=o:"right"===p&&(a+=n),`translate(${a},${b})`}).call(y)}return t.html()},j});
