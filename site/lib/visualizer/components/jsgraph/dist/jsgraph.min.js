/*! jsGraph (c) 2014 Norman Pellet, MIT license, v@1.10.4-34, Date: 2015-02-11T15:42Z */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a):b(a)}("undefined"!=typeof window?window:this,function(a){var b=function(b){var c=[];return c["./jquery"]=b,c["./dependencies/eventEmitter/EventEmitter"]=function(){function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype;return d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},a}(),c["./graph.axis"]=function(a,b){var c=function(){};return c.prototype=a.extend(c.prototype,b.prototype,{defaults:{lineAt0:!1,display:!0,flipped:!1,axisDataSpacing:{min:.1,max:.1},unitModification:!1,primaryGrid:!0,secondaryGrid:!0,shiftToZero:!1,tickPosition:1,nbTicksPrimary:3,nbTicksSecondary:10,ticklabelratio:1,exponentialFactor:0,exponentialLabelFactor:0,logScale:!1,allowedPxSerie:100,forcedMin:!1,forcedMax:!1},init:function(b,d,e){this.unitModificationTimeTicks=[[1,[1,2,5,10,20,30]],[60,[1,2,5,10,20,30]],[3600,[1,2,6,12]],[86400,[1,2,3,4,5,10,20,40]]];var f=this;this.graph=b,this.options=a.extend(!0,{},c.prototype.defaults,e,d),this.group=document.createElementNS(this.graph.ns,"g"),this.hasChanged=!0,this.groupGrids=document.createElementNS(this.graph.ns,"g"),this.graph.axisGroup.insertBefore(this.groupGrids,this.graph.axisGroup.firstChild),this.rectEvent=document.createElementNS(this.graph.ns,"rect"),this.rectEvent.setAttribute("pointer-events","fill"),this.rectEvent.setAttribute("fill","transparent"),this.group.appendChild(this.rectEvent),this.graph.axisGroup.appendChild(this.group),this.line=document.createElementNS(this.graph.ns,"line"),this.line.setAttribute("stroke","black"),this.line.setAttribute("shape-rendering","crispEdges"),this.line.setAttribute("stroke-linecap","square"),this.groupTicks=document.createElementNS(this.graph.ns,"g"),this.groupTickLabels=document.createElementNS(this.graph.ns,"g"),this.group.appendChild(this.groupTicks),this.group.appendChild(this.groupTickLabels),this.group.appendChild(this.line),this.labelValue,this.label=document.createElementNS(this.graph.ns,"text"),this.labelTspan=document.createElementNS(this.graph.ns,"tspan"),this.label.appendChild(this.labelTspan),this.expTspan=document.createElementNS(this.graph.ns,"tspan"),this.label.appendChild(this.expTspan),this.expTspan.setAttribute("dx",10),this.expTspanExp=document.createElementNS(this.graph.ns,"tspan"),this.label.appendChild(this.expTspanExp),this.expTspanExp.setAttribute("dy",-5),this.expTspanExp.setAttribute("font-size","0.8em"),this.label.setAttribute("text-anchor","middle"),this.groupGrids.setAttribute("clip-path","url(#_clipplot"+this.graph._creation+")"),this.group.appendChild(this.label),this.groupSeries=document.createElementNS(this.graph.ns,"g"),this.group.appendChild(this.groupSeries),this.ticks=[],this.series=[],this.totalDelta=0,this.currentAction=!1,this.group.addEventListener("mousemove",function(a){a.preventDefault();var b=f.graph._getXY(a);f.handleMouseMoveLocal(b.x,b.y,a);for(var c=0,d=f.series.length;d>c;c++)f.series[c].handleMouseMove(!1,!0),"labelDragging"==f.currentAction&&f.series[c].handleLabelMove(b.x,b.y),"labelDraggingMain"==f.currentAction&&f.series[c].handleLabelMainMove(b.x,b.y)}),this.group.addEventListener("mouseup",function(a){a.preventDefault(),f.handleMouseUp()}),this.group.addEventListener("mouseout",function(a){a.preventDefault();var b=f.graph._getXY(a);f.handleMouseOutLocal(b.x,b.y,a)}),this.labels=[],this.group.addEventListener("click",function(a){a.preventDefault();var b=f.graph._getXY(a);f.addLabel(f.getVal(b.x-f.graph.getPaddingLeft()))}),this.axisRand=Math.random(),this.clip=document.createElementNS(this.graph.ns,"clipPath"),this.clip.setAttribute("id","_clip"+this.axisRand),this.graph.defs.appendChild(this.clip),this.clipRect=document.createElementNS(this.graph.ns,"rect"),this.clip.appendChild(this.clipRect),this.clip.setAttribute("clipPathUnits","userSpaceOnUse")},handleMouseMoveLocal:function(){},addLabel:function(a){for(var b=0,c=this.series.length;c>b;b++)this.series[b].currentAction===!1&&this.series[b].addLabelObj({x:a})},hide:function(){return this.options.display=!1,this},show:function(){return this.options.display=!0,this},setDisplay:function(a){return this.options.display=!!a,this},isDisplayed:function(){return this.options.display},setLineAt0:function(a){this.options.lineAt0=!!a},adapt0To:function(a,b,c){this._adapt0To=a?[a,b,c]:!1},getAdapt0ToMin:function(){return"min"==this._adapt0To[1]?this._adapt0To[2]:this._adapt0To[2]*(this._adapt0To[0].getMinValue()/this._adapt0To[0].getMaxValue())},getAdapt0ToMax:function(){return"max"==this._adapt0To[1]?this._adapt0To[2]:this._adapt0To[2]*(this._adapt0To[0].getMaxValue()/this._adapt0To[0].getMinValue())},setAxisDataSpacing:function(a,b){this.options.axisDataSpacing.min=a,this.options.axisDataSpacing.max=b||a},setAxisDataSpacingMin:function(a){this.options.axisDataSpacing.min=a},setAxisDataSpacingMax:function(a){this.options.axisDataSpacing.max=a},setMinPx:function(a){this.minPx=a},setMaxPx:function(a){this.maxPx=a},getMinPx:function(){return this.isFlipped()?this.maxPx:this.minPx},getMaxPx:function(){return this.isFlipped()?this.minPx:this.maxPx},getMathMaxPx:function(){return this.maxPx},getMathMinPx:function(){return this.minPx},getMinValue:function(){return this._adapt0To?this.getAdapt0ToMin():this.options.forcedMin||(0===this.options.forcedMin?0:this.dataMin)},getMaxValue:function(){return this._adapt0To?this.getAdapt0ToMax():this.options.forcedMax||(0===this.options.forcedMax?0:this.dataMax)},setMinValueData:function(a){this.dataMin=a},setMaxValueData:function(a){this.dataMax=a},forceMin:function(a){return this.options.forcedMin=a,this},forceMax:function(a){return this.options.forcedMax=a,this},force:function(a){a.getMaxValue&&a.getMinValue&&(this.options.forcedMin=a.getMinValue(),this.options.forcedMax=a.getMaxValue())},getNbTicksPrimary:function(){return this.options.nbTicksPrimary},getNbTicksSecondary:function(){return this.options.nbTicksSecondary},handleMouseMove:function(a){this.mouseVal=this.getVal(a)},handleMouseWheel:function(a,b,c){a=Math.min(.2,Math.max(-.2,a)),"min"==c?c=this.getMinValue():"max"==c?c=this.getMaxValue():c||(c=0),this._doZoomVal((this.getActualMax()-c)*(1+a)+c,(this.getActualMin()-c)*(1+a)+c),this.graph.redraw()},handleMouseUp:function(){if("labelDragging"==this.currentAction||"labelDraggingMain"==this.currentAction){for(var a=0,b=this.series.length;b>a;a++)this.series[a].handleLabelUp();this.currentAction=!1}},zoom:function(a,b){return this._doZoomVal(a,b)},_doZoomVal:function(a,b,c){return this._doZoom(this.getPx(a),this.getPx(b),a,b,c)},_doZoom:function(a,b,c,d){var c=void 0!==c?c:this.getVal(a),d=void 0!==d?d:this.getVal(b);this.setCurrentMin(Math.min(c,d)),this.setCurrentMax(Math.max(c,d)),this._hasChanged=!0,this.emit("zoom",this.currentAxisMin,this.currentAxisMax,this)},getSerieShift:function(){return this._serieShift},getSerieScale:function(){return this._serieScale},getMouseVal:function(){return this.mouseVal},isFlipped:function(){return this.options.flipped},getUnitPerTick:function(a,b,c){var d=a/q;b=b?Math.min(b,a/10):a/10;var e=c/b;switch(this.options.unitModification){case"time":case"time:min.sec":var f=this.getModifiedValue(this.getMaxValue());umin=3600>f?0:86400>f?1:2;for(var g=!1,h=0,i=this.unitModificationTimeTicks.length;i>h;h++){for(var j=0,k=this.unitModificationTimeTicks[h][1].length;k>j;j++)if(e<this.unitModificationTimeTicks[h][0]*this.unitModificationTimeTicks[h][1][j]){g=!0;break}if(g)break}p=h!==this.unitModificationTimeTicks.length?this.unitModificationTimeTicks[h][0]*this.unitModificationTimeTicks[h][1][j]:1;break;default:var l=Math.floor(Math.log(e)/Math.log(10)),m=e*Math.pow(10,-l);this.decimals=-l;for(var n=[1,2,5,10],o=!1,h=n.length-1;h>=0;h--)(!o||Math.abs(n[h]-m)<Math.abs(o-m))&&(o=n[h]);var p=o*Math.pow(10,l)}var q=c/p,d=a/b;return[p,q,d]},setMinMaxToFitSeries:function(){var a=this.getInterval();this.options.logScale?(this.currentAxisMin=Math.max(1e-50,.9*this.getMinValue()),this.currentAxisMax=Math.max(1e-50,1.1*this.getMaxValue())):(this.currentAxisMin=this.getMinValue()-this.options.axisDataSpacing.min*a,this.currentAxisMax=this.getMaxValue()+this.options.axisDataSpacing.max*a),(isNaN(this.currentAxisMin)||isNaN(this.currentAxisMax))&&(this.currentAxisMax=void 0,this.currentAxisMin=void 0)},getInterval:function(){return this.getMaxValue()-this.getMinValue()},_getActualInterval:function(){return this.getActualMax()-this.getActualMin()},getActualMin:function(){return this.currentAxisMin==this.currentAxisMax?this.options.logScale?this.currentAxisMin/10:this.currentAxisMin-1:this.currentAxisMin},getActualMax:function(){return this.currentAxisMax==this.currentAxisMin?this.options.logScale?10*this.currentAxisMax:this.currentAxisMax+1:this.currentAxisMax},setCurrentMin:function(a){this.currentAxisMin=a,this.options.logScale&&(this.currentAxisMin=Math.max(1e-50,a))},setCurrentMax:function(a){this.currentAxisMax=a,this.options.logScale&&(this.currentAxisMax=Math.max(1e-50,a))},flip:function(a){return this.options.flipped=a,this},_draw:function(){var a;this.drawInit(),(void 0==this.currentAxisMin||void 0==!this.currentAxisMax)&&this.setMinMaxToFitSeries();var b=this.maxPx-this.minPx,c=this._getActualInterval();if(!this.options.display)return this.line.setAttribute("display","none"),0;if(this.line.setAttribute("display","block"),this.options.hideTicks)var d=0;else if(this.linkedToAxis){this.linkedToAxis.deltaPx=10;var d=this.drawLinkedToAxisTicksWrapper(b,c)}else if(this.options.logScale)var d=this.drawLogTicks();else{this.options.scientificTicks&&(this.scientificExp=Math.floor(Math.log(Math.max(Math.abs(this.getActualMax()),Math.abs(this.getActualMin())))/Math.log(10)));var d=this.drawLinearTicksWrapper(b,c)}var e;return(e=this.getLabel())&&(this.labelTspan.textContent=e,this.getExponentialLabelFactor()?(this.expTspan.nodeValue="x10",this.expTspanExp.nodeValue=this.getExponentialLabelFactor(),a=!0):this.options.scientificTicks?(this.expTspan.textContent="x10",this.expTspanExp.textContent=this.scientificExp,a=!0):a=!1,this.expTspan.setAttribute("display",a?"block":"none"),this.expTspanExp.setAttribute("display",a?"block":"none")),this.drawSpecifics(),this.options.lineAt0&&this.getActualMin()<0&&this.getActualMax()>0&&this._draw0Line(this.getPx(0)),d+(e?20:0)},drawInit:function(){switch(this.options.tickPosition){case 3:this.tickPx1=-2,this.tickPx2=0;break;case 2:this.tickPx1=-1,this.tickPx2=1;break;case 1:this.tickPx1=0,this.tickPx2=2}for(;this.groupTicks.firstChild;)this.groupTicks.removeChild(this.groupTicks.firstChild);for(;this.groupTickLabels.firstChild;)this.groupTickLabels.removeChild(this.groupTickLabels.firstChild);for(;this.groupGrids.firstChild;)this.groupGrids.removeChild(this.groupGrids.firstChild)},drawLinearTicksWrapper:function(a,b){var c=this.getNbTicksPrimary(),d=this.getUnitPerTick(a,c,b),e=this.secondaryTicks();if(e)var e=e;return this.drawTicks(d,e)},setTickLabelRatio:function(a){this.options.ticklabelratio=a},draw:function(){this._widthLabels=0;var a=this._draw();return this._widthLabels+=a,a},drawTicks:function(a,b){var c,d,e,f=a[0],g=this.getActualMin(),h=this.getActualMax(),i=0;for(b&&(c=f/b),d=this.options.shiftToZero?this.dataMin-Math.ceil((this.dataMin-g)/f)*f:Math.floor(g/f)*f,this.incrTick=a[0],this.resetTicks();h>d&&(i++,!(i>200));){if(b){e=d+c;for(var j=0;d+f>e&&(j++,!(j>100));)g>e||e>h?e+=c:(this.drawTickWrapper(e,!1,Math.abs(e-d-f/2)<1e-4?3:2),e+=c)}g>d||d>h?d+=a[0]:(this.drawTickWrapper(d,!0,4),d+=a[0])}return this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick},resetTicks:function(){},secondaryTicks:function(){return this.options.nbTicksSecondary},drawLogTicks:function(){var a=this.getActualMin(),b=this.getActualMax(),c=Math.min(a,b),b=Math.max(a,b);1e-50>c&&(c=1e-50),Math.log(c)-Math.log(b)>20&&(b=Math.pow(10,20*Math.log(c)));var d={fontSize:"1.0em",exponential:!0,overwrite:!1};0>c&&(c=0);for(var e,f=0==c?0:Math.floor(Math.log(c)/Math.log(10)),c=1;(e=c*Math.pow(10,f))<b;)1==c&&e>a&&this.drawTickWrapper(e,!0,5,d),10==c?(c=1,f++):(1!=c&&e>a&&this.drawTickWrapper(e,!1,2,{overwrite:"",fontSize:"0.6em"}),c++);return 5},drawTickWrapper:function(a,b,c,d){this.drawTick(a,b,c,d)},linkToAxis:function(a,b,c){this.linkedToAxis={axis:a,scalingFunction:b,decimals:c||1}},drawLinkedToAxisTicksWrapper:function(a,b){var c,d,e,f,g=this.linkedToAxis,h=0,i=0;console.warn("This is a temporary trick. Needs to be removed for efficiency purposes"),g.axis.draw(),g.deltaPx||(g.deltaPx=10);do{if(c=g.scalingFunction(g.axis.getVal(h+this.getMinPx())),g.decimals&&(this.decimals=g.decimals),d=this.drawTick(c,!0,1,{},h+this.getMinPx()),e=8*String(d[1].textContent).length,f=5*Math.round(e/5),f>g.deltaPx)return g.deltaPx=f,this.drawInit(),void this.drawLinkedToAxisTicksWrapper(a,b);i++,h+=g.deltaPx}while(a>h)},getPx:function(a){return this.getPos(a)},getPos:function(a){if(this.options.logScale){if(0>a)return;var a=(Math.log(a)-Math.log(this.getActualMin()))/(Math.log(this.getActualMax())-Math.log(this.getActualMin()))*(this.getMaxPx()-this.getMinPx())+this.getMinPx();return a}return(a-this.getActualMin())/this._getActualInterval()*(this.getMaxPx()-this.getMinPx())+this.getMinPx()},getRelPx:function(a){return a/this._getActualInterval()*(this.getMaxPx()-this.getMinPx())},getRelVal:function(a){return a/(this.getMaxPx()-this.getMinPx())*this._getActualInterval()},getVal:function(a){return(a-this.getMinPx())/(this.getMaxPx()-this.getMinPx())*this._getActualInterval()+this.getActualMin()},valueToText:function(a){if(this.options.scientificTicks)return a/=Math.pow(10,this.scientificExp),a.toFixed(1);if(a=a*Math.pow(10,this.getExponentialFactor())*Math.pow(10,this.getExponentialLabelFactor()),this.options.shiftToZero&&(a-=this.dataMin),this.options.ticklabelratio&&(a*=this.options.ticklabelratio),this.options.unitModification)return a=this.modifyUnit(a,this.options.unitModification);var b=this.decimals-this.getExponentialFactor()-this.getExponentialLabelFactor();return isNaN(a)?"":a.toFixed(b>0?b:0)},getModifiedValue:function(a){return this.options.ticklabelratio&&(a*=this.options.ticklabelratio),this.options.shiftToZero&&(a-=this.getMinValue()*(this.options.ticklabelratio||1)),a},modifyUnit:function(a,b){var c="",d=this.incrTick;switch(b){case"time":var e,f=this.getModifiedValue(this.getMaxValue()),g=[[60,"min"],[3600,"h"],[86400,"d"]];if(3600>f?umin=0:86400>f?umin=1:2592e3>f&&(umin=2),!g[umin])return!1;a/=g[umin][0];var h=Math.floor(a);for(c=h+g[umin][1],umin--;d<1*g[umin+1][0]&&umin>-1;)e=!1,a=(a-h)*g[umin+1][0]/g[umin][0],h=Math.round(a),c+=" "+h+g[umin][1],umin--;break;case"time:min.sec":a/=60;var h=Math.floor(a),i=Math.round(60*(a-h))+"";i=1==i.length?"0"+i:i,c=h+"."+i}return c},getExponentialFactor:function(){return this.options.exponentialFactor},setExponentialFactor:function(a){this.options.exponentialFactor=a},setExponentialLabelFactor:function(a){this.options.exponentialLabelFactor=a},getExponentialLabelFactor:function(){return this.options.exponentialLabelFactor},setLabel:function(a){return this.options.labelValue=a,this},getLabel:function(){return this.options.labelValue},setShift:function(a,b){this.shift=a,this.totalDimension=b,this._setShift()},getShift:function(){return this.shift},setTickPosition:function(a){switch(a){case 3:case"outside":a=3;break;case 2:case"centered":a=2;break;default:case 1:case"inside":a=1}return this.options.tickPosition=a,this},toggleGrids:function(a){return this.options.primaryGrid=a,this.options.secondaryGrid=a,this},togglePrimaryGrid:function(a){return this.options.primaryGrid=a,this},toggleSecondaryGrid:function(a){return this.options.secondaryGrid=a,this},doGridLine:function(a,b,c,d,e){var f=document.createElementNS(this.graph.ns,"line");f.setAttribute("shape-rendering","crispEdges"),f.setAttribute("y1",d),f.setAttribute("y2",e),f.setAttribute("x1",b),f.setAttribute("x2",c),f.setAttribute("stroke",a?this.getColorPrimaryGrid():this.getColorSecondaryGrid()),this.groupGrids.appendChild(f)},getColorPrimaryGrid:function(){return"#c0c0c0"},getColorSecondaryGrid:function(){return"#f0f0f0"},setTickContent:function(a,b,c){if(c||(c={}),c.overwrite||!c.exponential)a.textContent=c.overwrite||this.valueToText(b);else{var d=Math.round(Math.log(b)/Math.log(10)),e=Math.floor(b*Math.pow(10,-d));a.textContent=1!=e?e+"x10":"10";var f=document.createElementNS(this.graph.ns,"tspan");f.textContent=d,f.setAttribute("font-size","0.7em"),f.setAttribute("dy",0),a.appendChild(f)}c.fontSize&&a.setAttribute("font-size",c.fontSize)},removeSerie:function(a){this.series.splice(this.series.indexOf(a),1)},killSeries:function(a){for(var b=0;b<this.series.length;b++)this.series[b].kill(a);this.series=[]},removeSeries:function(){this.killSeries()},handleMouseOutLocal:function(){for(var a=0,b=this.series.length;b>a;a++)this.series[a].hideTrackingMarker()}}),c}(c["./jquery"],c["./dependencies/eventEmitter/EventEmitter"]),c["./graph.axis.x"]=function(a,b){var c=function(a,b,c){this.init(a,c),this.top="top"==b};return a.extend(c.prototype,b.prototype,{getAxisPosition:function(){if(!this.options.display)return 0;var a=(1==this.options.tickPosition?15:25)+2*this.graph.options.fontSize;return this.options.allowedPxSerie&&this.series.length>0&&(a+=this.options.allowedPxSerie),a},getAxisWidthHeight:function(){},_setShift:function(){this.group.setAttribute("transform","translate(0 "+(this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+")")},getMaxSizeTick:function(){return(this.top?-1:1)*(1==this.options.tickPosition?10:10)},drawTick:function(a,b,c,d,e){var f,g=(this.groupTicks,document.createElementNS(this.graph.ns,"line"));if(f=void 0!==e?e:this.getPos(a),void 0!=f){if(g.setAttribute("shape-rendering","crispEdges"),g.setAttribute("x1",f),g.setAttribute("x2",f),g.setAttribute("y1",(this.top?1:-1)*this.tickPx1*c),g.setAttribute("y2",(this.top?1:-1)*this.tickPx2*c),b&&this.options.primaryGrid?this.doGridLine(!0,f,f,0,this.graph.getDrawingHeight()):!b&&this.options.secondaryGrid&&this.doGridLine(!1,f,f,0,this.graph.getDrawingHeight()),g.setAttribute("stroke","black"),this.groupTicks.appendChild(g),b){var h=(this.groupTickLabels,document.createElementNS(this.graph.ns,"text"));h.setAttribute("x",f),h.setAttribute("y",(this.top?-1:1)*((1==this.options.tickPosition?8:20)+(this.top?10:0))),h.setAttribute("text-anchor","middle"),h.style.dominantBaseline="hanging",this.setTickContent(h,a,d),this.groupTickLabels.appendChild(h)}return this.ticks.push(g),[g,h]}},drawSpecifics:function(){this.label.setAttribute("text-anchor","middle"),this.label.setAttribute("x",Math.abs(this.getMaxPx()-this.getMinPx())/2+this.getMinPx()),this.label.setAttribute("y",(this.top?-1:1)*((1==this.options.tickPosition?10:15)+this.graph.options.fontSize)),this.line.setAttribute("x1",this.getMinPx()),this.line.setAttribute("x2",this.getMaxPx()),this.line.setAttribute("y1",0),this.line.setAttribute("y2",0),this.top||(this.labelTspan.style.dominantBaseline="hanging",this.expTspan.style.dominantBaseline="hanging",this.expTspanExp.style.dominantBaseline="hanging")},drawSeries:function(){if(this.shift){this.rectEvent.setAttribute("y",this.top?-this.shift:0),this.rectEvent.setAttribute("height",this.totalDimension),this.rectEvent.setAttribute("x",Math.min(this.getMinPx(),this.getMaxPx())),this.rectEvent.setAttribute("width",Math.abs(this.getMinPx()-this.getMaxPx())),this.clipRect.setAttribute("y",this.top?-this.shift:0),this.clipRect.setAttribute("height",this.totalDimension),this.clipRect.setAttribute("x",Math.min(this.getMinPx(),this.getMaxPx())),this.clipRect.setAttribute("width",Math.abs(this.getMinPx()-this.getMaxPx()));for(var a=0,b=this.series.length;b>a;a++)this.series[a].draw()}},_draw0Line:function(a){this._0line=document.createElementNS(this.graph.ns,"line"),this._0line.setAttribute("x1",a),this._0line.setAttribute("x2",a),this._0line.setAttribute("y1",0),this._0line.setAttribute("y2",this.getMaxPx()),this._0line.setAttribute("stroke","black"),this.groupGrids.appendChild(this._0line)},handleMouseMoveLocal:function(a){a-=this.graph.getPaddingLeft(),this.mouseVal=this.getVal(a)},isXY:function(){return"x"}}),c}(c["./jquery"],c["./graph.axis"]),c["./graph.axis.y"]=function(a){var c=function(a,b,c){this.init(a,c),this.leftright=b,this.left="left"==b};return b.extend(c.prototype,a.prototype,{getAxisPosition:function(){var a=0;return this.options.display?(this.options.allowedPxSerie&&this.series.length>0&&(a=this.options.allowedPxSerie),a):0},getAxisWidthHeight:function(){return 15},resetTicks:function(){this.longestTick=[!1,0]},getMaxSizeTick:function(){return(this.longestTick[0]?this.longestTick[0].getComputedTextLength():0)+10},drawTick:function(a,b,c,d,e){{var f,g;this.groupTicks}if(f=void 0!==e?e:this.getPos(a),void 0!=f){var h=document.createElementNS(this.graph.ns,"line");if(h.setAttribute("shape-rendering","crispEdges"),h.setAttribute("y1",f),h.setAttribute("y2",f),h.setAttribute("x1",(this.left?1:-1)*this.tickPx1*c),h.setAttribute("x2",(this.left?1:-1)*this.tickPx2*c),h.setAttribute("stroke","black"),b&&this.options.primaryGrid?this.doGridLine(!0,0,this.graph.getDrawingWidth(),f,f):!b&&this.options.secondaryGrid&&this.doGridLine(!1,0,this.graph.getDrawingWidth(),f,f),this.groupTicks.appendChild(h),b){{this.groupTickLabels}g=document.createElementNS(this.graph.ns,"text"),g.setAttribute("y",f),g.setAttribute("x",this.left?-10:10),this.left?g.setAttribute("text-anchor","end"):g.setAttribute("text-anchor","start"),g.style.dominantBaseline="central",this.setTickContent(g,a,d),this.groupTickLabels.appendChild(g),String(g.textContent).length>=this.longestTick[1]&&(this.longestTick[0]=g,this.longestTick[1]=String(g.textContent).length)}this.ticks.push(h)}},drawSpecifics:function(){this.label.setAttribute("transform","translate("+(this.left?1:-1)*(-this.widthHeightTick-10-5)+", "+(Math.abs(this.getMaxPx()-this.getMinPx())/2+Math.min(this.getMinPx(),this.getMaxPx()))+") rotate(-90)"),this.left||(this.labelTspan.style.dominantBaseline="hanging",this.expTspan.style.dominantBaseline="hanging",this.expTspanExp.style.dominantBaseline="hanging"),this.line.setAttribute("y1",this.getMinPx()),this.line.setAttribute("y2",this.getMaxPx()),this.line.setAttribute("x1",0),this.line.setAttribute("x2",0)},drawSeries:function(){if(this.shift){this.rectEvent.setAttribute("x",this.left?-this.shift:0),this.rectEvent.setAttribute("width",this.totalDimension),this.rectEvent.setAttribute("y",Math.min(this.getMinPx(),this.getMaxPx())),this.rectEvent.setAttribute("height",Math.abs(this.getMinPx()-this.getMaxPx())),this.clipRect.setAttribute("x",-this.shift),this.clipRect.setAttribute("width",this.totalDimension),this.clipRect.setAttribute("y",Math.min(this.getMinPx(),this.getMaxPx())),this.clipRect.setAttribute("height",Math.abs(this.getMinPx()-this.getMaxPx()));for(var a=0,b=this.series.length;b>a;a++)this.series[a].draw()}},_setShift:function(){var a=this.isLeft()?this.getShift():this.graph.getWidth()-this.graph.getPaddingRight()-this.graph.getPaddingLeft()-this.getShift();this.group.setAttribute("transform","translate("+a+" 0)")},isLeft:function(){return this.left},isRight:function(){return!this.left},isFlipped:function(){return!this.options.flipped},_draw0Line:function(a){this._0line=document.createElementNS(this.graph.ns,"line"),this._0line.setAttribute("y1",a),this._0line.setAttribute("y2",a),this._0line.setAttribute("x1",0),this._0line.setAttribute("x2",this.graph.getDrawingWidth()),this._0line.setAttribute("stroke","black"),this.groupGrids.appendChild(this._0line)},handleMouseMoveLocal:function(a,b){b-=this.graph.getPaddingTop(),this.mouseVal=this.getVal(b)},scaleToFitAxis:function(a,b,c,d,e,f){a||(a=this.graph.getXAxis()),isNaN(c)&&(c=a.getActualMin()),isNaN(d)&&(d=a.getActualMax()),void 0===e&&(e=!0),void 0===f&&(f=!0),"number"==typeof b&&(d=c,c=b,b=!1);for(var g=-1/0,h=1/0,i=0,j=0,k=this.graph.series.length;k>j;j++)this.graph.series[j].isShown()&&this.graph.series[j]!=b&&this.graph.series[j].getXAxis()==a&&this.graph.series[j].getYAxis()===this&&(i++,g=Math.max(g,this.graph.series[j].getMax(c,d)),h=Math.min(h,this.graph.series[j].getMin(c,d)));if(0==i)this.setMinMaxToFitSeries();else{h=e?h:this.getActualMin(),g=f?g:this.getActualMax();var l=g-h;h-=this.options.axisDataSpacing.min*l,g+=this.options.axisDataSpacing.max*l,this._doZoomVal(h,g)}},isXY:function(){return"y"}}),c}(c["./graph.axis"]),c["./graph.axis.broken"]=function(){var a=function(){};return a.prototype={getNbTicksPrimary:function(){return this.options.nbTicksPrimary},getNbTicksSecondary:function(){return this.options.nbTicksSecondary},getBreakingSpacing:function(){return this.options.breakingSpacing||5},setBrokenRanges:function(a){this.ranges=[],this._broken=!0;var b=this,c=(a.length,0);a.map(function(a){c+=a[1]-a[0]}),a.map(function(a){b.ranges.push({ratio:(a[1]-a[0])/c,diff:a[1]-a[0],min:a[0],max:a[1],minPx:void 0,maxPx:void 0})}),b.totalValRanges=c},drawLinearTicksWrapper:function(){var a=this.ranges.length-1,b=this.maxPx-this.minPx-a*this.getBreakingSpacing(),c=this.getNbTicksPrimary(),d=this.getUnitPerTick(b,c,this.totalValRanges),e=this.secondaryTicks();return this.drawTicks(d,e)},setTickLabelRatio:function(a){this.options.ticklabelratio=a},drawTicks:function(a,b){var c=this,d=a[0],e=this.getMinPx(),f=(this.getMaxPx(),e),g=this.ranges.length-1,h=this.getMaxPx()-this.getMinPx()-g*this.getBreakingSpacing()*(c.isFlipped()?-1:1);return this.resetTicks(),this.ranges.map(function(g,i){g.minPx=0==i?e:f+c.getBreakingSpacing()*(c.isFlipped()?-1:1),g.maxPx=g.minPx+h*g.ratio,f=g.maxPx,i>0&&(g.brokenMin||(g.brokenMin=c.createBrokenLine(g),c.group.appendChild(g.brokenMin)),c.placeBrokenLine(g,g.brokenMin,g.minPx)),i<c.ranges.length-1&&(g.brokenMax||(g.brokenMax=c.createBrokenLine(g),c.group.appendChild(g.brokenMax)),c.placeBrokenLine(g,g.brokenMax,g.maxPx));var j,k,l,m=g.min,n=g.max;for(b&&(j=d/b),k=Math.floor(m/d)*d;n>k;){if(b)for(l=k+j;k+d>l;)m>l||l>n?l+=j:(c.drawTick(l,!1,Math.abs(l-k-d/2)<1e-4?3:2),l+=j);m>k||k>n?k+=a[0]:(c.drawTick(k,!0,4),k+=a[0])}}),this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick},secondaryTicks:function(){return this.options.nbTicksSecondary},drawLogTicks:function(){return 0},getPx:function(a){return this.getPos(a)},getPos:function(a){for(var b=0,c=this.ranges.length;c>b;b++)if(a<=this.ranges[b].max&&a>=this.ranges[b].min)return(a-this.ranges[b].min)/this.ranges[b].diff*(this.ranges[b].maxPx-this.ranges[b].minPx)+this.ranges[b].minPx},getRelPx:function(a){return a/this._getActualInterval()*(this.getMaxPx()-this.getMinPx())},getRelVal:function(a){return a/(this.maxPx-this.minPx-nbIntervals*this.getBreakingSpacing())*this.totalValRanges},getVal:function(a){for(var b=0,c=this.ranges.length;c>b;b++)if(a<=this.ranges[b].maxPx&&a>=this.ranges[b].minPx)return(a-this.ranges[b].minPx)/(this.ranges[b].maxPx-this.ranges[b].minPx)*(this.ranges[b].max-this.ranges[b].min)+this.ranges[b].min},sign:function(a){return a>0?1:-1},getBoundary:function(a,b){for(var c=0,d=this.ranges.length;d>c;c++)if(a<=this.ranges[c].max&&a>=this.ranges[c].min)return b>this.ranges[c].max?this.ranges[c].max:this.ranges[c].min},getInRange:function(a,b){for(var c=0,d=this.ranges.length;d>c;c++)if(a<=this.ranges[c].max&&a>=this.ranges[c].min)return(b-this.ranges[c].min)/this.ranges[c].diff*(this.ranges[c].maxPx-this.ranges[c].minPx)+this.ranges[c].minPx},getRange:function(a){for(var b=0,c=this.ranges.length;c>b;b++)if(a<=this.ranges[b].max&&a>=this.ranges[b].min)return[b,(a-this.ranges[b].min)/this.ranges[b].diff*(this.ranges[b].maxPx-this.ranges[b].minPx)+this.ranges[b].minPx];return[void 0,void 0]}},a}(c["./jquery"]),c["./graph.axis.x.broken"]=function(a,c){var d=function(a,b,c){this.init(a,c),this.top="top"==b};return b.extend(d.prototype,a.prototype,c.prototype,{createBrokenLine:function(){var a=document.createElementNS(this.graph.ns,"line");return a.setAttribute("x1","-3"),a.setAttribute("x2","3"),a.setAttribute("y1","-5"),a.setAttribute("y2","5"),a.setAttribute("stroke","black"),a},placeBrokenLine:function(a,b,c){b.setAttribute("transform","translate("+c+", 0)")}}),d}(c["./graph.axis.x"],c["./graph.axis.broken"]),c["./graph.axis.y.broken"]=function(a,c){var d=function(a,b,c){this.init(a,c),this.leftright=b,this.left="left"==b};return b.extend(d.prototype,a.prototype,c.prototype,{createBrokenLine:function(){var a=document.createElementNS(this.graph.ns,"line");return a.setAttribute("x1","-5"),a.setAttribute("x2","5"),a.setAttribute("y1","-3"),a.setAttribute("y2","3"),a.setAttribute("stroke","black"),a},placeBrokenLine:function(a,b,c){b.setAttribute("transform","translate(0, "+c+")")}}),d}(c["./graph.axis.y"],c["./graph.axis.broken"]),c["./graph.xaxis.time"]=function(a){function c(a,b){return Math.round(a/b)*b}function d(a,b){switch(b.unit){case"s":a.setSeconds(c(a.getSeconds(),b.increment)),a.setMilliseconds(0);break;case"i":a.setMinutes(c(a.getMinutes(),b.increment)),a.setSeconds(0),a.setMilliseconds(0);break;case"h":a.setHours(c(a.getHours(),b.increment)),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);break;case"d":a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(c(a.getDate(),b.increment));break;case"m":a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(1),a.setMonth(c(a.getMonth(),b.increment));break;case"y":a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(1),a.setMonth(0)}return a}function e(a,b){switch(b.unit){case"s":a.setSeconds(a.getSeconds()+b.increment),a.setMilliseconds(0);break;case"i":a.setMinutes(a.getMinutes()+b.increment),a.setSeconds(0),a.setMilliseconds(0);
break;case"h":a.setHours(a.getHours()+b.increment),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);break;case"d":a.setDate(a.getDate()+b.increment),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0);break;case"m":a.setMonth(a.getMonth()+b.increment),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(1);break;case"y":a.setYear(a.getYear()+b.increment),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(1),a.setMonth(0)}return a}function f(a,b,c){if(a.groups[b][c])return a.groups[b][c].group.setAttribute("display","block"),a.groups[b][c];var d={group:document.createElementNS(a.graph.ns,"g"),text:document.createElementNS(a.graph.ns,"text")},e=document.createElementNS(a.graph.ns,"line");switch(e.setAttribute("stroke","black"),e.setAttribute("y1",0),b){case 2:e.setAttribute("y2",6),d.text.setAttribute("y",15),d.line=e,d.group.appendChild(d.line);break;case 1:e.setAttribute("y2",20),d.text.setAttribute("y",10),d.line1=e,d.line2=e.cloneNode(),d.group.appendChild(d.line1),d.group.appendChild(d.line2)}return d.text.setAttribute("text-anchor","middle"),d.text.setAttribute("dominant-baseline","middle"),d.group.appendChild(d.text),a.getWrapper(b).appendChild(d.group),a.groups[b][c]=d}function g(a,b,c){for(;c<a.groups[b].length;c++)h(a.groups[b][c])}function h(a){a.group.setAttribute("display","none")}function i(a,b){return l(a,b)}function j(a,b,c,d,e,f,g){switch(a){case 1:var i=Math.max(d,Math.min(e,f)),j=Math.max(d,Math.min(e,g));b.line1.setAttribute("x1",i),b.line2.setAttribute("x1",j),b.line1.setAttribute("x2",i),b.line2.setAttribute("x2",j),b.text.setAttribute("x",(i+j)/2),8*c.length>j-i&&(c=""),b.text.textContent=c;break;case 2:if(d>f||f>e)return void h(b);b.line.setAttribute("x1",f),b.line.setAttribute("x2",f),b.text.setAttribute("x",f),b.text.textContent=c}}var k=function(a,b,c){this.wrapper={1:document.createElementNS(a.ns,"g"),2:document.createElementNS(a.ns,"g")},this.groups={1:[],2:[]};var d=document.createElementNS(a.ns,"rect");d.setAttribute("fill","#c0c0c0"),d.setAttribute("stroke","#808080"),d.setAttribute("height","20"),d.setAttribute("x","0"),d.setAttribute("y","0"),this.rect=d,this.wrapper[1].appendChild(this.rect),this.init(a,c),this.group.appendChild(this.wrapper[1]),this.group.appendChild(this.wrapper[2]),this.wrapper[1].setAttribute("transform","translate( 0, 25 )"),this.wrapper[2].setAttribute("transform","translate( 0, 00 )")},l=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[WLloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,d=function(a,b){for(a=String(a),b=b||2;a.length<b;)a="0"+a;return a},e=function(a,b){var c=new Date(a[b+"FullYear"](),0,1);return Math.ceil(((a-c)/864e5+c[b+"Day"]()+1)/7)};return function(f,g,h){var i=l;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(f)||/\d/.test(f)||(g=f,f=void 0),f=f?new Date(f):new Date,isNaN(f))throw SyntaxError("invalid date");g=String(i.masks[g]||g||i.masks["default"]),"UTC:"==g.slice(0,4)&&(g=g.slice(4),h=!0);var j=h?"getUTC":"get",k=f[j+"Date"](),m=f[j+"Day"](),n=f[j+"Month"](),o=f[j+"FullYear"](),p=f[j+"Hours"](),q=f[j+"Minutes"](),r=f[j+"Seconds"](),s=f[j+"Milliseconds"](),t=h?0:f.getTimezoneOffset(),u={d:k,dd:d(k),ddd:i.i18n.dayNames[m],dddd:i.i18n.dayNames[m+7],m:n+1,mm:d(n+1),mmm:i.i18n.monthNames[n],mmmm:i.i18n.monthNames[n+12],yy:String(o).slice(2),yyyy:o,h:p%12||12,hh:d(p%12||12),H:p,HH:d(p),M:q,MM:d(q),s:r,ss:d(r),l:d(s,3),L:d(s>99?Math.round(s/10):s),t:12>p?"a":"p",tt:12>p?"am":"pm",T:12>p?"A":"P",TT:12>p?"AM":"PM",Z:h?"UTC":(String(f).match(b)||[""]).pop().replace(c,""),o:(t>0?"-":"+")+d(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4),S:["th","st","nd","rd"][k%10>3?0:(k%100-k%10!=10)*k%10],W:e(f,j)};return g.replace(a,function(a){return a in u?u[a]:a.slice(1,a.length-1)})}}();return l.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},l.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},k.prototype=b.extend(!0,k.prototype,a.prototype,{draw:function(){(void 0==this.currentAxisMin||void 0==!this.currentAxisMax)&&this.setMinMaxToFitSeries(),this.line.setAttribute("x1",this.getMinPx()),this.line.setAttribute("x2",this.getMaxPx()),this.line.setAttribute("y1",0),this.line.setAttribute("y2",0);var a=this.maxPx-this.minPx,b=this._getActualInterval(),c=b/a,h=this.getActualMax(),k=this.getActualMin();if(this.rect.setAttribute("width",a),this.rect.setAttribute("x",this.minPx),!h||!k)return 0;var l,m=[{threshold:1e3,increments:{1:{increment:1,unit:"d",format:"HH:MM (dd/mm)"},2:{increment:1,unit:"i",format:"MM:ss"}}},{threshold:1500,increments:{1:{increment:1,unit:"d",format:"dd/mm"},2:{increment:1,unit:"i",format:'H"h"MM'}}},{threshold:4e3,increments:{1:{increment:1,unit:"d",format:"dd/mm"},2:{increment:2,unit:"i",format:'H"h"MM'}}},{threshold:8e3,increments:{1:{increment:1,unit:"d",format:"dd/mm"},2:{increment:10,unit:"i",format:'H"h"MM'}}},{threshold:26400,increments:{1:{increment:1,unit:"d",format:"dd/mm"},2:{increment:20,unit:"i",format:'H"h"MM'}}},{threshold:86400,increments:{1:{increment:1,unit:"d",format:"dd/mm"},2:{increment:1,unit:"h",format:'H"h"MM'}}},{threshold:2e5,increments:{1:{increment:1,unit:"d",format:"dd/mm"},2:{increment:2,unit:"h",format:'H"h"MM'}}},{threshold:4e5,increments:{1:{increment:1,unit:"d",format:"dd/mm"},2:{increment:6,unit:"h",format:'H"h"MM'}}},{threshold:14e5,increments:{1:{increment:1,unit:"d",format:"dd/mm"},2:{increment:12,unit:"h",format:'HH"h"MM'}}},{threshold:64e5,increments:{1:{increment:1,unit:"m",format:"mmmm"},2:{increment:1,unit:"d",format:"dd"}}},{threshold:124e5,increments:{1:{increment:1,unit:"m",format:"mmmm"},2:{increment:2,unit:"d",format:"dd"}}},{threshold:864e5,increments:{1:{increment:1,unit:"m",format:"mmmm"},2:{increment:7,unit:"d",format:"dd"}}}];for(s=0;s<m.length;s++)if(m[s].threshold>c){l=m[s];break}var n,o,p=0;for(p=1;2>=p;p++){var q=new Date(k),r=d(q,l.increments[p]),s=0;do{n=this.getPx(r.getTime());var t=i(r,l.increments[p].format),u=f(this,p,s);r=e(r,l.increments[p]),o=this.getPx(r.getTime()),j(p,u,t,this.getMinPx(),this.getMaxPx(),n,o),s++}while(r.getTime()<h);g(this,p,s)}},getWrapper:function(a){return this.wrapper[a]},setShift:function(a){this.shift=a,this.group.setAttribute("transform","translate(0 "+(this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+")")},getAxisPosition:function(){return 60},drawSeries:function(){}}),k}(c["./graph.axis"]),c["./graph.legend"]=function(){var a={frame:!1,backgroundColor:"transparent",frameWidth:0,frameColor:"transparent",paddingTop:10,paddingLeft:10,paddingBottom:10,paddingRight:10,movable:!1,shapesToggleable:!0,isSerieHideable:!0},c=function(c,d){this.options=b.extend({},a,d),this.graph=c,this.svg=document.createElementNS(this.graph.ns,"g"),this.subG=document.createElementNS(this.graph.ns,"g"),this.rect=document.createElementNS(this.graph.ns,"rect"),this.rectBottom=document.createElementNS(this.graph.ns,"rect"),this.rect.setAttribute("x",0),this.rect.setAttribute("y",0),this.rectBottom.setAttribute("x",0),this.rectBottom.setAttribute("y",0),this.svg.appendChild(this.subG),this.pos={x:void 0,y:void 0,transformX:0,transformY:0},this.setEvents(),this.applyStyle()};return c.prototype={setPosition:function(a,b,c){a&&(this.position=a,this.alignToX=b,this.alignToY=c)},calculatePosition:function(){var a=this.position,b=this.alignToY,c=this.alignToX,d=this.graph.getPosition(a,void 0,this.graph.getXAxis(),this.graph.getYAxis());d&&("right"==c&&(d.x-=this.width),"bottom"==b&&(d.y-=this.height),this.pos.transformX=d.x,this.pos.transformY=d.y,this._setPosition())},update:function(){var a=this;for(this.applyStyle(),this.calculatePosition();this.subG.hasChildNodes();)this.subG.removeChild(this.subG.lastChild);this.svg.insertBefore(this.rectBottom,this.svg.firstChild);for(var b=this.graph.getSeries(),c=0,d=b.length;d>c;c++)!function(d){var e,f,g;e=document.createElementNS(a.graph.ns,"g"),e.setAttribute("transform","translate(0, "+(16*c+a.options.paddingTop)+")"),a.subG.appendChild(e);var f=b[d].getSymbolForLegend(),h=b[d].getMarkerForLegend(),g=b[d].getTextForLegend();e.appendChild(f),h&&e.appendChild(h),e.appendChild(g),e.addEventListener("click",function(){var c=b[d];c.isSelected()&&a.isHideable()?(c.hide(a.isToggleShapes()),a.graph.unselectSerie(c)):c.isShown()?a.graph.selectSerie(c):a.isHideable()&&c.show(a.isToggleShapes())})}(c);var e=this.subG.getBBox();this.width=e.width+this.options.paddingRight+this.options.paddingLeft,this.height=e.height+this.options.paddingBottom+this.options.paddingTop,this.rect.setAttribute("width",this.width),this.rect.setAttribute("height",this.height),this.rect.setAttribute("fill","none"),this.rect.setAttribute("pointer-events","fill"),this.rect.setAttribute("display","none"),this.options.movable&&(this.rectBottom.style.cursor="move"),this.rectBottom.setAttribute("width",this.width),this.rectBottom.setAttribute("height",this.height),this.rectBottom.setAttribute("x",e.x-this.options.paddingTop),this.rectBottom.setAttribute("y",e.y-this.options.paddingLeft),this.svg.appendChild(this.rect)},isHideable:function(){return this.options.isSerieHideable},isToggleShapes:function(){return this.options.shapesToggleable},getDom:function(){return this.svg},setEvents:function(){var a=this,b=this.pos,c=function(c){a.options.movable&&(b.x=c.clientX,b.y=c.clientY,c.stopPropagation(),c.preventDefault(),a.mousedown=!0,a.graph.elementMoving(a),a.rect.setAttribute("display","block"))},d=function(b){a.handleMouseMove(b)};this.rectBottom.addEventListener("mousedown",c),this.rectBottom.addEventListener("mousemove",d),this.rect.addEventListener("mousemove",d)},handleMouseUp:function(a){a.stopPropagation(),a.preventDefault(),this.mousedown=!1,this.rect.setAttribute("display","none"),this.graph.elementMoving(!1)},handleMouseMove:function(a){if(this.mousedown){var b=this.pos,c=a.clientX-b.x,d=a.clientY-b.y;b.transformX+=c,b.transformY+=d,b.x=a.clientX,b.y=a.clientY,a.stopPropagation(),a.preventDefault(),this._setPosition()}},_setPosition:function(){var a=this.pos;this.svg.setAttribute("transform","translate("+a.transformX+", "+a.transformY+")")},applyStyle:function(){this.options.frame&&(this.rectBottom.setAttribute("stroke",this.options.frameColor),this.rectBottom.setAttribute("stroke-width",this.options.frameWidth+"px")),this.rectBottom.setAttribute("fill",this.options.backgroundColor)}},c}(),c["./dynamicdepencies"]=function(){return function(){this.caching={},this.folderMap={},this.load=function(a,b,d){var e=this;if(this.caching[a]||(this.caching[a]={}),Array.isArray(b))return void b.map(function(b){e.load(a,b,d)});var f=b;return this.folderMap[a]&&(b=this.folderMap[a]+b),this.caching[a][b]?d(this.caching[a][b],b,f)||this.caching[a][b]:"undefined"!=typeof c&&c[b]?d(this.caching[a][b]=c[b],b,f)||this.caching[a][b]:void("undefined"!=typeof require?require([b],function(c){d(e.caching[a][b]=c,b,f)}):console.warn("Could not load file "+b+" of type "+a))},this.configure=function(a){this.folderMap=a||{}}}}(),c["./graph.core"]=function(b,c,d,e,f,g,h,i,j){function k(a,b,c,d,e){return a.dynamicLoader.load("serie","graph.serie."+d,function(d){var f=new d;return f.init(a,b,c),a.appendSerieToDom(f),e(f),f})}function l(a){return a&&a.indexOf&&a.indexOf("px")>-1?parseInt(a.replace("px","")):!1}function m(a){var b=["bottom","top","left","right"],c=[0,0,0,0];a._painted=!0,a.refreshMinOrMax(),a._applyToAxes(function(a){if(!a.disabled){var d=b.indexOf(arguments[1]);a.setShift(c[d]+a.getAxisPosition(),a.getAxisPosition()),c[d]+=a.getAxisPosition()}},!1,!0,!1),a._applyToAxes(function(d){if(!d.disabled){d.setMinPx(c[1]),d.setMaxPx(a.getDrawingHeight(!0)-c[0]);var e=d.draw()||0,f=b.indexOf(arguments[1]),g=d.getAxisPosition();d.setShift(c[f]+g+e,e+g),c[f]+=e+g,d.drawSeries()}},!1,!1,!0),a._applyToAxes(function(b){b.disabled||(b.setMinPx(c[2]),b.setMaxPx(a.getDrawingWidth(!0)-c[3]),b.draw(),b.drawSeries())},!1,!0,!1),u(a,"right",a.getDrawingWidth(!0),a.getDrawingWidth(!0),c[1],a.getDrawingHeight(!0)-c[0]),u(a,"left",0,0,c[1],a.getDrawingHeight(!0)-c[0]),u(a,"top",c[2],a.getDrawingWidth(!0)-c[3],0,0),u(a,"bottom",c[2],a.getDrawingWidth(!0)-c[3],a.getDrawingHeight(!0)-c[0],a.getDrawingHeight(!0)-c[0]),a.clipRect.setAttribute("y",c[1]),a.clipRect.setAttribute("x",c[2]),a.clipRect.setAttribute("width",a.getDrawingWidth()-c[2]-c[3]),a.clipRect.setAttribute("height",a.getDrawingHeight()-c[1]-c[0]),a.rectEvent.setAttribute("x",c[1]),a.rectEvent.setAttribute("y",c[2]),a.rectEvent.setAttribute("width",a.getDrawingWidth()-c[2]-c[3]),a.rectEvent.setAttribute("height",a.getDrawingHeight()-c[1]-c[0]),a.shift=c,a.redrawShapes()}function n(b){var c=b;b._dom.addEventListener("keydown",function(a){a.preventDefault(),a.stopPropagation(),8==a.keyCode&&c.selectedShape&&c.selectedShape.kill()}),b.dom.addEventListener("mousemove",function(a){a.preventDefault();var b=c._getXY(a);p(c,b.x,b.y,a)}),b.dom.addEventListener("mouseleave",function(){w(c)}),b.dom.addEventListener("mousedown",function(a){if(c.focus(),a.preventDefault(),3!=a.which&&!a.ctrlKey){var b=c._getXY(a);o(c,b.x,b.y,a)}}),b.dom.addEventListener("mouseup",function(a){a.preventDefault();var b=c._getXY(a);r(c,b.x,b.y,a)}),b.dom.addEventListener("dblclick",function(b){b.preventDefault(),c.clickTimeout&&a.clearTimeout(c.clickTimeout);var d=c._getXY(b);c.cancelClick=!0,q(c,d.x,d.y,b)}),b.dom.addEventListener("click",function(b){if(3!=b.which&&!b.ctrlKey){b.preventDefault();var d=c._getXY(b);c.clickTimeout&&a.clearTimeout(c.clickTimeout),c.clickTimeout=a.setTimeout(function(){return c.cancelClick?void(c.cancelClick=!1):void s(c,d.x,d.y,b)},200)}}),b.dom.addEventListener("mousewheel",function(a){a.preventDefault(),a.stopPropagation();var b=a.wheelDeltaY||a.wheelDelta||-a.deltaY;return v(c,b,a),!1}),b.rectEvent.addEventListener("wheel",function(a){a.stopPropagation(),a.preventDefault();var b=a.wheelDeltaY||a.wheelDelta||-a.deltaY;return v(c,b,a),!1})}function o(a,b,c,d){var e,f=(d.shiftKey,d.ctrlKey,a.options.pluginAction);if(a.forcedPlugin)return a.activePlugin=a.forcedPlugin,void a._pluginExecute(a.activePlugin,"onMouseDown",[a,b,c,d]);for(e in f)if(a.isPluginAllowed(d,f[e]))return a.activePlugin=e,void a._pluginExecute(e,"onMouseDown",[a,b,c,d])}function p(a,b,c,d){if(a.bypassHandleMouse)return void a.bypassHandleMouse.handleMouseMove(d);if(!a._pluginExecute(a.activePlugin,"onMouseMove",[a,b,c,d]))if(a._applyToAxes("handleMouseMove",[b-a.options.paddingLeft,d],!0,!1),a._applyToAxes("handleMouseMove",[c-a.options.paddingTop,d],!1,!0),a.activePlugin);else{var e={};if(a.options.onMouseMoveData){for(var f=0;f<a.series.length;f++)e[a.series[f].getName()]=a.series[f].handleMouseMove(!1,!0);a.options.onMouseMoveData.call(a,d,e)}}}function q(a,b,c,d){var e=a.options.dblclick;if(e&&e.type)switch(e.type){case"plugin":var f;(f=a._plugins[e.plugin])&&f.onDblClick(a,b,c,e.options,d)}}function r(a,b,c,d){return a.bypassHandleMouse?(a.bypassHandleMouse.handleMouseUp(d),void(a.activePlugin=!1)):(a._pluginExecute(a.activePlugin,"onMouseUp",[a,b,c,d]),void(a.activePlugin=!1))}function s(a,b,c,d){a.emit("click",d),d.target!=a.rectEvent||d.shiftKey||a.unselectShapes()}function t(a,b,c,d){var e,c=c||{};switch(c.type){case"time":var f=x.time;break;case"broken":var f=x.broken;break;default:var f=x.def}switch(d){case"top":case"bottom":e=f.x;break;case"left":case"right":e=f.y}return b=b||0,"object"==typeof b&&(c=b,b=0),a.axis[d][b]=a.axis[d][b]||new e(a,d,c)}function u(a,b,c,d,e,f){if(a.options.close!==!1){var g=0;a.axis[b].map(function(a){a.isDisplayed()&&g++}),a.options.close!==!0&&!a.options.close[b]||0!=g?a.closingLines[b].setAttribute("display","none"):(a.closingLines[b].setAttribute("display","block"),a.closingLines[b].setAttribute("x1",c),a.closingLines[b].setAttribute("x2",d),a.closingLines[b].setAttribute("y1",e),a.closingLines[b].setAttribute("y2",f))}}function v(a,b,c){if(c.preventDefault(),c.stopPropagation(),a.options.wheel.type)switch(a.options.wheel.type){case"plugin":var d;(d=a._plugins[a.options.wheel.plugin])&&d.onMouseWheel(b,c,a.options.wheel.options);break;case"toSeries":for(var e=0,f=a.series.length;f>e;e++)a.series[e].onMouseWheel(b,c)}}function w(a){a.options.handleMouseLeave&&a.options.handleMouseLeave.call(this)}var x={def:{x:c,y:d},broken:{x:e,y:f},time:{x:g}},y={title:"",paddingTop:30,paddingBottom:5,paddingLeft:20,paddingRight:20,close:{left:!0,right:!0,top:!0,bottom:!0},fontSize:12,fontFamily:"Myriad Pro, Helvetica, Arial",plugins:[],pluginAction:{},wheel:{},dblclick:{},shapeSelection:"unique",dynamicDependencies:{plugin:"./plugins/",serie:"./series/",shapes:"./shapes/"},series:["line"]},z=function(a,c,d,e){var f=this;if(this._creation=Date.now()+Math.random(),"string"==typeof a&&(a=document.getElementById(a)),!a||!a.appendChild)throw"The DOM has not been defined";"function"==typeof d&&(e=d,d=!1),"function"==typeof c&&(e=c,c={}),this.options=b.extend({},y,c),this.axis={left:[],top:[],bottom:[],right:[]},this.shapes=[],this.shapesLocked=!1,this.selectedShapes=[],this.ns="http://www.w3.org/2000/svg",this.nsxlink="http://www.w3.org/1999/xlink",this.series=[],this._dom=a,this.options.hasOwnProperty("padding")&&(this.options.paddingTop=this.options.paddingBottom=this.options.paddingLeft=this.options.paddingRight=this.options.padding);var g,h;g=a.style.width&&-1==a.style.width.indexOf("%")?parseInt(a.style.width.replace("px","")):b(a).width(),h=a.style.height&&-1==a.style.height.indexOf("%")?parseInt(a.style.height.replace("px","")):b(a).height(),this._doDom(),this.setSize(g,h),this._resize(),n(this),this.dynamicLoader=new i,this.dynamicLoader.configure(this.options.dynamicDependencies),this.trackingLines={id:0,current:!1,dasharray:[!1,"5, 5","5, 1","1, 5"],currentDasharray:[],vertical:[],horizontal:[]},this.shapeHandlers={mouseDown:[],mouseUp:[],mouseMove:[],mouseOver:[],mouseOut:[],beforeMouseMove:[],onChange:[],onCreated:[],onResizing:[],onMoving:[],onAfterResized:[],onAfterMoved:[],onSelected:[],onUnselected:[],onRemoved:[]},this.pluginsReady=b.Deferred(),this.seriesReady=b.Deferred(),this.currentAction=!1,e&&b.when(this.pluginsReady,this.seriesReady).then(function(){e(f)});if(d)for(var j in d)for(var k=0,l=d[j].length;l>k;k++)switch(j){case"top":this.getTopAxis(k,d[j][k]);break;case"bottom":this.getBottomAxis(k,d[j][k]);break;case"left":this.getLeftAxis(k,d[j][k]);break;case"right":this.getRightAxis(k,d[j][k])}this._pluginsInit(),this._seriesInit()};return z.prototype=b.extend({},j.prototype,{setAttributeTo:function(a,b,c){var d;if(c)for(d in b)a.setAttributeNS(c,d,b[d]);else for(d in b)a.setAttribute(d,b[d])},_doDom:function(){this.dom=document.createElementNS(this.ns,"svg"),this.dom.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.setAttributeTo(this.dom,{xmlns:this.ns,"font-family":this.options.fontFamily,"font-size":this.options.fontSize}),this._dom.appendChild(this.dom),this._dom.setAttribute("tabindex",1),this._dom.style.outline="none",this.defs=document.createElementNS(this.ns,"defs"),this.dom.appendChild(this.defs),this.rectEvent=document.createElementNS(this.ns,"rect"),this.setAttributeTo(this.rectEvent,{"pointer-events":"fill",fill:"transparent"}),this.dom.appendChild(this.rectEvent),this.domTitle=document.createElementNS(this.ns,"text"),this.setTitle(this.options.title),this.setAttributeTo(this.domTitle,{"text-anchor":"middle",y:20}),this.dom.appendChild(this.domTitle),this.graphingZone=document.createElementNS(this.ns,"g"),this.setAttributeTo(this.graphingZone,{transform:"translate("+this.options.paddingLeft+", "+this.options.paddingTop+")"}),this.dom.appendChild(this.graphingZone),this.axisGroup=document.createElementNS(this.ns,"g"),this.graphingZone.appendChild(this.axisGroup),this.plotGroup=document.createElementNS(this.ns,"g"),this.graphingZone.appendChild(this.plotGroup),this.layers=[],this._makeClosingLines(),this.clip=document.createElementNS(this.ns,"clipPath"),this.clip.setAttribute("id","_clipplot"+this._creation),this.defs.appendChild(this.clip),this.clipRect=document.createElementNS(this.ns,"rect"),this.clip.appendChild(this.clipRect),this.clip.setAttribute("clipPathUnits","userSpaceOnUse"),this.markerArrow=document.createElementNS(this.ns,"marker"),this.markerArrow.setAttribute("viewBox","0 0 10 10"),this.markerArrow.setAttribute("id","arrow"+this._creation),this.markerArrow.setAttribute("refX","6"),this.markerArrow.setAttribute("refY","5"),this.markerArrow.setAttribute("markerUnits","strokeWidth"),this.markerArrow.setAttribute("markerWidth","8"),this.markerArrow.setAttribute("markerHeight","6"),this.markerArrow.setAttribute("orient","auto");var a=document.createElementNS(this.ns,"path");a.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),a.setAttribute("fill","context-stroke"),this.markerArrow.appendChild(a),this.defs.appendChild(this.markerArrow),this.vertLineArrow=document.createElementNS(this.ns,"marker"),this.vertLineArrow.setAttribute("viewBox","0 0 10 10"),this.vertLineArrow.setAttribute("id","verticalline"+this._creation),this.vertLineArrow.setAttribute("refX","0"),this.vertLineArrow.setAttribute("refY","5"),this.vertLineArrow.setAttribute("markerUnits","strokeWidth"),this.vertLineArrow.setAttribute("markerWidth","20"),this.vertLineArrow.setAttribute("markerHeight","10"),this.vertLineArrow.setAttribute("orient","auto"),this.vertLineArrow.setAttribute("stroke-width","1px");var b=document.createElementNS(this.ns,"path");b.setAttribute("d","M 0 -10 L 0 10"),b.setAttribute("stroke","black"),this.vertLineArrow.appendChild(b),this.defs.appendChild(this.vertLineArrow),this.plotGroup.setAttribute("clip-path","url(#_clipplot"+this._creation+")"),this.bypassHandleMouse=!1},getDom:function(){return this.dom},setOption:function(a,b){this.options[a]=b},kill:function(){this._dom.removeChild(this.dom)},cacheOffset:function(){this.offsetCached=b(this._dom).offset()},uncacheOffset:function(){this.offsetCached=!1},focus:function(){this._dom.focus()},elementMoving:function(a){this.bypassHandleMouse=a},setWidth:function(a,b){this.width=a,b||this._resize()},setHeight:function(a,b){this.height=a,b||this._resize()},resize:function(a,b){this.setSize(a,b),this._resize()},setSize:function(a,b){this.setWidth(a,!0),this.setHeight(b,!0),this.getDrawingHeight(),this.getDrawingWidth()},getWidth:function(){return this.width},getHeight:function(){return this.height},getPaddingTop:function(){return this.options.paddingTop},getPaddingLeft:function(){return this.options.paddingLeft},getPaddingBottom:function(){return this.options.paddingBottom},getPaddingRight:function(){return this.options.paddingRight},_resetAxes:function(){for(;this.axisGroup.firstChild;)this.axisGroup.removeChild(this.axisGroup.firstChild);this.axis.left=[],this.axis.right=[],this.axis.bottom=[],this.axis.top=[]},_applyToAxis:{string:function(a,b,c){for(var d=0;d<this.axis[a].length;d++)this.axis[a][d][b].apply(this.axis[a][d],c)},"function":function(a,b){for(var c=0;c<this.axis[a].length;c++)b.call(this,this.axis[a][c],a)}},_applyToAxes:function(a,b,c,d){var e,f=[],g=0;for((c||void 0==c)&&(f.push("top"),f.push("bottom")),(d||void 0==d)&&(f.push("left"),f.push("right")),e=f.length;e>g;g++)this._applyToAxis[typeof a].call(this,f[g],a,b)},getXAxis:function(a,b){return this.axis.top.length>0&&0==this.axis.bottom.length?this.getTopAxis(a,b):this.getBottomAxis(a,b)},getYAxis:function(a,b){return this.axis.right.length>0&&0==this.axis.left.length?this.getRightAxis(a,b):this.getLeftAxis(a,b)},getTopAxis:function(a,b){return t(this,a,b,"top")},getBottomAxis:function(a,b){return t(this,a,b,"bottom")},getLeftAxis:function(a,b){return t(this,a,b,"left")},getRightAxis:function(a,b){return t(this,a,b,"right")},setBottomAxisAsTime:function(){throw"Method deprecated. Create your axis with { type: 'time' } as options instead"},setXAxis:function(a,b){this.setBottomAxis(a,b)},setYAxis:function(a,b){this.setLeftAxis(a,b)},setLeftAxis:function(a,b){b=b||0,this.axis.left[b]=a},setRightAxis:function(a,b){b=b||0,this.axis.right[b]=a},setTopAxis:function(a,b){b=b||0,this.axis.top[b]=a},setBottomAxis:function(a,b){b=b||0,this.axis.bottom[b]=a},setTitle:function(a){this.options.title=a,this.domTitle.textContent=a},displayTitle:function(){this.domTitle.setAttribute("display","inline")},hideTitle:function(){this.domTitle.setAttribute("display","none")},getDrawingHeight:function(a){if(a&&this.innerHeight)return this.innerHeight;var b=this.height-this.options.paddingTop-this.options.paddingBottom;return this.innerHeight=b},getDrawingWidth:function(a){if(a&&this.innerWidth)return this.innerWidth;var b=this.width-this.options.paddingLeft-this.options.paddingRight;return this.innerWidth=b},getBoundaryAxis:function(a,b,c){var d=this.getBoundaryAxisFromSeries(a,b,c);return d},getBoundaryAxisFromShapes:function(){},getBoundaryAxisFromSeries:function(a,b,c){var d,e,f,g,h,i,j,k="x"==b,l="min"==c,m=k?["getMinX","getMaxX"]:["getMinY","getMaxY"],n=m[l?0:1];for(d=l?Number.MAX_VALUE:Number.MIN_VALUE,g=this.getSeriesFromAxis(a,!0),i=0,j=g.length;j>i;i++)f=g[i],f.isShown()&&(h=f[n](),d=Math[c](d,h),d==h&&e&&(e.isMinOrMax(!1,b,c),e=f,f.isMinOrMax(!0,b,c)));return d},getSeriesFromAxis:function(a){for(var b=[],c=this.series.length-1;c>=0;c--)(this.series[c].getXAxis()==a||this.series[c].getYAxis()==a)&&b.push(this.series[c]);return b},getShapesOfSerie:function(a){for(var b=[],c=this.shapes.length-1;c>=0;c--)this.shapes[c].getSerie()==a&&b.push(this.shapes[c]);return b},_resize:function(){this.width&&this.height&&(this.sizeSet=!0,this.dom.setAttribute("width",this.width),this.dom.setAttribute("height",this.height),this.domTitle.setAttribute("x",this.width/2),m(this))},canRedraw:function(){return this.width&&this.height},redraw:function(a,b){return this.canRedraw()?(this.sizeSet?m(this,a,b):this._resize(),!0):void 0},updateAxes:function(){this._updateAxes()},_updateAxes:function(){var a,b,c,d,e,f=["bottom","top","left","right"];for(this.refreshMinOrMax(),b=0,c=f.length;c>b;b++)for(d=this.axis[f[b]].length-1;d>=0;d--)a=this.axis[f[b]][d],e=2>b?"x":"y",a.disabled||(a.setMinValueData(this.getBoundaryAxis(this.axis[f[b]][d],e,"min")),a.setMaxValueData(this.getBoundaryAxis(this.axis[f[b]][d],e,"max")))},autoscaleAxes:function(){this._applyToAxes("setMinMaxToFitSeries",null,!0,!0),this.redraw()},refreshMinOrMax:function(){for(var a=this.series.length-1;a>=0;a--)this.series[a].isMinOrMax(!1)},newSerie:function(a,b,c,d){var e=this;"function"==typeof c&&(c="line",d=c),c||(c="line");var f=k(this,a,b,c,function(a){e.series.push(a),e.legend&&e.legend.update(),d&&d(a),e.emit("newSerie",a)});return f},getSerie:function(a){if("number"==typeof a)return this.series[a];for(var b=0,c=this.series.length;c>b;b++)if(this.series[b].getName()==a)return this.series[b]},getSeries:function(){return this.series},drawSerie:function(a){if(!a.draw)throw"Serie has no method draw";a.draw()},resetSeries:function(){for(;this.series[0];)this.series[0].kill(!0);this.series=[]},removeSeries:function(){this.resetSeries()},killSeries:function(){this.resetSeries()},drawSeries:function(){if(this.width&&this.height)for(var a=this.series.length-1;a>=0;a--)this.series[a].isShown()&&this.series[a].draw()},_removeSerie:function(a){this.series.splice(this.series.indexOf(a),1)},selectSerie:function(a){this.selectedSerie!=a&&(this.selectedSerie&&this.selectedSerie.unselect(),this.selectedSerie=a,this.triggerEvent("onSelectSerie",a),a.select("selected"))},unselectSerie:function(a){a.unselect(),this.selectedSerie=!1,this.triggerEvent("onUnselectSerie",a)},getSelectedSerie:function(){return this.selectedSerie},makeToolbar:function(a){var c=this,d=b.Deferred();return this.dynamicLoader.load("util","./graph.toolbar",function(b){c.toolbar=new b(c,a),d.resolve(c.toolbar)}),d},newShape:function(a,c,d,e){var f,g=this;if(!e)var h=b.Deferred();if(a.id=Math.random(),!d&&!1===(f=this.triggerEvent("onBeforeNewShape",a)))return!1;f&&(a=f);var i=function(b){var f=new b(g,a.shapeOptions);if(f){if(f.setOriginalData(a,c),f.data&&(f.data.id=g.id),a.fillColor&&f.set("fillColor",a.fillColor),a.strokeColor&&f.set("strokeColor",a.strokeColor),a.strokeWidth&&f.set("strokeWidth",a.strokeWidth||(a.strokeColor?1:0)),a.layer&&f.setLayer(a.layer),a.locked&&f.lock(),a.selectOnMouseDown&&(f._selectOnMouseDown=a.selectOnMouseDown),a.selectable&&f.selectable(),a.label){a.label instanceof Array||(a.label=[a.label]);for(var i=0,j=a.label.length;j>i;i++)f.set("labelPosition",a.label[i].position,i),f.set("labelColor",a.label[i].color||"black",i),f.set("labelSize",a.label[i].size,i),f.set("labelAngle",a.label[i].angle||0,i),f.set("labelBaseline",a.label[i].baseline||"no-change",i),a.label[i].anchor&&f.set("labelAnchor",a.label[i].anchor,i);f.setLabelNumber(j)}return g.shapes.push(f),g.triggerEvent("onShapeMake",f,a),e||h.resolve(f),d||g.triggerEvent("onNewShape",a),g.emit("newShape",f),f}};if(a.url)var j=this.dynamicLoader.load("external",a.url,i);else var j=this.dynamicLoader.load("shapes","graph.shape."+a.type,i);return e?j:h},redrawShapes:function(){for(var a=0,b=this.shapes.length;b>a;a++)this.shapes[a].redraw()},removeShapes:function(){for(var a=0,b=this.shapes.length;b>a;a++)this.shapes[a]&&this.shapes[a].kill&&this.shapes[a].kill(!0);this.shapes=[]},_removeShape:function(a){this.shapes.splice(this.shapes.indexOf(a),1)},appendShapeToDom:function(a){this.getLayer(a.getLayer(),"shape").appendChild(a.group)},removeShapeFromDom:function(a){this.getLayer(a.getLayer(),"shape").removeChild(a.group)},appendSerieToDom:function(a){this.getLayer(a.getLayer(),"serie").appendChild(a.groupMain)},removeSerieFromDom:function(a){this.getLayer(a.getLayer(),"serie").removeChild(a.groupMain)},getLayer:function(a,b){if(!this.layers[a]){this.layers[a]=[],this.layers[a][0]=document.createElementNS(this.ns,"g"),this.layers[a][1]=document.createElementNS(this.ns,"g"),this.layers[a][2]=document.createElementNS(this.ns,"g"),this.layers[a][0].appendChild(this.layers[a][1]),this.layers[a][0].appendChild(this.layers[a][2]);for(var c,d=1;!(c=this.layers[a-d])&&a-d>=0;)d++;c?c.nextSibling?this.plotGroup.insertBefore(this.layers[a][0],c.nextSibling):this.plotGroup.appendChild(this.layers[a][0]):this.plotGroup.insertBefore(this.layers[a][0],this.plotGroup.firstChild)}return this.layers[a]["shape"==b?2:1]},_makeClosingLines:function(){this.closingLines={};for(var a,b=["top","bottom","left","right"],c=0,d=4;d>c;c++){var a=document.createElementNS(this.ns,"line");a.setAttribute("stroke","black"),a.setAttribute("shape-rendering","crispEdges"),a.setAttribute("stroke-linecap","square"),a.setAttribute("display","none"),this.closingLines[b[c]]=a,this.graphingZone.appendChild(a)}},_seriesInit:function(){var a=this,b=this.options.series,c=b.length;return 0==c?a._seriesReady():void b.map(function(b){a.dynamicLoader.load("serie","graph.serie."+b,function(){0==--c&&a._seriesReady()})})},_seriesReady:function(){this.seriesReady.resolve()},isPluginAllowed:function(a,b){if(this.forcedPlugin==b)return!0;var c=this.options.pluginAction[b]||b,d=a.shiftKey,e=a.ctrlKey;return void 0===c.shift&&(c.shift=!1),void 0===c.ctrl&&(c.ctrl=!1),d!==c.shift?!1:e!==c.ctrl?!1:!0},forcePlugin:function(a){this.forcedPlugin=a},unforcePlugin:function(){this.forcedPlugin=!1},_pluginsExecute:function(a,b){for(var c in this._plugins)this._plugins[c]&&this._plugins[c][a]&&this._plugins[c][a].apply(this._plugins[c],b)},_pluginExecute:function(a,b,c){this._plugins[a]&&this._plugins[a][b]&&this._plugins[a][b].apply(this._plugins[a],c)
},_pluginsInit:function(){var a,b,c=this;if(this._plugins=this._plugins||{},Array.isArray(this.options.plugins))a=this.options.plugins;else{a=[];for(var d in this.options.plugins)a.push(d)}return 0==(b=a.length)?c._pluginsReady():(this.pluginsToLoad=a.length,void this.dynamicLoader.load("plugin",a,function(a,d,e){c._plugins[e]=new a,c._plugins[e].init(c,c.options.plugins[e]||{},e),0==--b&&c._pluginsReady()}))},getPlugin:function(a){var b=this;return this.pluginsReady.then(function(){return b._plugins[a]||!1})},_pluginsReady:function(){this.pluginsReady.resolve()},triggerEvent:function(){{var a=arguments[0];Array.prototype.splice.apply(arguments,[0,1])}return"function"==typeof this.options[a]?this.options[a].apply(this,arguments):void 0},selectShape:function(a){if(this.selectedShapes.indexOf(a)>-1)return!1;if(!a.isSelectable())return!1;if(this.emit("beforeShapeSelect",a),this.cancelSelectShape)return void(this.cancelSelectShape=!1);if(this.cancelSelectShape=!1,this.selectedShapes.length>0&&"unique"==this.options.shapeSelection)for(;this.selectedShapes[0];)this.unselectShape(this.selectedShapes[0]);a._select(),this.selectedShapes.push(a),this.emit("shapeSelect",a)},unselectShape:function(a){if(-1!=this.selectedShapes.indexOf(a)){if(this.emit("beforeShapeSelect",a),this.cancelUnselectShape)return void(this.cancelUnselectShape=!1);a._unselect(),this.selectedShapes.splice(this.selectedShapes.indexOf(a),1),this.emit("shapeUnselect",a)}},unselectShapes:function(){for(;this.selectedShapes[0];)this.unselectShape(this.selectedShapes[0])},makeLegend:function(a){return this.legend=new h(this,a),this.graphingZone.appendChild(this.legend.getDom()),this.legend.update(),this.legend},updateLegend:function(){this.legend&&this.legend.update()},getPosition:function(a,b,c,d,e){var f,g={x:!1,y:!1};if(c||(c=this.getXAxis()),d||(d=this.getYAxis()),a){for(var h in g){var i="x"==h?c:d;if(void 0===a[h]&&(void 0!==a["d"+h]&&void 0===b||void 0===b)){if("x"==h){if(void 0===a["d"+h])continue;g[h]=b?b[h]:i.getPos(0)}else if(a.x&&e){if(l(a.x)!==!1)console.warn("You have defined x in px and not y. Makes no sense. Returning 0 for y"),g[h]=0;else{var j=e.searchClosestValue(a.x);j?g[h]=e.getY(j.yMin):(console.warn("Could not find y position. Returning 0 for y."),g[h]=0)}}}else void 0!==a[h]&&(g[h]=this.getPx(a[h],i));if(void 0!==a["d"+h]){var k=void 0!==a[h]||void 0==b||void 0==b[h]?g[h]:this._getPositionPx(b[h],!0,i)||0;if("y"==h&&b&&b.x&&!b.y){if(!e)throw"Error. No serie exists. Cannot find y value";var j=e.searchClosestValue(b.x);j&&(k=e.getY(j.yMin))}(f=l(a["d"+h]))!==!1?g[h]=k+f:(f=this._parsePercent(a["d"+h]))?g[h]=k+this._getPositionPx(f,!0,i):i&&(g[h]=k+i.getRelPx(a["d"+h]))}}return g}},_getPositionPx:function(a,b,c){var d;return(d=l(a))!==!1?d:(d=this._parsePercent(a))!==!1?d/100*(b?this.graph.getDrawingWidth():this.graph.getDrawingHeight()):c?c.getPos(a):void 0},_parsePercent:function(a){return a&&a.indexOf&&a.indexOf("%")>-1?a:!1},getDeltaPx:function(a,b){var c;return(c=l(a))!==!1?c+"px":b.getRelPx(a)+"px"},deltaPosition:function(a,b,c){var d,e;return(d=l(a))!==!1?(e=l(b))!==!1?d+e+"px":d+c.getRelPx(b)+"px":(a=this.getValPosition(a,c),(e=l(b))!==!1?a+c.getRelVal(e):a+b)},getValPosition:function(a,b){return"max"==a?b.getMaxValue():"min"==a?b.getMinValue():a},getPx:function(a,b,c){var d;return(d=l(a))!==!1?d:(d=this._parsePercent(a))?d:b?"min"==a?b.getMinPx():"max"==a?b.getMaxPx():c?b.getRelPx(a):b.getPos(a):void 0},getPxRel:function(a,b){return this.getPx(a,b,!0)},contextListen:function(a,b,c){var d=this;return this.options.onContextMenuListen?this.options.onContextMenuListen(a,b,c):void(this.context?this.context.listen(a,b,c):this.dynamicLoader.load("util","./util/context",function(e){var f=new e;f.init(d._dom),f.listen(a,b,c),d.context=f}))},lockShapes:function(){this.shapesLocked=!0},unlockShapes:function(){this.shapesLocked=!1},_getXY:function(c){var d=c.clientX,e=c.clientY;e=c.clientY;var f=this.offsetCached||b(this._dom).offset();return d-=f.left-a.scrollX,e-=f.top-a.scrollY,{x:d,y:e}},mapEventEmission:function(a,b){b||(b=this);var c;for(var d in a)0==d.indexOf("on")&&"function"==typeof a[d]&&(c=d.substring(2),c=c.substring(0,1).toLowerCase()+c.substring(1),b.on&&b.on(c,a[d]))},uniqueId:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}}),z}(c["./jquery"],c["./graph.axis.x"],c["./graph.axis.y"],c["./graph.axis.x.broken"],c["./graph.axis.y.broken"],c["./graph.xaxis.time"],c["./graph.legend"],c["./dynamicdepencies"],c["./dependencies/eventEmitter/EventEmitter"]),c["./graph._serie"]=function(a){var c=function(){throw"This serie is not instanciable"};return c.prototype=b.extend({},a.prototype,{setAdditionalData:function(a){return this.additionalData=a,this},getAdditionalData:function(){return this.additionalData},setData:function(a,b,c){var d,e,f,g,h=0,b=b||"2D",c=c||"float",i=0;if(this.minX=+1/0,this.minY=+1/0,this.maxX=-1/0,this.maxY=-1/0,!(!a instanceof Array)){var j=[];a instanceof Array||"object"!=typeof a?a instanceof Array&&!(a[0]instanceof Array)&&(a=[a],b="1D"):a=[a];var k="2D"==b;if(a[0]instanceof Array&&"2D"==b&&!(a[0][0]instanceof Array)&&(a=[a]),a[0]instanceof Array)for(var l=0,m=a.length;m>l;l++){f=this._addData(c,k?2*a[l].length:a[l].length),j.push(f),h=0;for(var n=0,o=a[l].length;o>n;n++)k?(f[h]=a[l][n][0],this._checkX(f[h]),h++,f[h]=a[l][n][1],this._checkY(f[h]),h++,i++):(f[h]=a[l][n],this[n%2==0?"_checkX":"_checkY"](f[h]),h++,i+=n%2?1:0)}else if("object"==typeof a[0]){this.mode="x_equally_separated";var p,q=0,r=[],j=[],m=0;if(!a[0].y)return;for(var l=0,o=a.length;o>l;l++)q+=a[l].y.length,g=0!=l&&(!a[l+1]||a[l].x+a[l].dx*a[l].y.length==a[l+1].x),g||(j.push(this._addData(c,q)),r.push(q),q=0);this.xData=[],q=0,m=0,h=0;for(var l=0,o=a.length;o>l;l++){d=a[l].x,e=a[l].dx,this.xData.push({x:d,dx:e}),p=a[l].y.length,this._checkX(d),this._checkX(d+e*p);for(var n=0;p>n;n++)j[m][h]=a[l].y[n],this._checkY(j[m][h]),h++,i++;q+=a[l].y.length,r[m]==q&&(m++,q=0,h=0)}}var s=((this.maxX-this.minX)/this.graph.getDrawingWidth(),[]),t=4*this.graph.getDrawingWidth(),u=i/4,t=this.graph.getDrawingWidth(),u=i;if(this.data=j,t>0){for(;u>t;)s.push(t),t*=4;this.slots=s,this.options.useSlots&&this.calculateSlots()}if(this.isFlipped()){var v=this.maxX,w=this.maxY,x=this.minX,y=this.minY;this.maxX=w,this.maxY=v,this.minX=y,this.minY=x}return this.graph._updateAxes(),this}},_addData:function(a,b){switch(a){case"int":var c=4*b;break;case"float":var c=8*b}var d=new ArrayBuffer(c);switch(a){case"int":return new Int32Array(d);default:case"float":return new Float64Array(d)}},kill:function(a){if(this.graph.removeSerieFromDom(this),this.picks&&this.picks.length)for(var b=0,c=this.picks.length;c>b;b++)this.picks[b].kill();this.graph._removeSerie(this),a||this.graph.redraw(),this.graph.legend&&this.graph.legend.update()},isMinOrMax:function(a,b,c){return void 0==a?this._isMinOrMax.x.min||this._isMinOrMax.x.max||this._isMinOrMax.y.min||this._isMinOrMax.y.max:void 0==c&&void 0!=b?(this._isMinOrMax[b].min=a,void(this._isMinOrMax[b].max=a)):void(void 0!=b&&void 0!=c&&(this._isMinOrMax[b][c]=a))},hide:function(a){if(this.hidden=!0,this.groupMain.setAttribute("display","none"),this.getSymbolForLegend().setAttribute("opacity",.5),this.getTextForLegend().setAttribute("opacity",.5),this.hideImpl(),a)for(var b=this.graph.getShapesOfSerie(this),c=0,d=b.length;d>c;c++)b[c].hide()},show:function(a){if(this.hidden=!1,this.groupMain.setAttribute("display","block"),this.getSymbolForLegend().setAttribute("opacity",1),this.getTextForLegend().setAttribute("opacity",1),this.showImpl(),this.draw(),a)for(var b=this.graph.getShapesOfSerie(this),c=0,d=b.length;d>c;c++)b[c].show()},hideImpl:function(){},showImpl:function(){},toggleShow:function(){return this.shown?void this.hide():void this.show()},isShown:function(){return!this.hidden},getX:function(a){return Math.round(5*this.getXAxis().getPx(a))/5},getY:function(a){return Math.round(5*this.getYAxis().getPx(a))/5},isSelected:function(){return this.selected||"unselected"!==this.selectionType},_checkX:function(a){this.minX=Math.min(this.minX,a),this.maxX=Math.max(this.maxX,a)},_checkY:function(a){this.minY=Math.min(this.minY,a),this.maxY=Math.max(this.maxY,a)},getName:function(){return this.name},autoAxis:function(){return this.setXAxis(this.isFlipped()?this.graph.getYAxis():this.graph.getXAxis()),this.setYAxis(this.isFlipped()?this.graph.getXAxis():this.graph.getYAxis()),this.graph._updateAxes(),this},setXAxis:function(a){return this.xaxis="number"==typeof a?this.isFlipped()?this.graph.getYAxis(a):this.graph.getXAxis(a):a,this},setYAxis:function(a){return"number"==typeof a?this.xaxis=this.isFlipped()?this.graph.getXAxis(a):this.graph.getYAxis(a):this.yaxis=a,this},getXAxis:function(){return this.xaxis},getYAxis:function(){return this.yaxis},setAxes:function(){for(var a=0;2>a;a++)arguments[a]&&this["x"==arguments[a].isXY()?"setXAxis":"setYAxis"](arguments[a]);return this},getMinX:function(){return this.minX},getMaxX:function(){return this.maxX},getMinY:function(){return this.minY},getMaxY:function(){return this.maxY},getSymbolForLegend:function(){if(!this.lineForLegend){var a=document.createElementNS(this.graph.ns,"line");this.applyLineStyle(a),a.setAttribute("x1",5),a.setAttribute("x2",25),a.setAttribute("y1",0),a.setAttribute("y2",0),a.setAttribute("cursor","pointer"),this.lineForLegend=a}return this.lineForLegend},getTextForLegend:function(){if(!this.textForLegend){var a=document.createElementNS(this.graph.ns,"text");a.setAttribute("transform","translate(35, 3)"),a.setAttribute("cursor","pointer"),a.textContent=this.getLabel(),this.textForLegend=a}return this.textForLegend},setLegendSymbolStyle:function(){this.applyLineStyle(this.getSymbolForLegend())},getIndex:function(){return this.graph.series.indexOf(this)},getLabel:function(){return this.options.label||this.name},setLabel:function(a){return this.options.label=a,this},setFlip:function(a){this.options.flip=a},getFlip:function(){return this.options.flip},isFlipped:function(){return this.options.flip},isXMonotoneous:function(){return this.xmonotoneous||!1},XMonotoneousDirection:function(){return this.data[0][2]-this.data[0][0]>0},getLayer:function(){return this.options.layer||1},setLayer:function(a){this.options.layer=a},updateStyle:function(){this.setLegendSymbolStyle()}}),c}(c["./dependencies/eventEmitter/EventEmitter"]),c["./plugins/graph.plugin.drag"]=function(){var a=function(){};return a.prototype={init:function(){},onMouseDown:function(a,b,c){return this._draggingX=b,this._draggingY=c,!0},onMouseMove:function(a,b,c){var d=b-this._draggingX,e=c-this._draggingY;a._applyToAxes(function(a){a.setCurrentMin(a.getVal(a.getMinPx()-d)),a.setCurrentMax(a.getVal(a.getMaxPx()-d))},!1,!0,!1),a._applyToAxes(function(a){a.setCurrentMin(a.getVal(a.getMinPx()-e)),a.setCurrentMax(a.getVal(a.getMaxPx()-e))},!1,!1,!0),this._draggingX=b,this._draggingY=c,a.redraw(!0),a.drawSeries()}},a}(),c["./plugins/graph.plugin.shape"]=function(){var a=function(){};return a.prototype={init:function(a,b){this.options=b,this.graph=a,this.shapeType=b.type},setShape:function(a){this.shapeInfo.shapeType=a},onMouseDown:function(a,c,d,e){if(this.shapeType||this.options.url){var f,g,h=this;this.count=this.count||0,c-=a.getPaddingLeft(),d-=a.getPaddingTop(),f=a.getXAxis().getVal(c),g=a.getYAxis().getVal(d);var i={pos:{x:f,y:g},pos2:{x:f,y:g},onChange:function(b){a.triggerEvent("onAnnotationChange",b)}},j=a.newShape(b.extend(i,this.options),{},!1);j&&j.then(function(a){a&&(h.currentShape=a,h.currentShapeEvent=e)})}},onMouseMove:function(a,b,c,d){var e=this;if(e.currentShape){e.count++;var f=e.currentShape;e.currentShape=!1,a.selectedSerie&&f.setSerie(a.selectedSerie),f.created(),f.options&&f.options.onCreate&&f.options.onCreate.call(f),f.draw(),f.select(),f.handleMouseDown(e.currentShapeEvent,!0),f.handleMouseMove(d,!0)}},onMouseUp:function(){var a=this;a.currentShape&&(a.currentShape=!1)}},a}(),c["./dependencies/eventEmitter/eventEmitter"]=function(){function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype;return d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},a}(),c["./plugins/graph.plugin.selectScatter"]=function(a){var c=function(){};return c.prototype=b.extend(c.prototype,a.prototype,{init:function(a,b){this._path=document.createElementNS(a.ns,"path"),a.setAttributeTo(this._path,{display:"none",fill:"rgba(0,0,0,0.1)",stroke:"rgba(0,0,0,1)","shape-rendering":"crispEdges",x:0,y:0,height:0,width:0,d:""}),this.options=b,this.graph=a,a.dom.appendChild(this._path)},setSerie:function(a){this.serie=a},onMouseDown:function(a,b,c){this.serie&&(this.path="M "+b+" "+c+" ",this.currentX=b,this.currentY=c,this.xs=[this.serie.getXAxis().getVal(b-a.getPaddingLeft())],this.ys=[this.serie.getYAxis().getVal(c-a.getPaddingTop())],this._path.setAttribute("d",""),this._path.setAttribute("display","block"))},onMouseMove:function(a,b,c){Math.pow(b-this.currentX,2)+Math.pow(c-this.currentY,2)>25&&(this.path+=" L "+b+" "+c+" ",this.currentX=b,this.currentY=c,this.xs.push(this.serie.getXAxis().getVal(b-a.getPaddingLeft())),this.ys.push(this.serie.getYAxis().getVal(c-a.getPaddingTop())),this._path.setAttribute("d",this.path+" z"),this.findPoints())},findPoints:function(){for(var a,b=this.serie.data,c=[],d=0,e=0,f=b.length;f>e;e+=2){d=0;for(var g=0,h=this.xs.length;h>g;g+=1)a=g==h-1?0:g+1,(this.ys[g]<b[e+1]&&this.ys[a]>b[e+1]||this.ys[g]>b[e+1]&&this.ys[a]<b[e+1])&&b[e]>(b[e+1]-this.ys[g])/(this.ys[a]-this.ys[g])*(this.xs[a]-this.xs[g])+this.xs[g]&&d++;d%2==1?(c.push(e/2),this.serie.selectPoint(e/2,!0,"selected")):this.serie.unselectPoint(e/2)}this.selected=c,this.emit("selectionProcess",c)},onMouseUp:function(){this._path.setAttribute("display","none"),this.emit("selectionEnd",this.selected)},removeZone:function(){}}),c}(c["./dependencies/eventEmitter/eventEmitter"]),c["./plugins/graph.plugin.zoom"]=function(){var a=function(){};return a.prototype={init:function(a,b){this._zoomingGroup=document.createElementNS(a.ns,"g"),this._zoomingSquare=document.createElementNS(a.ns,"rect"),this._zoomingSquare.setAttribute("display","none"),a.setAttributeTo(this._zoomingSquare,{display:"none",fill:"rgba(171,12,12,0.2)",stroke:"rgba(171,12,12,1)","shape-rendering":"crispEdges",x:0,y:0,height:0,width:0}),this.options=b,this.graph=a,a.dom.appendChild(this._zoomingGroup),this._zoomingGroup.appendChild(this._zoomingSquare)},onMouseDown:function(a,b,c,d,e){var f=this.options.zoomMode;if(f){switch(this._zoomingMode=f,void 0===b&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode="y",b=0),void 0===c&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode="x",c=0),this._zoomingXStart=b,this._zoomingYStart=c,this.x1=b-a.getPaddingLeft(),this.y1=c-a.getPaddingTop(),this._zoomingSquare.setAttribute("width",0),this._zoomingSquare.setAttribute("height",0),this._zoomingSquare.setAttribute("display","block"),this._zoomingMode){case"x":this._zoomingSquare.setAttribute("y",a.options.paddingTop),this._zoomingSquare.setAttribute("height",a.getDrawingHeight()-a.shift[0]);break;case"y":this._zoomingSquare.setAttribute("x",a.options.paddingLeft),this._zoomingSquare.setAttribute("width",a.getDrawingWidth())}this.options.onZoomStart&&!e&&this.options.onZoomStart(a,b,c,d,e)}},onMouseMove:function(a,b,c,d,e){switch(this._zoomingMode){case"xy":this._zoomingSquare.setAttribute("x",Math.min(this._zoomingXStart,b)),this._zoomingSquare.setAttribute("y",Math.min(this._zoomingYStart,c)),this._zoomingSquare.setAttribute("width",Math.abs(this._zoomingXStart-b)),this._zoomingSquare.setAttribute("height",Math.abs(this._zoomingYStart-c));break;case"x":this._zoomingSquare.setAttribute("x",Math.min(this._zoomingXStart,b)),this._zoomingSquare.setAttribute("width",Math.abs(this._zoomingXStart-b));break;case"y":this._zoomingSquare.setAttribute("y",Math.min(this._zoomingYStart,c)),this._zoomingSquare.setAttribute("height",Math.abs(this._zoomingYStart-c))}this.options.onZoomMove&&!e&&this.options.onZoomMove(a,b,c,d,e)},onMouseUp:function(a,b,c,d,e){this.removeZone();var f=b-a.options.paddingLeft,g=c-a.options.paddingTop;if(!(b-this._zoomingXStart==0&&"y"!=this._zoomingMode||c-this._zoomingYStart==0&&"x"!=this._zoomingMode)){switch(a.cancelClick=!0,this._zoomingMode){case"x":a._applyToAxes("_doZoom",[f,this.x1],!0,!1);break;case"y":a._applyToAxes("_doZoom",[g,this.y1],!1,!0);break;case"xy":a._applyToAxes("_doZoom",[f,this.x1],!0,!1),a._applyToAxes("_doZoom",[g,this.y1],!1,!0)}a.redraw(!0),a.drawSeries(),this.options.onZoomEnd&&!e&&this.options.onZoomEnd(a,f,g,d,e,this.x1,this.y1),this._backedUpZoomMode&&(this._zoomingMode=this._backedUpZoomMode)}},removeZone:function(){this._zoomingSquare.setAttribute("display","none")},onMouseWheel:function(a,b,c){c||(c={}),c.baseline||(c.baseline=0);var d;if(!(d=this.graph.getSelectedSerie())||!d.getYAxis().handleMouseWheel(a,b)){var e="x"==c.direction,f=!("y"!==c.direction);this.graph._applyToAxes("handleMouseWheel",[a,b,c.baseline],e,f),this.graph.drawSeries()}},onDblClick:function(a,b,c,d,e,f){var g=this.graph.getXAxis(),h=this.graph.getYAxis();if("xtotal"==d.mode)this.graph._applyToAxes("setMinMaxToFitSeries",null,!0,!1),this.graph.drawSeries();else if("ytotal"==d.mode)this.graph._applyToAxes("setMinMaxToFitSeries",null,!1,!0),this.graph.drawSeries();else if("total"==d.mode)this.graph.autoscaleAxes(),this.graph.drawSeries(),this.graph._applyToAxes(function(a){a.emit("zoom",a.currentAxisMin,a.currentAxisMax,a)},null,!0,!0);else{b-=this.graph.options.paddingLeft,c-=this.graph.options.paddingTop;var i=g.getActualMin(),j=g.getActualMax(),k=g.getVal(b),l=j-i,m=h.getActualMin(),n=h.getActualMax(),o=h.getVal(c),p=n-m;if("gradualXY"==d.mode||"gradualX"==d.mode){var q=(k-i)/(j-i);i=Math.max(g.getMinValue(),i-l*q),j=Math.min(g.getMaxValue(),j+l*(1-q)),g.setCurrentMin(i),g.setCurrentMax(j),g.options.onZoom&&g.options.onZoom(i,j)}if("gradualXY"==d.mode||"gradualY"==d.mode){var q=(o-m)/(n-m);m=Math.max(h.getMinValue(),m-p*q),n=Math.min(h.getMaxValue(),n+p*(1-q)),h.setCurrentMin(m),h.setCurrentMax(n),h.options.onZoom&&h.options.onZoom(m,n)}this.graph.redraw(),this.graph.drawSeries()}this.options.onDblClick&&!f&&this.options.onDblClick(b,c,d,e)}},a}(),c["./series/slotoptimizer"]=function(){function a(){var a=URL.createObjectURL(new Blob([" ( "+function(){onmessage=function(a){for(var b,c=a.data.data,d=a.data.slotNumber,e=a.data.slot,f=(a.data.flip,a.data.max),g=a.data.min,h=e/(f-g),i=[],j=0,k=c.length;k>j;j++)for(var l=0,m=c[j].length;m>l;l+=2)b=Math.floor((c[j][l]-g)*h),i[b]=i[b]||{min:c[j][l+1],max:c[j][l+1],start:c[j][l+1],stop:!1,x:c[j][l]},i[b].stop=c[j][l+1],i[b].min=Math.min(c[j][l+1],i[b].min),i[b].max=Math.max(c[j][l+1],i[b].max);postMessage({slotNumber:d,slot:e,data:i,_queueId:a.data._queueId})}}.toString()+")()"],{type:"application/javascript"}));d=new Worker(a),d.onmessage=function(a){var b=a.data._queueId;delete a.data._queueId,e[b].resolve(a.data.data),delete e[b]}}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}var d,e={};return function(f){d||a();var g=c();return f._queueId=g,e[g]=b.Deferred(),d.postMessage(f),e[g]}}(),c["./series/graph.serie.line"]=function(a,c){function d(a,b,c,d){if(b){if(a.options.markersIndependant){var e=a.getMarkerDomIndependant(a.counter1,a.counter2,b),f="M "+c+" "+d+" ";f+=b.markerPath+" ",e.setAttribute("d",f)}b.path=b.path||"",b.path+="M "+c+" "+d+" ",b.path+=b.markerPath+" "}}function e(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=0,q=a.data.length,r=0,s=[],t=0,u=1,v=a.isXMonotoneous(),w=a.getXAxis().getMathMaxPx();a.isFlipped()&&(t=1,u=0);var x=[],y=[],z=[],A=0;if("x_equally_separated"==a.mode){if(a.isFlipped())return[a.data,a.xData];for(z=[];q>p;p++){r=0,f=0,g=a.data[p].length;var B=Math.round(a.degradationPx/a.getXAxis().getRelPx(a.xData[p].dx));for(1==B&&(y.push(a.xData[p]),x.push(a.data[p])),h=1/0,i=-1/0;g>r;r+=1)if(a.markerPoints&&a.getMarkerCurrentFamily(f),b=a.xData[p].x+r*a.xData[p].dx,v&&0>b)o=[b,c,a.data[p][r]];else{if(v&&o&&(A+=o[2],h=Math.min(h,o[2]),i=Math.max(i,o[2]),o=!1,f++),A+=a.data[p][r],h=Math.min(h,a.data[p][r]),i=Math.max(i,a.data[p][r]),(r%B==0&&r>0||n)&&(z.push(A/B),s.push(a.xData[p].x+r*a.xData[p].dx-B/2*a.xData[p].dx,h,i),h=1/0,i=-1/0,A=0),v&&b>w){n=!0;break}f++}x.push(z),y.push({dx:B*a.xData[p].dx,x:a.xData[p].x+B*a.xData[p].dx/2})}return a.degradationSerie&&(a.degradationSerie.setData(s),a.degradationSerie.draw()),[x,y]}for(;q>p;p++){r=0,f=0,g=a.data[p].length,j=0,k=0,h=1/0,i=-1/0;for(var C=[];g>r;r+=2)if(d=a.getX(a.data[p][r+t]),v&&0>d)o=[d,a.getY(a.data[p][r+u]),a.data[p][r+t],a.data[p][r+u]];else{if(v&&o?(k+=o[3],j++,h=Math.min(h,o[3]),i=Math.max(i,o[3]),l=o[2],m=o[0],o=!1,f++):void 0===l&&(l=a.data[p][r+t],m=d),Math.abs(d-m)>a.degradationPx&&g>r){if(C.push((l+a.data[p][r+t])/2,k/j),s.push((a.data[p][r+t]+l)/2,h,i),m>w)break;l=void 0,j=0,k=0,h=1/0,i=-1/0,f++}k+=a.data[p][r+u],j++,h=Math.min(h,a.data[p][r+u]),i=Math.max(i,a.data[p][r+u]),v&&d>w&&(n=!0),b=d,c=e}if(x.push(C),n)break}return a.degradationSerie&&(a.degradationSerie.setData(s),a.degradationSerie.draw()),[x]}function f(a){if(a.picks)for(var b=0;b<a.picks.length;b++)a.picks[b].hide()}function g(a){if(a.picks)for(var b=0;b<a.picks.length;b++)a.picks[b].show()}var h=function(){};return b.extend(h.prototype,a.prototype,{defaults:{lineColor:"black",lineStyle:1,flip:!1,label:"",lineWidth:1,markers:!1,trackMouse:!1,trackMouseLabel:!1,trackMouseLabelRouding:1,lineToZero:!1,autoPeakPicking:!1,autoPeakPickingNb:4,autoPeakPickingMinDistance:10,autoPeakPickingFormat:!1,autoPeakPickingAllowAllY:!1,selectableOnClick:!0,markersIndependant:!1},init:function(a,c,d){var e=this;if(this.selectionType="unselected",this.markerFamilies={},this.graph=a,this.name=c,this.id=this.graph.uniqueId(),this.options=b.extend(!0,{},h.prototype.defaults,d||{}),this.graph.mapEventEmission(this.options,this),this.styles={},this.styles.unselected={lineColor:this.options.lineColor,lineStyle:this.options.lineStyle,markers:this.options.markers},this.styles.selected={lineWidth:3},this.shown=!0,this.data=[],this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupLines=document.createElementNS(this.graph.ns,"g"),this.domMarker=document.createElementNS(this.graph.ns,"path"),this.domMarker.style.cursor="pointer",this.groupMain=document.createElementNS(this.graph.ns,"g"),this.additionalData={},this.marker=document.createElementNS(this.graph.ns,"circle"),this.marker.setAttribute("fill","black"),this.marker.setAttribute("r",3),this.marker.setAttribute("display","none"),this.markerLabel=document.createElementNS(this.graph.ns,"text"),this.markerLabelSquare=document.createElementNS(this.graph.ns,"rect"),this.markerLabelSquare.setAttribute("fill","white"),this.domMarkerHover={},this.domMarkerSelect={},this.markerHovered=0,this.groupMarkerSelected=document.createElementNS(this.graph.ns,"g"),this.groupLabels=document.createElementNS(this.graph.ns,"g"),this.lines=[],this.groupMain.appendChild(this.groupLines),this.groupMain.appendChild(this.groupLabels),this.groupMain.appendChild(this.marker),this.groupMain.appendChild(this.groupMarkerSelected),this.groupMain.appendChild(this.markerLabelSquare),this.groupMain.appendChild(this.markerLabel),this.independantMarkers=[],this.initExtended1&&this.initExtended1(),this.options.autoPeakPicking){this.picks=this.picks||[],this.picksDef=[];for(var f=0,g=this.options.autoPeakPickingNb;g>f;f++)this.picksDef.push(this.graph.newShape({type:"label",label:{text:"",position:{x:0},anchor:"middle"},selectable:!0,shapeOptions:{minPosY:15}}).then(function(a){a.setSerie(e),e.picks.push(a)}))}this.groupLines.addEventListener("click",function(){e.options.selectableOnClick&&(e.isSelected()?e.unselect():e.select("selected"))})},setAdditionalData:function(a){return this.additionalData=a,this},getAdditionalData:function(){return this.additionalData},calculateSlots:function(){this.slotsData={};for(var a=0,b=this.slots.length;b>a;a++)this.calculateSlot(this.slots[a],a)},slotCalculator:function(a,b){return c({min:this.minX,max:this.maxX,data:this.data,slot:a,slotNumber:b,flip:this.getFlip()})},calculateSlot:function(a,b){var c=this;this.slotsData[a]=this.slotCalculator(a,b),this.slotsData[a].pipe(function(b){return c.slotsData[a]=b,b})},onMouseOverMarker:function(a,b){this.toggleMarker(b,!0,!0);this.options.onMouseOverMarker&&this.options.onMouseOverMarker(b,this.infos?this.infos[b[0]]||!1:!1,[this.data[b[1]][2*b[0]],this.data[b[1]][2*b[0]+1]])},onMouseOutMarker:function(a,b){this.markersOffHover(),this.options.onMouseOutMarker&&this.options.onMouseOutMarker(b,this.infos?this.infos[b[0]]||!1:!1,[this.data[b[1]][2*b[0]],this.data[b[1]][2*b[0]+1]])},toggleMarker:function(a,b,c){var d=a[0],e=a[1]||0;a=a.join();var f;"undefined"==typeof b&&(f=c?!this.domMarkerHover[a]:!this.domMarkerSelect[a]);var g=this["domMarker"+(c?"Hover":"Select")];if(f||b===!0){if(g[a])h=g[a];else{var h=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(h,this.markerFamilies[this.selectionType][this.getMarkerCurrentFamily(d)]),this["domMarker"+(c?"Hover":"Select")][a]=h,this.groupMarkerSelected.appendChild(h)}var i=this.getX(this.data[e][2*d]),j=this.getY(this.data[e][2*d+1]);h.setAttribute("d","M "+i+" "+j+" "+this.getMarkerPath(this.markerFamilies[this.selectionType][this.getMarkerCurrentFamily(d)],1)),c&&this.markerHovered++}else if((!f||b===!1)&&(c&&this.domMarkerHover[a]&&!this.domMarkerSelect[a]||this.domMarkerSelect[a])){if(!g[a])return;this.groupMarkerSelected.removeChild(g[a]),delete g[a],c&&this.markerHovered--}return f},markersOffHover:function(){for(var a in this.domMarkerHover)this.toggleMarker(a.split(","),!1,!0)},onClickOnMarker:function(a,b){var c=this.toggleMarker(b);c&&this.options.onSelectMarker&&this.options.onSelectMarker(b,this.infos?this.infos[b[0]]||!1:!1),!c&&this.options.onUnselectMarker&&this.options.onUnselectMarker(b,this.infos?this.infos[b[0]]||!1:!1),this.options.onToggleMarker&&this.options.onToggleMarker(b,this.infos?this.infos[b[0]]||!1:!1,c)},_getMarkerIndexFromEvent:function(a){var b=this.graph._getXY(a);return this.searchIndexByPxXY(b.x-this.graph.getPaddingLeft(),b.y-this.graph.getPaddingTop())},onMouseWheel:function(){},empty:function(){for(var a=0,b=this.lines.length;b>a;a++)this.groupLines.removeChild(this.lines[a]);for(;this.groupMarkers.firstChild;)this.groupMarkers.removeChild(this.groupMarkers.firstChild)},select:function(a){a=a||"selected",this.selected=!0,this.areMarkersShown()||this.areMarkersShown(a)?(this.selectionType=a,this.draw(),this.applyLineStyles()):(this.selectionType=a,this.applyLineStyles()),this.applyLineStyle(this.getSymbolForLegend())},unselect:function(){this.selected=!1;var a="unselected";this.areMarkersShown()||this.areMarkersShown(a)?(this.selectionType=a,this.draw(),this.applyLineStyles()):(this.selectionType=a,this.applyLineStyles()),this.applyLineStyle(this.getSymbolForLegend())},degrade:function(a,b){var c=this.graph.newSerie(this.name,b,"zone");return this.degradationPx=a,c?(c.setData([]),c.setXAxis(this.getXAxis()),c.setYAxis(this.getYAxis()),this.degradationSerie=c,c):void 0},drawInit:function(){var a,b;if(this.currentLineId=0,this.counter=0,this._drawn=!0,this.currentLine="",this.degradationPx?(a=e(this),b=a[1],a=a[0],this._dataToUse=a,this._xDataToUse=b):(this._dataToUse=this.data,this._xDataToUse=this.xData),this._optimizeMonotoneous=this.isXMonotoneous(),this._optimizeMaxPxX=this.XMonotoneousDirection()?this.getXAxis().getMaxPx():this.getXAxis().getMinPx(),this._optimizeMinPxX=this.XMonotoneousDirection()?this.getXAxis().getMinPx():this.getXAxis().getMaxPx(),this.optimizeMonotoneousDirection=this.XMonotoneousDirection()&&!this.getXAxis().isFlipped()||!this.XMonotoneousDirection()&&this.getXAxis().isFlipped(),this._optimizeBreak,this._optimizeBuffer,this._slotToUse=!1,this.options.useSlots&&this.slots&&this.slots.length>0){if(this.isFlipped())var c=this.graph.getDrawingHeight()*(this.maxY-this.minY)/(this.getYAxis().getActualMax()-this.getYAxis().getActualMin());else var c=this.graph.getDrawingWidth()*(this.maxX-this.minX)/(this.getXAxis().getActualMax()-this.getXAxis().getActualMin());for(var d=0,f=this.slots.length;f>d;d++)if(c<this.slots[d]){this._slotToUse=this.slotsData[this.slots[d]],this._slotId=d;break}}this.detectedPeaks=[],this.lastYPeakPicking=!1},removeLinesGroup:function(){this._afterLinesGroup=this.groupLines.nextSibling,this.groupMain.removeChild(this.groupLines)},insertLinesGroup:function(){if(!this._afterLinesGroup)throw"Could not find group after lines to insertion.";this.groupMain.insertBefore(this.groupLines,this._afterLinesGroup),this._afterLinesGroup=!1},removeExtraLines:function(){for(var a=this.currentLineId,b=this.lines.length;b>a;a++)this.groupLines.removeChild(this.lines[a]);this.lines.splice(this.currentLineId,b-this.currentLineId),this.currentLineId=0},detectPeaks:function(a,b){this.options.autoPeakPicking&&(this.options.lineToZero?this.detectedPeaks.push([b,a]):this.lastYPeakPicking?b>=this.lastYPeakPicking[0]&&this.lookForMaxima||b<=this.lastYPeakPicking[0]&&this.lookForMinima?this.lastYPeakPicking=[b,a]:(b<this.lastYPeakPicking[0]&&this.lookForMaxima||b>this.lastYPeakPicking[0]&&this.lookForMinima)&&(this.lookForMinima?(this.lookForMinima=!1,this.lookForMaxima=!0):(this.lookForMinima=!0,this.lookForMaxima=!1,this.detectedPeaks.push(this.lastYPeakPicking),this.lastYPeakPicking=!1),this.lastYPeakPicking=[b,a]):this.lastYPeakPicking=[b,a])
},draw:function(){this.drawInit();this._dataToUse,this._xDataToUse,this._slotToUse;this.removeLinesGroup(),this.eraseMarkers(),this.lookForMaxima=!0,this.lookForMinima=!1,this._draw_slot()||("x_equally_separated"==this.mode?this._draw_equally_separated():this._draw_standard()),this.makePeakPicking(),this.removeExtraLines(),this.insertMarkers(),this.insertLinesGroup();for(var a in this.domMarkerHover)this.toggleMarker(a.split(","),!0,!0);for(var a in this.domMarkerSelect)this.toggleMarker(a.split(","),!0,!1);this.applyLineStyle(this.getSymbolForLegend())},_draw_standard:function(){var a,b,c,d,e,f,g,h,i,j,k=this._dataToUse,l=0,m=k.length,n=(this.getXAxis(),this.getYAxis(),0),o=1;for(this.isFlipped()&&(n=1,o=0);m>l;l++){for(a=!1,this.counter1=l,this.currentLine="",b=0,c=0,d=k[l].length;d>b;b+=2)if(this.counter2=b/2,this.markersShown()&&this.getMarkerCurrentFamily(this.counter),e=k[l][b+n],f=k[l][b+o],i=this.getX(e),j=this.getY(f),i!=g||j!=h)if(isNaN(i)||isNaN(j))this.counter>0&&this._createLine();else if(this._optimize_before(i,j)){if(this._addPoint(i,j),this.detectPeaks(e,f),!this._optimize_after(i,j)){a=!0;break}g=i,h=j}if(this._createLine(),a)break}},_draw_slot:function(){var a=this;return this._slotToUse?(this._slotToUse.done?this._slotToUse.done(function(b){a.drawSlot(b,a._slotId)}):this.drawSlot(this._slotToUse,a._slotId),!0):!1},_draw_equally_separated:function(){for(var a,b,c,d,e,f,g,h=0,i=this._dataToUse,j=this._xDataToUse,k=i.length;k>h;h++){for(g="M ",a=0,b=0,c=i[h].length,this.counter1=h;c>a;a+=1)if(this.counter2=a,this.markersShown()&&this.getMarkerCurrentFamily(b),this.isFlipped()?(e=this.getX(j[h].x+a*j[h].dx),d=this.getY(i[h][a])):(d=this.getX(j[h].x+a*j[h].dx),e=this.getY(i[h][a])),this._optimize_before(d,e)&&(this._addPoint(d,e),!this._optimize_after(d,e))){f=!0;break}if(this._createLine(),f)break}},_optimize_before:function(a,b){return this._optimizeMonotoneous?this.optimizeMonotoneousDirection&&a<this.getXAxis().getMathMinPx()||!this.optimizeMonotoneousDirection&&a>this.getXAxis().getMathMaxPx()?(this._optimizeBuffer=[a,b],!1):(this._optimizeBuffer&&(this._addPoint(this._optimizeBuffer[0],this._optimizeBuffer[1]),this._optimizeBuffer=!1),!0):!0},_optimize_after:function(a){return this._optimizeMonotoneous&&(this.optimizeMonotoneousDirection&&a>this.getXAxis().getMathMaxPx()||!this.optimizeMonotoneousDirection&&a<this.getXAxis().getMathMinPx())?!1:!0},hidePeakPicking:function(a){this._hidePeakPickingLocked||(this._hidePeakPickingLocked=a),f(this)},showPeakPicking:function(a){(!this._hidePeakPickingLocked||a)&&g(this)},getMarkerCurrentFamily:function(a){for(var b=0;b<this.markerPoints[this.selectionType].length&&this.markerPoints[this.selectionType][b][0]<=a;b++)this.markerPoints[this.selectionType][b][1]>=a&&(this.markerCurrentFamily=this.markerPoints[this.selectionType][b][2]);return this.markerCurrentFamily},drawSlot:function(a,b){var c,d,e,f=0;if(this.isFlipped())var g=this.slots[b]/(this.maxY-this.minY),h=Math.floor((this.getYAxis().getActualMin()-this.minY)*g),i=Math.ceil((this.getYAxis().getActualMax()-this.minY)*g);else var g=this.slots[b]/(this.maxX-this.minX),h=Math.floor((this.getXAxis().getActualMin()-this.minX)*g),i=Math.ceil((this.getXAxis().getActualMax()-this.minX)*g);for(e=h;i>=e;e++)a[e]&&(this.isFlipped()?(ypx=Math.floor(this.getY(a[e].x)),d=this.getX(a[e].max),this._addPoint(this.getX(a[e].start),ypx),this._addPoint(d,ypx,!0),this._addPoint(this.getX(a[e].min),ypx),this._addPoint(this.getX(a[e].stop),ypx,!0)):(c=Math.floor(this.getX(a[e].x)),d=this.getY(a[e].max),this.options.autoPeakPicking&&allY.push([a[e].max,a[e].x]),this._addPoint(c,this.getY(a[e].start)),this._addPoint(c,d,!0),this._addPoint(c,this.getY(a[e].min)),this._addPoint(c,this.getY(a[e].stop),!0)));this._createLine(),f++},setMarkerStyleTo:function(a,b){if(!a)throw"Cannot set marker style. DOM does not exist.";a.setAttribute("fill",b.fillColor||"transparent"),a.setAttribute("stroke",b.strokeColor||this.getLineColor()),a.setAttribute("stroke-width",b.strokeWidth||1)},hideTrackingMarker:function(){this.marker.setAttribute("display","none"),this.markerLabel.setAttribute("display","none"),this.markerLabelSquare.setAttribute("display","none")},_addPoint:function(a,b,c){var e;return 0==this.counter?this.currentLine="M ":this.currentLine+=this.options.lineToZero||c?"M ":"L ",this.currentLine+=a,this.currentLine+=" ",this.currentLine+=b,this.currentLine+=" ",this.options.lineToZero&&void 0!==(e=this.getYAxis().getPos(0))&&(this.currentLine+="L ",this.currentLine+=a,this.currentLine+=" ",this.currentLine+=e,this.currentLine+=" "),this.markerPoints?(this.markersShown()&&!(a>this.getXAxis().getMaxPx()||a<this.getXAxis().getMinPx())&&d(this,this.markerFamilies[this.selectionType][this.markerCurrentFamily],a,b),void this.counter++):void this.counter++},_createLine:function(){var a,b=this.currentLineId++;return this.lines[b]?a=this.lines[b]:(a=document.createElementNS(this.graph.ns,"path"),this.applyLineStyle(a),this.groupLines.appendChild(a),this.lines[b]=a),0==this.counter?a.setAttribute("d",""):a.setAttribute("d",this.currentLine),this.currentLine="M ",this.counter=0,a},applyLineStyles:function(){for(var a=0;a<this.lines.length;a++)this.applyLineStyle(this.lines[a])},applyLineStyle:function(a){a.setAttribute("stroke",this.getLineColor()),a.setAttribute("stroke-width",this.getLineWidth()),this.getLineDashArray()?a.setAttribute("stroke-dasharray",this.getLineDashArray()):a.removeAttribute("stroke-dasharray"),a.setAttribute("fill","none")},updateStyle:function(){this.applyLineStyles(),this.setLegendSymbolStyle()},getMarkerPath:function(a,b){var c,d=a.zoom||1,b=b||0;switch(a.type){case 1:c=["m",-2,-2,"l",4,0,"l",0,4,"l",-4,0,"z"];break;case 2:c=["m",-2,-2,"l",4,4,"m",-4,0,"l",4,-4];break;case 3:c=["m",-2,0,"l",4,0,"m",-2,-2,"l",0,4];break;case 4:c=["m",-1,-1,"l",2,0,"l",-1,2,"z"]}if(!(1!=d&&d||b))return c.join(" ");var e="number";if(c){for(var f=0,g=c.length;g>f;f++)typeof c[f]==e&&(c[f]*=d+b);return c.join(" ")}},getMarkerDom:function(a){var b=this;if(!a.dom){var c=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(c,a),a.dom=c,a.path="",c.addEventListener("mouseover",function(a){var c=b._getMarkerIndexFromEvent(a);b.onMouseOverMarker(a,c)}),c.addEventListener("mouseout",function(a){var c=b._getMarkerIndexFromEvent(a);b.onMouseOutMarker(a,c)}),c.addEventListener("click",function(a){var c=b._getMarkerIndexFromEvent(a);b.onClickOnMarker(a,c)})}return a.dom},getMarkerDomIndependant:function(a,b,c){var d=this,e=a+","+b;if(!this.independantMarkers[e]){var f=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(f,c),f.addEventListener("mouseover",function(a){d.onMouseOverMarker(a,[e,0])}),f.addEventListener("mouseout",function(a){d.onMouseOutMarker(a,[e,0])}),f.addEventListener("click",function(a){d.onClickOnMarker(a,[e,0])}),this.independantMarkers[e]=f}return this.groupMain.appendChild(this.independantMarkers[e]),this.independantMarkers[e]},searchIndexByPxXY:function(a,b){for(var c,d=!1,e=!1,f=0,g=this.data.length;g>f;f++)for(var h=0,i=this.data[f].length;i>h;h+=2)c=Math.pow(this.getX(this.data[f][h])-a,2)+Math.pow(this.getY(this.data[f][h+1])-b,2),(!d||d>c)&&(d=c,e=[h/2,f]);return e},searchClosestValue:function(a){for(var b,c=0;c<this.data.length;c++){if(a<=this.data[c][this.data[c].length-2]&&a>=this.data[c][0])b=this._searchBinary(a,this.data[c],!1);else{if(!(a>=this.data[c][this.data[c].length-2]&&a<=this.data[c][0]))continue;b=this._searchBinary(a,this.data[c],!0)}return{dataIndex:c,xMin:this.data[c][b],xMax:this.data[c][b+2],yMin:this.data[c][b+1],yMax:this.data[c][b+3],xBeforeIndex:b/2,xAfterIndex:b/2+2,xBeforeIndexArr:b}}},handleMouseMove:function(a,b){var c=a||this.getXAxis().getMouseVal(),d=this.searchClosestValue(c);if(d){var e=(c-d.xMin)/(d.xMax-d.xMin),f=(1-e)*d.yMin+e*d.yMax;if(b&&this.options.trackMouse){if(void 0==d.xMin)return!1;var a=this.getX(this.getFlip()?f:c),g=this.getY(this.getFlip()?c:f);switch(this.marker.setAttribute("display","block"),this.marker.setAttribute("cx",a),this.marker.setAttribute("cy",g),this.markerLabel.setAttribute("display","block"),this.markerLabelSquare.setAttribute("display","block"),this.options.trackMouseLabel){case!1:break;default:this.markerLabel.textContent=this.options.trackMouseLabel.replace("<x>",c.toFixed(this.options.trackMouseLabelRouding)).replace("<y>",f.toFixed(this.options.trackMouseLabelRouding))}this.markerLabel.setAttribute("x",a+5),this.markerLabel.setAttribute("y",g-5),this.markerLabelSquare.setAttribute("x",a+5),this.markerLabelSquare.setAttribute("y",g-5-this.graph.options.fontSize),this.markerLabelSquare.setAttribute("width",this.markerLabel.getComputedTextLength()+2),this.markerLabelSquare.setAttribute("height",this.graph.options.fontSize+2)}return{xBefore:d.xMin,xAfter:d.xMax,yBefore:d.yMin,yAfter:d.yMax,trueX:c,interpolatedY:f,xBeforeIndex:d.xBeforeIndex}}},_searchBinary:function(a,b,c){var d=0,e=b.length,f=e-2;if(b[d]==a)return d;if(b[f]==a)return f;for(var g,h=0;;){if(h++,h>100)throw"Error loop";if(g=(d+f)/2,g-=g%2,g==d||b[g]==a)return g;b[g]<=a?c?f=g:d=g:b[g]>a&&(c?d=g:f=g)}},getMax:function(a,b){var c,d,e,f,g=Math.min(a,b),h=Math.max(a,b),i=this.searchClosestValue(g),j=this.searchClosestValue(h),k=-1/0;if(i||(g=this.minX,i=this.searchClosestValue(g)),j||(h=this.maxX,j=this.searchClosestValue(h)),!i||!j)return-1/0;for(c=i.dataIndex;c<=j.dataIndex;c++)for(e=c==i.dataIndex?i.xBeforeIndexArr:0,f=c==j.dataIndex?j.xBeforeIndexArr:this.data[c].length,d=e;f>=d;d+=2)k=Math.max(k,this.data[c][d+1]);return k},getMin:function(a,b){var c,d,e,f,g=Math.min(a,b),h=Math.max(a,b),i=this.searchClosestValue(g),j=this.searchClosestValue(h),k=1/0;if(i||(g=this.minX,i=this.searchClosestValue(g)),j||(h=this.maxX,j=this.searchClosestValue(h)),!i||!j)return 1/0;for(c=i.dataIndex;c<=j.dataIndex;c++)for(e=c==i.dataIndex?i.xBeforeIndexArr:0,f=c==j.dataIndex?j.xBeforeIndexArr:this.data[c].length,d=e;f>=d;d+=2)k=Math.min(k,this.data[c][d+1]);return k},setStyle:function(a,b){this.styles[b]=a},setLineStyle:function(a,b){return b=b||"unselected",this.styles[b]=this.styles[b]||{},this.styles[b].lineStyle=a,this},getLineStyle:function(a){return this.getStyle(a).lineStyle},getLineDashArray:function(a){switch(this.getStyle(a).lineStyle){case 2:return"1, 1";case 3:return"2, 2";case 3:return"3, 3";case 4:return"4, 4";case 5:return"5, 5";case 6:return"5 2";case 7:return"2 5";case 8:return"4 2 4 4";case 9:return"1,3,1";case 10:return"9 2";case 11:return"2 9";case!1:case 1:return!1;default:return this.styles[a||this.selectionType||"unselected"].lineStyle}},getStyle:function(a){return this.styles[a||this.selectionType||"unselected"]},extendStyles:function(){for(var a in this.styles){var c=this.styles[a];c&&(this.styles[a]=b.extend({},this.styles.unselected,c))}},setLineWidth:function(a,b){return b=b||"unselected",this.styles[b]=this.styles[b]||{},this.styles[b].lineWidth=a,this},getLineWidth:function(a){return this.getStyle(a).lineWidth},setLineColor:function(a,b){return b=b||"unselected",this.styles[b]=this.styles[b]||{},this.styles[b].lineColor=a,this},getLineColor:function(a){return this.getStyle(a).lineColor},showMarkers:function(a,b){return a=a||"unselected",this.styles[a]=this.styles[a]||{},this.styles[a].markers=!0,b&&this._drawn&&this.draw(),this},hideMarkers:function(a,b){return a=a||"unselected",this.styles[a].markers=!1,b&&this._drawn&&this.draw(),this},markersShown:function(a){return this.getStyle(a).markers},areMarkersShown:function(){return this.markersShown.apply(this,arguments)},isMarkersShown:function(){return this.markersShown.apply(this,arguments)},setMarkers:function(a,b){this.showMarkers(b,!0),a||(a=[{type:1,zoom:1,points:"all"}]);var c=[];c.push([0,1/0,null]);for(var d=0,e=a.length;e>d;d++)if(this.getMarkerDom(a[d]),a[d].markerPath=this.getMarkerPath(a[d]),a[d].points){Array.isArray(a[d].points)||(a[d].points=[a[d].points]);for(var f=0,g=a[d].points.length;g>f;f++)c.push("all"==a[d].points[f]?[0,1/0,d]:Array.isArray(a[d].points[f])?[a[d].points[f][0],a[d].points[f][1],d]:[a[d].points[f],a[d].points[f],d])}this.markerFamilies=this.markerFamilies||{},this.markerFamilies[b||"unselected"]=a,c.sort(function(a,b){return a[0]-b[0]||(null==a[2]?-1:1)}),this.markerPoints=this.markerPoints||{},this.markerPoints[b||"unselected"]=c},insertMarkers:function(){if(this.markerFamilies&&this.markerFamilies[this.selectionType]&&!this.options.markersIndependant)for(var a=0,b=this.markerFamilies[this.selectionType].length;b>a;a++)this.markerFamilies[this.selectionType][a].dom.setAttribute("d",this.markerFamilies[this.selectionType][a].path),this.groupMain.appendChild(this.markerFamilies[this.selectionType][a].dom),this.currentMarkersSelectionType=this.selectionType},getMarkerForLegend:function(){if(this.markerPoints&&this.markerPoints[this.selectionType]){if(!this.markerForLegend){var a=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(a,this.markerFamilies[0]),a.setAttribute("d","M 14 0 "+this.getMarkerPath(this.markerFamilies[this.selectionType][0])),this.markerForLegend=a}return this.markerForLegend}},eraseMarkers:function(){var a=this;this.options.markersIndependant?this.independantMarkers.map(function(b){a.groupMain.removeChild(b)}):this.currentMarkersSelectionType&&(this.markerFamilies[this.currentMarkersSelectionType].map(function(b){a.groupMain.removeChild(b.dom),b.path=""}),this.currentMarkersSelectionType=!1)},showImpl:function(){this.showPeakPicking()},hideImpl:function(){this.hidePeakPicking()},XIsMonotoneous:function(){return this.xmonotoneous=!0,this},makePeakPicking:function(){var a=this,c=this.detectedPeaks;b.when.apply(b,a.picksDef).then(function(){var b,d,d,e,f,g,h,i=[],j=0,k=c.length,l=a.graph.selectedShapes.map(function(a){return a.data.mz});for(c.sort(function(a,b){return b[0]-a[0]}),f=0;k>j;j++)if(b=c[j][1],d=a.getX(b),e=0,g=a.getY(c[j][0]),!(d<a.getXAxis().getMinPx()||d>a.getXAxis().getMaxPx()||!a.options.autoPeakPickingAllowAllY&&(g>a.getYAxis().getMinPx()||g<a.getYAxis().getMaxPx()))){for(;e<i.length&&!(Math.abs(i[e]-d)<a.options.autoPeakPickingMinDistance);e++);if(!(e<i.length))if((h=l.indexOf(b))>-1)i.push(d);else{if(!a.picks[f])return;for(a.picks[f].set("labelPosition",{x:b,dy:"-10px"}),a.picks[f].data.mz=b,a.picks[f].data.label[0].text=a.options.autoPeakPickingFormat?a.options.autoPeakPickingFormat.call(a.picks[f],b,f):String(Math.round(1e3*b)/1e3),a.picks[f].redraw(),f++;a.picks[f]&&a.picks[f].isSelected();)f++;if(i.length==a.options.autoPeakPickingNb)break}}})}}),h}(c["./graph._serie"],c["./series/slotoptimizer"]),c["./series/graph.serie.contour"]=function(a){function c(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}function d(a,b,d){var e,f,g;if(0==b)e=f=g=d;else{var h=.5>d?d*(1+b):d+b-d*b,i=2*d-h;e=c(i,h,a+1/3),f=c(i,h,a),g=c(i,h,a-1/3)}return[Math.round(255*e),Math.round(255*f),Math.round(255*g)]}var e=function(){this.negativeDelta=0,this.positiveDelta=0,this.negativeThreshold=0,this.positiveThreshold=0};return b.extend(e.prototype,a.prototype,{setData:function(a,b,c){var d,e,f,g,c=c||"float",h=a.length,i=[];for(a instanceof Array||"object"==typeof a&&(this.minX=a.minX,this.minY=a.minY,this.maxX=a.maxX,this.maxY=a.maxY,a=a.segments,h=a.length),d=0;h>d;d++){for(f=a[d].lines.length,g=this._addData(c,f),e=0;f>e;e+=2)g[e]=a[d].lines[e],this._checkX(g[e]),g[e+1]=a[d].lines[e+1],this._checkY(g[e+1]);i.push({lines:g,zValue:a[d].zValue})}return this.data=i,this.graph._updateAxes(),this},draw:function(){this.currentLine=0;var a,b,c,d,e,f,g,h,i=0,j=this.data.length,k=0;this.minZ=1/0,this.maxZ=-1/0;var l=this.groupLines.nextSibling;this.groupMain.removeChild(this.groupLines),this.zValues={};var m=0,n=1;this.getFlip()&&(m=0,n=1);var o=this.getYAxis().getActualMin(),p=this.getXAxis().getActualMin(),q=this.getXAxis().getActualMax(),r=this.getYAxis().getActualMax();for(this.counter=0,this.currentLineId=0;j>i;i++){for(this.currentLine="",k=0,e=0,h=this.data[i].lines,f=h.length;f>k;k+=4){var s,t;h[k+m]<p&&h[k+2+m]<p||h[k+n]<o&&h[k+2+n]<o||h[k+n]>r&&h[k+2+n]>r||h[k+m]>q&&h[k+2+m]>q||(c=this.getX(h[k+m]),d=this.getY(h[k+n]),a=this.getX(h[k+2+m]),b=this.getY(h[k+2+n]),(a!=c||b!=d)&&(this.currentLine+="M ",this.currentLine+=c,this.currentLine+=" ",this.currentLine+=d,this.currentLine+="L ",this.currentLine+=a,this.currentLine+=" ",this.currentLine+=b,this.counter++,s=a,t=b,e++))}this.currentLine+=" z",g=this._createLine(),g.setAttribute("data-zvalue",this.data[i].zValue),this.zoneColors&&this.zoneColors[i]&&g.setAttribute("fill",this.zoneColors[i]),this.zValues[this.data[i].zValue]={dom:g},this.minZ=Math.min(this.minZ,this.data[i].zValue),this.maxZ=Math.max(this.maxZ,this.data[i].zValue)}for(i++,i=this.currentLine+1;i<this.lines.length;i++)this.groupLines.removeChild(this.lines[i]),this.lines.splice(i,1);for(i=0;j>i;i++)this.setColorTo(this.lines[i],this.data[i].zValue,this.minZ,this.maxZ);this.graph.legend&&this.graph.legend.update(),this.onMouseWheel(0,{shiftKey:!1}),this.groupMain.insertBefore(this.groupLines,l)},initimpl:function(){this.options.hasNegative||(this.negativeThreshold=0)},onMouseWheel:function(a,b,c,d){a/=250,void 0!==c?(d||(this.negativeThreshold=-c*this.minZ,this.negativeDelta=-Math.pow(Math.abs(this.negativeThreshold/-this.minZ),1/3)),d&&(this.positiveThreshold=c*this.maxZ,this.positiveDelta=Math.pow(this.positiveThreshold/this.maxZ,1/3))):b.shiftKey&&this.options.hasNegative?(this.negativeDelta=Math.min(0,Math.max(-1,this.negativeDelta+Math.min(.1,Math.max(-.1,a)))),this.negativeThreshold=-this.minZ*Math.pow(this.negativeDelta,3)):(this.positiveDelta=Math.min(1,Math.max(0,this.positiveDelta+Math.min(.1,Math.max(-.1,a)))),this.positiveThreshold=this.maxZ*Math.pow(this.positiveDelta,3)),isNaN(this.positiveDelta)&&(this.positiveDelta=0),isNaN(this.negativeDelta)&&(this.negativeDelta=0);for(var e in this.zValues)this.zValues[e].dom.setAttribute("display",e>=0&&e>=this.positiveThreshold||0>=e&&e<=this.negativeThreshold?"block":"none");this._shapeZoom&&(this.options.hasNegative?(this._shapeZoom.setHandleNeg(-Math.pow(this.negativeDelta,3),this.minZ),this._shapeZoom.showHandleNeg()):this._shapeZoom.hideHandleNeg(),this._shapeZoom.setHandlePos(Math.pow(this.positiveDelta,3),this.maxZ))},setColors:function(a){this.zoneColors=a},setDynamicColor:function(a){this.lineColors=a},setNegative:function(a){this.options.hasNegative=a,a&&(this.negativeThreshold=0)},setColorTo:function(a,b,c,e){if(this.lineColors){var f={h:0,s:0,l:0};for(var g in f)f[g]=b>0?this.lineColors.fromPositive[g]+(this.lineColors.toPositive[g]-this.lineColors.fromPositive[g])*(b/e):this.lineColors.fromNegative[g]+(this.lineColors.toNegative[g]-this.lineColors.fromNegative[g])*(b/c);f.h/=360;var h=d(f.h,f.s,f.l);a.setAttribute("stroke","rgb("+h.join()+")")}},getSymbolForLegend:function(){if(!this.lineForLegend){var a=document.createElementNS(this.graph.ns,"ellipse");a.setAttribute("cx",7),a.setAttribute("cy",0),a.setAttribute("rx",8),a.setAttribute("ry",3),a.setAttribute("cursor","pointer"),this.lineForLegend=a}return this.applyLineStyle(this.lineForLegend,this.maxZ),this.lineForLegend},applyLineStyle:function(a,b){a.setAttribute("stroke",this.getLineColor()),a.setAttribute("stroke-width",this.getLineWidth()+(this.isSelected()?2:0)),this.getLineDashArray()&&a.setAttribute("stroke-dasharray",this.getLineDashArray()),a.setAttribute("fill","none"),this.setColorTo(a,void 0!==b?b:a.getAttribute("data-zvalue"),this.minZ,this.maxZ)},setShapeZoom:function(a){this._shapeZoom=a}}),e}(c["./series/graph.serie.line"]),c["./series/graph.serie.line.broken"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{draw:function(){this.drawInit();this._dataToUse,this._xDataToUse,this._slotToUse;if(this.removeLinesGroup(),this.eraseMarkers(),this.lookForMaxima=!0,this.lookForMinima=!1,"x_equally_separated"==this.mode)throw"Not supported";this._draw_standard(),a++,this.removeExtraLines(),this.insertLinesGroup();for(var a=0,b=this.labels.length;b>a;a++)this.repositionLabel(this.labels[a])},_draw_standard:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this._dataToUse,n=0,o=m.length,p=0,q=1;for(this.isFlipped()&&(p=1,q=0);o>n;n++){for(a=!1,this.currentLine="",b=0,c=0,d=m[n].length;d>b;b+=2){e=m[n][b+p],f=m[n][b+q];var r=this.getXAxis().getRange?this.getXAxis().getRange(e):[1,this.getX(e)],s=this.getYAxis().getRange?this.getYAxis().getRange(f):[1,this.getY(f)];(r[0]!=g||s[0]!=h)&&void 0!==r[0]&&void 0!==s[0]&&b>0?(void 0!==g&&void 0!==h&&(this.break(i,j,k,l,e,f,c),this._createLine()),this.break(e,f,r[1],s[1],i,j,c),this._addPoint(r[1],s[1])):void 0==r[0]||void 0==s[0]&&g&&h?(this.break(i,j,k,l,e,f,c),this._createLine()):isNaN(r[1])||isNaN(s[1])||this._addPoint(r[1],s[1]),g=r[0],h=s[0],i=e,j=f,k=r[1],l=s[1]}this._createLine()}},"break":function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;this.getXAxis()._broken?(l=this.getXAxis().getBoundary(a,e),g=(l-a)/(e-c)):(g=1,j=e),this.getYAxis()._broken?(m=this.getYAxis().getBoundary(b,f),h=(m-b)/(f-b)):(h=1,k=f);var i=Math.min(h,g),e=i*(e-a)+a,f=i*(f-b)+b;return n=this.getXAxis()._broken?this.getXAxis().getInRange(a,e):this.getX(e),o=this.getYAxis()._broken?this.getYAxis().getInRange(b,f):this.getY(f),this._addPoint(n,o)}}),c}(c["./series/graph.serie.line"]),c["./series/graph.serie.scatter"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{defaults:{label:"",onHover:!1},init:function(a,d,e){var f=this;this.graph=a,this.name=d,this.id=Math.random()+Date.now(),this.shapes=[],this.shown=!0,this.options=b.extend(!0,{},c.prototype.defaults,e),this.data=[],this.graph.mapEventEmission(this.options,this),this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupPoints=document.createElementNS(this.graph.ns,"g"),this.groupMain=document.createElementNS(this.graph.ns,"g"),this.additionalData={},this.selectedStyleGeneral={},this.selectedStyleModifiers={},this.groupPoints.addEventListener("mouseover",function(a){var c=parseInt(b(a.target).parent().attr("data-shapeid"));f.emit("mouseover",c,f.data[2*c],f.data[2*c+1])}),this.groupPoints.addEventListener("mouseout",function(a){var c=parseInt(b(a.target).parent().attr("data-shapeid"));f.emit("mouseout",c,f.data[2*c],f.data[2*c+1])}),this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.maxY=Number.MIN_VALUE,this.groupMain.appendChild(this.groupPoints),this.currentAction=!1,this.initExtended1&&this.initExtended1(),this.styles={},this.styles.unselected={},this.styles.selected={},this.styles.unselected.default={shape:"circle",cx:0,cy:0,r:3,stroke:"transparent",fill:"black"},this.styles.selected.default={shape:"circle",cx:0,cy:0,r:4,stroke:"transparent",fill:"black"}},setData:function(a,b,c){var d,e=0,b=b||"2D",c=c||"float",f=0;if(this.empty(),this.shapesDetails=[],this.shapes=[],!a instanceof Array)return this;a instanceof Array&&!(a[0]instanceof Array)&&(b="1D");var g="2D"==b;d=this._addData(c,g?2*a.length:a.length),e=0;for(var h=0,i=a.length;i>h;h++)g?(d[e]=a[h][0],this._checkX(d[e]),e++,d[e]=a[h][1],this._checkY(d[e]),e++,f++):(d[e]=a[h],this[h%2==0?"_checkX":"_checkY"](d[e]),e++,f+=h%2?1:0);return this.graph._updateAxes(),this.data=d,this},empty:function(){for(;this.groupPoints.firstChild;)this.groupPoints.removeChild(this.groupPoints.firstChild)},select:function(){this.selected=!0},unselect:function(){this.selected=!1},setStyle:function(a,b,c){return"string"==typeof b&&(c=b,b=!1),void 0===c&&(c="unselected"),this.styles[c]=this.styles[c]||{},this.styles[c].all=a,this.styles[c].modifiers=b,this},draw:function(){var a,b,c,d,e=0;this._drawn=!0,this.groupMain.removeChild(this.groupPoints);var f=0,g=1;this.getFlip()&&(f=1,g=0);var h=(this.data.length/2,[]);e=0,c=0,d=this.data.length;var i;if(this.errorstyles)for(var j=0,k=this.errorstyles.length;k>j;j++)this.errorstyles[j].paths={top:"",bottom:"",left:"",right:""};for(;d>e;e+=2){a=this.getX(this.data[e+f]),b=this.getY(this.data[e+g]);{this.data[e+g]}this.error&&(i=this.error[e/2])&&(i[0]&&this.doErrorDraw("y",i[0],this.data[e+g],b,a,b),i[1]&&this.doErrorDraw("x",i[1],this.data[e+f],a,a,b)),this.shapesDetails[e/2]=this.shapesDetails[e/2]||[],this.shapesDetails[e/2][0]=a,this.shapesDetails[e/2][1]=b,h.push(e/2)}if(this.errorstyles)for(var j=0,k=this.errorstyles.length;k>j;j++)for(var e in this.errorstyles[j].paths)this.errorstyles[j][e]&&this.errorstyles[j][e].dom&&this.errorstyles[j][e].dom.setAttribute("d",this.errorstyles[j].paths[e]);this.applyStyle("unselected",h),this.groupMain.appendChild(this.groupPoints)},doErrorDraw:function(a,b,c,d,e,f){b instanceof Array||(b=[b]);var g,h="y"==a?"getY":"getX",i="y"==a?["top","bottom"]:["left","right"];if(!isNaN(e)&&!isNaN(f))for(var j=0,k=b.length;k>j;j++)b[j]instanceof Array?(g=i[0],this.errorstyles[j].paths[g]+=" M "+e+" "+f,this.errorstyles[j].paths[g]+=this.makeError(a,j,this[h](c+b[j][0]),d),g=i[1],this.errorstyles[j].paths[g]+=" M "+e+" "+f,this.errorstyles[j].paths[g]+=this.makeError(a,j,this[h](c-b[j][1]),d)):(g=i[0],this.errorstyles[j].paths[g]+=" M "+e+" "+f,this.errorstyles[j].paths[g]+=this.makeError(a,j,this[h](c+b[j]),d),g=i[1],this.errorstyles[j].paths[g]+=" M "+e+" "+f,this.errorstyles[j].paths[g]+=this.makeError(a,j,this[h](c-b[j]),d))},makeError:function(a,b,c,d){switch(this.errorstyles[b].type){case"bar":return this["makeBar"+a.toUpperCase()](c,d,this.errorstyles[b]);case"box":return this["makeBox"+a.toUpperCase()](c,d,this.errorstyles[b])}},makeBarY:function(a,b,c){var d=c.width||10;return" V "+a+" m -"+d/2+" 0 h "+d+" m -"+d/2+" 0 V "+b+" "},makeBoxY:function(a,b){return" m 5 0 V "+a+" h -10 V "+b+" m 5 0 "},makeBarX:function(a,b,c){var d=c.height||10;return" H "+a+" m 0 -"+d/2+" v "+d+" m 0 -"+d/2+" H "+b+" "},makeBoxX:function(a,b){return" v 5 H "+a+" v -10 H "+b+" v 5 "},_addPoint:function(a,b,c){var d=document.createElementNS(this.graph.ns,"g");d.setAttribute("transform","translate("+a+", "+b+")"),d.setAttribute("data-shapeid",c),shape=this.extraStyle&&this.extraStyle[c]?this.doShape(d,this.extraStyle[c]):this.stdStylePerso?this.doShape(d,this.stdStylePerso):this.doShape(d,this.stdStyle),this.shapes[c]=shape,this.groupPoints.appendChild(d)},doShape:function(a,b){var c=document.createElementNS(this.graph.ns,b.shape);return a.appendChild(c),c},getStyle:function(a,c){var d,a=a||"unselected",e={};"number"==typeof c?d=[c]:Array.isArray(c)&&(d=c);var f,c,g,h,i;void 0!==this.styles[a].all&&(i=this.styles[a].all,"function"==typeof i?i=i():i===!1&&(i={}));for(var j=0,k=d.length;k>j;j++){if(c=d[j],f=this.shapes[c],(g=this.styles[a].modifiers)&&("function"==typeof g||g[c])){"function"==typeof g?h=g(c,f):g[c]&&(h=g[c]);var l=b.extend({},i,h);h=b.extend(h,l)}else h=void 0!==i?i:this.styles[a].default;if(!f){var m=document.createElementNS(this.graph.ns,"g");m.setAttribute("data-shapeid",c),this.shapes[c]=this.doShape(m,h),this.groupPoints.appendChild(m),f=this.shapes[c]}f.parentNode.setAttribute("transform","translate("+this.shapesDetails[c][0]+", "+this.shapesDetails[c][1]+")"),e[c]=h}return e},applyStyle:function(a,b){var c,d,e=this.getStyle(a,b);for(c in e)for(d in e[c])"shape"!==d&&(e[c][d]?this.shapes[c].setAttribute(d,e[c][d]):this.shapes[c].removeAttribute(d))},setDataError:function(a){return this.error=a,this},setErrorStyle:function(a){function c(a){a.dom=document.createElementNS(d.graph.ns,"path"),a.dom.setAttribute("fill",a.fillColor||"none"),a.dom.setAttribute("stroke",a.strokeColor||"black"),d.groupMain.appendChild(a.dom)}var d=this;a=a||["box","bar"],Array.isArray(a)||(a=[a]);for(var e=[],f=[["y","top","bottom"],["x","left","right"]],g=0;g<a.length;g++){e[g]={},"string"==typeof a[g]&&(a[g]={type:a[g],y:{}}),e[g].type=a[g].type;for(var h=0,i=f.length;i>h;h++){a[g][f[h][0]]&&(a[g][f[h][1]]=b.extend(!0,{},a[g][f[h][0]]),a[g][f[h][2]]=b.extend(!0,{},a[g][f[h][0]]));for(var j=1;2>=j;j++)a[g][f[h][j]]&&(e[g][f[h][j]]=a[g][f[h][j]],c(e[g][f[h][j]]))}}return this.errorstyles=e,this},unselectPoint:function(a){this.selectPoint(a,!1)},selectPoint:function(a,b,c){if(!this.shapesDetails[a][2]||this.shapesDetails[a][2]!=c){if("string"==typeof b&&(c=b,b=void 0),Array.isArray(a))return this.selectPoints(a);if(this.shapes[a]&&this.shapesDetails[a])if(!this.shapesDetails[a][2]&&b!==!1||b===!0)c=c||"selected",this.shapesDetails[a][2]=c,this.applyStyle(c,a);else{var d=this.shapesDetails[a][2];this.shapesDetails[a][2]=!1;var e=this.getStyle(d,a);for(var f in e[a])this.shapes[a].removeAttribute(f);this.applyStyle("unselected",a)}}}}),c}(c["./graph._serie"]),c["./series/graph.serie.zone"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{defaults:{label:"",fillColor:"rgba( 0, 0, 0, 0.1 )",lineColor:"rgba( 0, 0, 0, 1 )",lineWidth:"1px"},init:function(a,d,e){this.graph=a,this.name=d,this.id=Math.random()+Date.now(),this.shown=!0,this.options=b.extend(!0,{},c.prototype.defaults,e),this.data=[],this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupZones=document.createElementNS(this.graph.ns,"g"),this.groupMain=document.createElementNS(this.graph.ns,"g"),this.lineZone=document.createElementNS(this.graph.ns,"path"),this.lineZone.setAttribute("stroke","black"),this.lineZone.setAttribute("stroke-width","1px"),this.additionalData={},this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.maxY=Number.MIN_VALUE,this.groupMain.appendChild(this.groupZones),this.groupZones.appendChild(this.lineZone),this.currentAction=!1,this.initExtended1&&this.initExtended1()},setData:function(a,b,c){var d,e=0,b=b||"2D",c=c||"float",f=0;if(!(!a instanceof Array)){var g;a instanceof Array&&!(a[0]instanceof Array)?(b="1D",g=1.5*a.length,a[1]instanceof Array||(b="1D_flat",g=1*a.length)):a instanceof Array&&!(a[0][1]instanceof Array)?(b="2D_flat",g=3*a.length):(b="2D",g=3*a.length),d=this._addData(c,g),e=0;for(var h=0,i=a.length;i>h;h++)if("2D"==b||"2D_flat"==b)d[e]=a[h][0],this._checkX(d[e]),e++,"2D"==b?(d[e]=a[h][1][0],this._checkY(d[e]),e++,f++,d[e]=a[h][1][1],this._checkY(d[e]),e++,f++):(d[e]=a[h][1],this._checkY(d[e]),e++,f++,d[e]=a[h][2],this._checkY(d[e]),e++,f++);else if("1D_flat"==b){if(h%3==0){d[e]=a[h],this._checkX(d[e]),e++,f++;continue}d[e]=a[h],this._checkY(d[e]),e++,f++}else{if(h%2==0){d[e]=a[h],this._checkX(d[e]),e++,f++;continue}d[e]=a[h][0],this_checkY(d[e]),e++,f++,d[e]=a[h][1],this_checkY(d[e]),e++,f++}return this.graph._updateAxes(),this.data=d,this}},_addData:function(a,b){switch(a){case"int":var c=4*b;break;case"float":var c=8*b}var d=new ArrayBuffer(c);switch(a){case"int":return new Int32Array(d);default:case"float":return new Float64Array(d)}},empty:function(){for(;this.group.firstChild;)this.group.removeChild(this.group.firstChild)},select:function(){this.selected=!0},unselect:function(){this.selected=!1},setDataStyle:function(a,b){return this.stdStylePerso=a,this.extraStyle=b,this},draw:function(){var a,b,c,d,e,f=0;this._drawn=!0,this.groupMain.removeChild(this.groupZones);this.data.length/2;f=0,d=0,e=this.data.length;for(var g,h=[],i=[];e>f;f+=3)if(a=this.getX(this.data[f]),b=this.getY(this.data[f+1]),c=this.getY(this.data[f+2]),0>a)g=[a,b,c];else if(g&&(h.push([a,Math.max(b,c)]),i.push([a,Math.min(b,c)]),g=!1,d++),c>b?(h.push([a,b]),i.push([a,c])):(h.push([a,c]),i.push([a,b])),a>this.getXAxis().getMaxPx())break;i.reverse(),h.length>0&&i.length>0&&this.lineZone.setAttribute("d","M "+h[0]+" L "+h.join(" L ")+" L "+i.join(" L ")+" z"),this.applyLineStyle(this.lineZone),this.groupMain.appendChild(this.groupZones)},applyLineStyle:function(a){a.setAttribute("stroke",this.getLineColor()),a.setAttribute("stroke-width",this.getLineWidth()),a.setAttribute("fill",this.getFillColor())},setLineWidth:function(a){return this.options.lineWidth=a,this},getLineWidth:function(){return this.options.lineWidth},setLineColor:function(a){return this.options.lineColor=a,this},getLineColor:function(){return this.options.lineColor},setFillColor:function(a){return this.options.fillColor=a,this},getFillColor:function(){return this.options.fillColor}}),c
}(c["./graph._serie"]),c["./graph.serieaxis"]=function(a){var c=function(){};return a.prototype,b.extend(!0,c.prototype,a.prototype,{initExtended1:function(){this.initExtended2&&this.initExtended2()},setAxis:function(a){this.axis=a},kill:function(a){this.getAxis().groupSeries.removeChild(this.groupMain),this.getAxis().series.splice(this.getAxis().series.indexOf(this),1),a||this.graph.redraw()},getAxis:function(){return this.axis},getXAxis:function(){return this.axis},getYAxis:function(){return this.axis}}),c}(c["./series/graph.serie.line"]),c["./shapes/graph.shape"]=function(){function a(a){if(Array.isArray(a))switch(a.length){case 3:return"rgb("+a.join(",")+")";case 4:return"rgba("+a.join(",")+")"}else if("object"==typeof a)return"rgb("+Math.round(255*a.r)+", "+Math.round(255*a.g)+", "+Math.round(255*a.b)+")";return a}var c=function(){};return c.prototype={init:function(a,b){var c=this;if(this.graph=a,this.properties={},this.group=document.createElementNS(this.graph.ns,"g"),this.options=this.options||{},b&&this.group.setAttribute("data-groupname",b),this._selected=!1,this.createDom(),this.setEvents(),this.classes=[],this.transforms=[],this._movable=!0,this._selectable=!1,this.options.masker){var d=document.createElementNS(this.graph.ns,"mask");this.maskingId=Math.random(),d.setAttribute("id",this.maskingId),this.maskDomWrapper=document.createElementNS(this.graph.ns,"rect"),this.maskDomWrapper.setAttribute("fill","white"),d.appendChild(this.maskDomWrapper);var e=this._dom.cloneNode();d.appendChild(e),this.maskDom=e,this.graph.defs.appendChild(d)}this.group&&(this._dom&&this.group.appendChild(this._dom),this.group.addEventListener("mouseover",function(a){c.handleMouseOver(a)}),this.group.addEventListener("mouseout",function(a){c.handleMouseOut(a)}),this.group.addEventListener("mousedown",function(a){c.graph.focus(),c.handleSelected=!1,c.moving=!0,c.handleMouseDown(a)}),this.group.addEventListener("click",function(a){c.handleClick(a)}),this.group.addEventListener("dblclick",function(a){c.handleDblClick(a)})),this.initImpl()},hide:function(){this.hidden||(this.hidden=!0,this.group.style.display="none")},show:function(){this.hidden&&(this.hidden=!1,this.group.style.display="block")},addClass:function(a){this.classes=this.classes||[],-1==this.classes.indexOf(a)&&this.classes.push(a),this.makeClasses()},removeClass:function(a){this.classes.splice(this.classes.indexOf(a),1),this.makeClasses()},makeClasses:function(){this._dom&&this._dom.setAttribute("class",this.classes.join(" "))},initImpl:function(){},setOriginalData:function(a,b){this.data=a,this.events=b},triggerChange:function(){this.graph.triggerEvent("onAnnotationChange",this.data,this)},setEvents:function(){},setSelectableOnClick:function(){return},setBBox:function(){this.rectEvent||(this.rectEvent=document.createElementNS(this.graph.ns,"rect"),this.rectEvent.setAttribute("pointer-events","fill"),this.rectEvent.setAttribute("fill","transparent")),this.group.removeChild(this.rectEvent);var a=this.group.getBBox();this.rectEvent.setAttribute("x",a.x),this.rectEvent.setAttribute("y",a.y-10),this.rectEvent.setAttribute("width",a.width),this.rectEvent.setAttribute("height",a.height+20),this.group.appendChild(this.rectEvent)},kill:function(a){this.graph.removeShapeFromDom(this),a||this.graph._removeShape(this),this._inDom=!1,this.callHandler("onRemoved",this)},draw:function(){void 0==this.labelNumber&&this.setLabelNumber(1),this._inDom||(this.graph.appendShapeToDom(this),this._inDom=!0),this.setFillColor(),this.setStrokeColor(),this.setStrokeWidth(),this.setDashArray(),this.setTransform(),this.everyLabel(function(a){this.get("labelPosition",a)&&(this.setLabelText(a),this.setLabelSize(a),this.setLabelColor(a),this.setLabelPosition(a)),this.get("labelAnchor",a)&&this._forceLabelAnchor(a)})},redraw:function(){this.position=this.setPosition(),this.setTransform(),this.redrawImpl(),this.position&&(this.everyLabel(function(a){this.get("labelPosition",a)&&(this.setLabelPosition(a),this.setLabelAngle(a))}),this.afterDone&&this.afterDone())},redrawImpl:function(){},done:function(){},setSerie:function(a){this.serie=a},getSerie:function(){return this.serie},set:function(a,b,c){this.properties[a]=this.properties[a]||[],this.properties[a][c||0]=b,this.configuration=this.configuration||{sections:{shape_cfg:[{groups:{shape_cfg:[{}]}}]}},this.configuration.sections.shape_cfg[0].groups.shape_cfg[0][a]=[b]},get:function(a){return this.configuration=this.configuration||{sections:{shape_cfg:[{groups:{shape_cfg:[{}]}}]}},((this.configuration.sections.shape_cfg[0].groups.shape_cfg[0]||[])[a]||[])[0]},getFromData:function(a){return this.data[a]},setData:function(a,b){return this.data[a]=b},setDom:function(a,b){this._dom&&this._dom.setAttribute(a,b)},setPosition:function(){var a=this._getPosition(this.getFromData("pos"));return this.setDom("x",a.x),this.setDom("y",a.y),!0},setFillColor:function(){this.setDom("fill",a(this.get("fillColor")))},setStrokeColor:function(){this.setDom("stroke",a(this.get("strokeColor")))},setStrokeWidth:function(){this.setDom("stroke-width",this.get("strokeWidth"))},setDashArray:function(){this.get("strokeDashArray")&&this.setDom("stroke-dasharray",this.get("strokeDashArray"))},setTransform:function(){for(var a="",b=(this.get("transform"),0);b<this.transforms.length;b++){switch(a+=this.transforms[b].type+"(",this.transforms[b].type){case"translate":a+=this.graph.getDeltaPx(this.transforms[b].arguments[0],this.getXAxis()).replace("px",""),a+=", ",a+=this.graph.getDeltaPx(this.transforms[b].arguments[1],this.getYAxis()).replace("px","");break;case"rotate":if(a+=this.transforms[b].arguments[0],a+=", ",1==this.transforms[b].arguments.length){var c=this._getPosition(this.getFromData("pos"));a+=c.x+", "+c.y}else a+=this.graph.getDeltaPx(this.transforms[b].arguments[1],this.getXAxis()).replace("px",""),a+=", ",a+=this.graph.getDeltaPx(this.transforms[b].arguments[2],this.getYAxis()).replace("px","")}a+=") "}this.group.setAttribute("transform",a)},setLabelText:function(a){this.label&&(this.label[a].textContent=this.data.label[a].text)},setLabelColor:function(a){this.label&&this.label[a].setAttribute("fill",this.get("labelColor"))},setLabelSize:function(a){this.label&&this.label[a].setAttribute("font-size",this.get("labelSize"))},setLabelPosition:function(a){this.label&&this._setLabelPosition(a)},setLabelAngle:function(a){this.label&&this._setLabelAngle(a)},setLabelBaseline:function(a){this.label&&this._setLabelBaseline(a)},_getPosition:function(a,b){var c=this.getXAxis(),d=this.getYAxis();return this.graph.getPosition(a,b,c,d,this.serie)},setLabelNumber:function(a){this.labelNumber=a,this._makeLabel()},everyLabel:function(a){for(var b=0;b<this.labelNumber;b++)a.call(this,b)},toggleLabel:function(a,b){this.labelNumber&&this.label[a]&&this.label[a].setAttribute("display",b?"block":"none")},checkMinMax:function(){this.get},_makeLabel:function(){var a=this;this.label=this.label||[],this.everyLabel(function(c){this.label[c]=document.createElementNS(this.graph.ns,"text"),this.label[c].addEventListener("dblclick",function(d){d.preventDefault(),d.stopPropagation(),b('<input type="text" />').attr("value",d.target.textContent).prependTo(a.graph._dom).css({position:"absolute","margin-top":parseInt(d.target.getAttribute("y").replace("px",""))-10+"px","margin-left":parseInt(d.target.getAttribute("x").replace("px",""))-50+"px",textAlign:"center",width:"100px"}).bind("blur",function(){b(this).remove(),a.data.label[c].text=b(this).prop("value"),a.label[c].textContent=b(this).prop("value"),a.triggerChange()}).bind("keyup",function(a){a.stopPropagation(),a.preventDefault(),13==a.keyCode&&b(this).trigger("blur")}).bind("keypress",function(a){a.stopPropagation()}).bind("keydown",function(a){a.stopPropagation()}).focus().get(0).select()}),a.group.appendChild(this.label[c])})},_setLabelPosition:function(a,b){var c=this.getFromData("pos");if(c){{this._getPosition(c)}if(b)b=this._getPosition(b);else var b=this._getPosition(this.get("labelPosition",a)||{dx:0,dy:0},c)}else b={x:-1e3,y:-1e3};"NaNpx"==b.x||isNaN(b.x)||"NaN"===b.x||(this.label[a].setAttribute("x",b.x),this.label[a].setAttribute("y",b.y)),this.label[a].setAttribute("dominant-baseline",this.get("labelBaseline",a))},_setLabelAngle:function(a){var b=this.get("labelAngle",a)||0;if(0!=b){var c=this.label[a].getAttribute("x"),d=this.label[a].getAttribute("y");this.label[a].setAttribute("transform","rotate("+b+" "+c+" "+d+")")}},_setLabelBaseline:function(a){this.label[a].setAttribute("dominant-baseline",this.label[a].baseline)},_forceLabelAnchor:function(a){this.label[a].setAttribute("text-anchor",this._getLabelAnchor())},_getLabelAnchor:function(){var a=this.get("labelAnchor");switch(a){case"middle":case"start":case"end":return a;case"right":return"end";case"left":return"start";default:return"start"}},setSelectable:function(a){this._selectable=a},setMovable:function(a){this._movable=a},unselectable:function(){this.setSelectable(!1)},selectable:function(){this.setSelectable(!0)},isSelectable:function(){return this._selectable},isSelected:function(){return this._selected},hasHandles:function(){return!!this.handles},_select:function(){this._selectable&&(this.graph.appendShapeToDom(this),this._selected=!0,this.selectStyle(),this.hasHandles()&&!this._staticHandles&&(this.addHandles(),this.setHandles()),this.callHandler("onSelected",this),this.graph.triggerEvent("onAnnotationSelect",this.data,this))},_unselect:function(){this._selectable&&(this._selected=!1,this.unselectStyle(),this.setStrokeWidth(),this.setStrokeColor(),this.setDashArray(),this.setFillColor(),this.setTransform(),this.handlesInDom&&!this._staticHandles&&(this.handlesInDom=!1,this.removeHandles()),this.callHandler("onUnselected",this))},staticHandles:function(a){this._staticHandles=a,a?(this.addHandles(),this.setHandles()):this.removeHandles()},createHandles:function(a,b,c,d){if(!this.isLocked()){for(var e=this,f=[],g=1;a>=g;g++)!function(a){if(e["handle"+a]=document.createElementNS(e.graph.ns,b),c)for(var g in c)e["handle"+a].setAttribute(g,c[g]);e["handle"+a].addEventListener("mousedown",function(b){b.preventDefault(),b.stopPropagation(),e.handleSelected=a,e.handleMouseDown(b)}),f.push(e["handle"+a]),d&&d(e["handle"+a])}(g);return this.handles=f}},created:function(){this.callHandler("onCreated",this),this.handleCreateImpl()},handleMouseDownImpl:function(){},handleMouseMoveImpl:function(){},handleMouseUpImpl:function(){},handleCreateImpl:function(){},handlers:{mouseUp:[function(a){return this.moving&&this.callHandler("onAfterMoved",this),(this.handleSelected||this.resize)&&this.callHandler("onAfterResized",this),this.moving=!1,this.resize=!1,this.handleSelected=!1,this.graph.elementMoving(!1),this.handleMouseUpImpl(a)}],mouseMove:[function(a){var b=this.graph._getXY(a),c=this.getXAxis().getRelVal(b.x-this.mouseCoords.x),d=this.getYAxis().getRelVal(b.y-this.mouseCoords.y);(0!=c||0!==d)&&(this.preventUnselect=!0),this.mouseCoords=b;var e=this.handleMouseMoveImpl(a,c,d,b.x-this.mouseCoords.x,b.y-this.mouseCoords.y);return this.options&&(this.moving?this.options.onMove&&this.options.onMove.call(this):this.options.onResize&&this.options.onResize.call(this),this.callHandler("onChange",this)),e}],mouseDown:[function(a){return this.isLocked()||(this.graph.elementMoving(this),this._selectOnMouseDown&&this.graph.selectShape(this)),this.mouseCoords=this.graph._getXY(a),this.handleMouseDownImpl(a,this.mouseCoords)}],click:[function(a){a.shiftKey||this.graph.unselectShapes(),this.graph.selectShape(this)}],mouseOver:[function(){var a;this.addClass("hover"),(a=this._mouseOverCallbacks)&&a.fireWith(this,[this.data,this.parameters])}],mouseOut:[function(){var a;this.removeClass("hover"),(a=this._mouseOutCallbacks)&&a.fireWith(this,[this.data,this.parameters])}]},handleMouseDown:function(a){return this.callHandler("mouseDown",a)},handleClick:function(a){return this.callHandler("click",a)},handleMouseMove:function(a){this.isLocked()&&this._movable!==!1&&(this.graph.elementMoving(!1),this.isLocked()&&(this.handleSelected=!1),this.moving=!0),this._movable||(this.moving=!1),this.moving&&!this.isSelected()&&this.graph.selectShape(this),this.callHandler("beforeMouseMove",a)!==!1&&this.callHandler("mouseMove",a)},handleMouseUp:function(a){this.callHandler("mouseUp",a),this.handleSelected=!1},handleMouseOver:function(){this.callHandler("mouseOver",this),this.graph.emit("shapeMouseOver",this)},handleMouseOut:function(){this.callHandler("mouseOut",this),this.graph.emit("shapeMouseOut",this)},removeHandles:function(){for(var a=1;a<=this.nbHandles;a++)this.group.removeChild(this["handle"+a])},callHandler:function(a){{var b,d,e=a;Array.prototype.shift.call(arguments)}if(d=this.graph.shapeHandlers[e])for(var f=0,g=d.length;g>f;f++)if(void 0!==(b=d[f].apply(this,arguments)))return b;if(d=c.prototype.handlers[e])for(var f=0,g=d.length;g>f;f++)d[f].apply(this,arguments)},addHandles:function(){if(!this.isLocked()&&!this.handlesInDom){this.handlesInDom=!0;for(var a=1;a<=this.nbHandles;a++)this["handle"+a]&&this.group.appendChild(this["handle"+a])}},handleDblClick:function(a){this.options.configurable&&(a.preventDefault(),a.stopPropagation(),this.configure())},configure:function(){var a=this,c=b("<div></div>").dialog({modal:!0,position:["center",50],width:"80%"});c.prev().remove(),c.parent().css("z-index",1e3),require(["require","lib/lib/forms/form"],function(b,d){var e=new d({});e.init();var f={sections:{shape_cfg:{options:{title:"Shape",icon:"info_rhombus"},groups:{shape_cfg:{options:{type:"list"},fields:a.getFieldsConfig()}}}}};e.setStructure(f),e.onStructureLoaded().done(function(){e.fill(a.getConfiguration())}),e.addButton("Cancel",{color:"blue"},function(){c.dialog("close")}),e.addButton("Save",{color:"green"},function(){a.setConfiguration(e.getValue()),c.dialog("close")}),e.onLoaded().done(function(){c.html(e.makeDom()),e.inDom()})})},getConfiguration:function(){return this.configuration=this.configuration||{}},setConfiguration:function(a){this.configuration=b.extend(!0,this.configuration,a)},isLocked:function(){return this.locked||this.graph.shapesLocked},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},isBindable:function(){return this.options.bindable},setBindableToDom:function(){this.isBindable()&&this.addClass("bindable")},highlight:function(a){this.savedHighlight={};for(var b in a)this.savedHighlight[b]=this._dom.getAttribute(b),this._dom.setAttribute(b,a[b]);this.highlightImpl()},unHighlight:function(){for(var a in this.savedHighlight)this._dom.setAttribute(a,this.savedHighlight[a])},highlightImpl:function(){},unHighlightImpl:function(){},getMaskingID:function(){return this.maskingId},maskWith:function(a){var b;(b=a.getMaskingID())?this._dom.setAttribute("mask","url(#"+b+")"):this._dom.removeAttribute("mask")},updateMask:function(){if(this.maskDom){var a={x:"min",y:"min"},b={x:"max",y:"max"};a=this._getPosition(a),b=this._getPosition(b),this.maskDomWrapper.setAttribute("x",Math.min(a.x,b.x)),this.maskDomWrapper.setAttribute("y",Math.min(a.y,b.y)),this.maskDomWrapper.setAttribute("width",Math.abs(b.x-a.x)),this.maskDomWrapper.setAttribute("height",Math.abs(b.y-a.y));for(var c=0;c<this._dom.attributes.length;c++)this.maskDom.setAttribute(this._dom.attributes[c].name,this._dom.attributes[c].value);this.maskDom.setAttribute("fill","black")}},setXAxis:function(a){this.xAxis=a},setYAxis:function(a){this.yAxis=a},autoAxes:function(){this.xAxis=this.graph.getXAxis(),this.yAxis=this.graph.getYAxis()},getXAxis:function(){return this.xAxis||this.autoAxes(),this.xAxis},getYAxis:function(){return this.yAxis||this.autoAxes(),this.yAxis},getMinX:function(){return this.minX},getMaxX:function(){return this.maxX},getMinY:function(){return this.minY},getMaxY:function(){return this.maxY},getLayer:function(){return this._layer||1},setLayer:function(a){this._layer=a},selectStyle:function(){},unselectStyle:function(){},resetTransforms:function(){this.transforms=[]},addTransform:function(a,b){this.transforms.push({type:a,arguments:Array.isArray(b)?b:[b]})}},c}(),c["./shapes/graph.shape.areaundercurve"]=function(a){var c=function(a){this.init(a)};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"path"),this.nbHandles=2,this.createHandles(this.nbHandles,"line",{"stroke-width":"3",stroke:"transparent","pointer-events":"stroke",cursor:"ew-resize"})},handleCreateImpl:function(){this.resize=!0,this.resizingElement=2},handleMouseDownImpl:function(){},handleMouseUpImpl:function(){},handleMouseMoveImpl:function(a,b,c){if(!this.isLocked()){var d=this.getFromData("pos"),e=this.getFromData("pos2");if(this.moving)d.x=this.graph.deltaPosition(d.x,b,this.getXAxis()),d.y=this.graph.deltaPosition(d.y,c,this.getYAxis()),e.x=this.graph.deltaPosition(e.x,b,this.getXAxis()),e.y=this.graph.deltaPosition(e.y,c,this.getYAxis());else if(this.serie){this.resizingPosition=this.getFromData(this.reversed&&2==this.handleSelected||!this.reversed&&1==this.handleSelected?"pos":"pos2");var f=this.serie.searchClosestValue(this.getXAxis().getVal(this.graph._getXY(a).x-this.graph.getPaddingLeft()));if(!f)return;this.resizingPosition.x!=f.xMin&&(this.preventUnselect=!0),this.resizingPosition.x=f.xMin}else this.resizingPosition=this.getFromData(this.reversed&&2==this.handleSelected||!this.reversed&&1==this.handleSelected?"pos":"pos2"),this.resizingPosition.x=this.graph.deltaPosition(this.resizingPosition.x,b,this.getXAxis());this.position=this.setPosition(),this.setHandles()}},redrawImpl:function(){this.position!=this.doDraw&&(this.group.setAttribute("visibility",this.position?"visible":"hidden"),this.doDraw=this.position)},setPosition:function(){if(this.serie){var a=this._getPosition(this.getFromData("pos")),b=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),c=Math.abs(a.x-b.x),d=Math.min(a.x,b.x);if(this.reversed=d==b.x,2>c||0>d+c||d>this.graph.getDrawingWidth())return!1;var e,f,g,h,i,j,d,k,l=this.serie.searchClosestValue(this.getFromData("pos").x),m=this.serie.searchClosestValue(this.getFromData("pos2").x),n=0,o=Number.MAX_VALUE;if(!l||!m)return!1;for(l.xBeforeIndex>m.xBeforeIndex&&(e=l,l=m,m=e),this.counter=0,f=l.dataIndex;f<=m.dataIndex;f++){for(this.currentLine="",h=f==l.dataIndex?l.xBeforeIndexArr:0,i=f==m.dataIndex?m.xBeforeIndexArr:this.serie.data[f].length,j=0,g=h;i>=g;g+=2)d=this.serie.getX(this.serie.data[f][g+0]),k=this.serie.getY(this.serie.data[f][g+1]),n=Math.max(this.serie.data[f][g+1],n),o=Math.min(this.serie.data[f][g+1],o),g==h&&(this.firstX=d,this.firstY=k),this.currentLine+=j>0?" L "+d+" "+k+" ":" M "+d+" "+k+" ",j++;if(this.lastX=d,this.lastY=k,!(this.firstX&&this.firstY&&this.lastX&&this.lastY))return;this.currentLine+=" V "+this.getYAxis().getPx(0)+" H "+this.firstX+" z",this.setDom("d",this.currentLine)}return this.maxY=this.serie.getY(n),!0}},setHandles:function(){this.firstX&&(this.handle1.setAttribute("x1",this.firstX),this.handle1.setAttribute("x2",this.firstX),this.handle2.setAttribute("x1",this.lastX),this.handle2.setAttribute("x2",this.lastX),this.handle1.setAttribute("y1",this.getYAxis().getMaxPx()),this.handle1.setAttribute("y2",this.serie.getY(0)),this.handle2.setAttribute("y1",this.getYAxis().getMaxPx()),this.handle2.setAttribute("y2",this.serie.getY(0)))},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2"),this.setDom("fill","rgba(255, 0, 0, 0.1)")},setLabelPosition:function(a){var b=(this.firstX+this.lastX)/2+"px",c=(this.lastPointY+this.firstPointY)/2+"px",d=this.serie?this.serie.isFlipped():!1;this._setLabelPosition(a,{x:d?c:b,y:d?b:c})},getFieldsConfig:function(){return{strokeWidth:{type:"float","default":1,title:"Stroke width"},strokeColor:{type:"color",title:"Stroke color"},fillColor:{type:"color",title:"Fill color"}}}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.line"]=function(a){var c=function(a,b){this.init(a),this.options=b||{},this.nbHandles=2,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line")},setPosition:function(){var a=this._getPosition(this.getFromData("pos"));if(a&&a.x&&a.y)return this.setDom("x2",a.x),this.setDom("y2",a.y),this.currentPos1x=a.x,this.currentPos1y=a.y,!0},setPosition2:function(){var a=this._getPosition(this.getFromData("pos2"),this.getFromData("pos"));a.x&&a.y&&(this.setDom("y1",a.y),this.setDom("x1",a.x),this.currentPos2x=a.x,this.currentPos2y=a.y)},redrawImpl:function(){this.setPosition(),this.setPosition2(),this.setHandles()},getLinkingCoords:function(){return{x:(this.currentPos2x+this.currentPos1x)/2,y:(this.currentPos2y+this.currentPos1y)/2}},handleCreateImpl:function(){this.resize=!0,this.handleSelected=2},handleMouseDownImpl:function(){return!0},handleMouseUpImpl:function(){return this.triggerChange(),!0},handleMouseMoveImpl:function(a,b,c){if(!this.isLocked()){var d=this.getFromData("pos"),e=this.getFromData("pos2");if(e.dx&&(e.x=this.graph.deltaPosition(e.x||d.x,e.dx,this.getXAxis()),e.dx=!1),e.dy&&(e.y=this.graph.deltaPosition(e.x||d.x,e.dx,this.getXAxis()),e.dy=!1),1==this.handleSelected&&(this.options.vertical||(d.x=this.graph.deltaPosition(d.x,b,this.getXAxis())),this.options.horizontal||(d.y=this.graph.deltaPosition(d.y,c,this.getYAxis()))),2==this.handleSelected&&(this.options.vertical||(e.x=this.graph.deltaPosition(e.x,b,this.getXAxis())),this.options.horizontal||(e.y=this.graph.deltaPosition(e.y,c,this.getYAxis()))),this.options.forcedCoords){var f=this.options.forcedCoords;void 0!==f.y&&("function"==typeof f.y?e.y=d.y=f.y(this):(e.y=f.y,d.y=f.y)),void 0!==f.x&&("function"==typeof f.x?e.x=d.x=f.x(this):(e.x=f.x,d.x=f.x))}return this.moving&&(d.x=this.graph.deltaPosition(d.x,b,this.getXAxis()),d.y=this.graph.deltaPosition(d.y,c,this.getYAxis()),e.x=this.graph.deltaPosition(e.x,b,this.getXAxis()),e.y=this.graph.deltaPosition(e.y,c,this.getYAxis())),this.redrawImpl(),!0}},setHandles:function(){this.isLocked()||this._selected&&void 0!=this.currentPos1x&&(this.addHandles(),this.handle1.setAttribute("x",this.currentPos1x),this.handle1.setAttribute("y",this.currentPos1y),this.handle2.setAttribute("x",this.currentPos2x),this.handle2.setAttribute("y",this.currentPos2y))},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2")}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.arrow"]=function(a){var c=function(a){this.init(a),this.nbHandles=2,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line"),this._dom.setAttribute("marker-end","url(#arrow"+this.graph._creation+")")}}),c}(c["./shapes/graph.shape.line"]),c["./shapes/graph.shape.ellipse"]=function(a){var c=function(a,b){this.options=b,this.init(a),this.graph=a};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"ellipse")},setPosition:function(){var a=this._getPosition(this.getFromData("pos")),b=a.x,c=a.y;return isNaN(b)||isNaN(c)||b===!1||c===!1?!1:(this.setDom("cx",b),this.setDom("cy",c),this.setDom("rx",this.rx||0),this.setDom("ry",this.ry||0),!0)},setRX:function(a){this.rx=a},setRY:function(a){this.ry=a},setR:function(a,b){this.rx=a,this.ry=b},getLinkingCoords:function(){return{x:this.currentX+this.currentW/2,y:this.currentY+this.currentH/2}},redrawImpl:function(){},handleCreateImpl:function(){this.resize=!0},handleMouseDownImpl:function(){},handleMouseUpImpl:function(){this.triggerChange()},handleMouseMoveImpl:function(){},setHandles:function(){},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2"),this.setDom("fill","rgba(255, 0, 0, 0.1)")}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.label"]=function(a){var c=function(a,b){this.init(a),this.options=b||{}};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=!1},setPosition:function(){var a=this._getPosition(this.get("labelPosition"));if(a)return void 0!==this.options.minPosY&&a.y<this.options.minPosY&&(a.y=this.options.minPosY),this.everyLabel(function(b){this.label[b].setAttribute("x",a.x),this.label[b].setAttribute("y",a.y)}),!0},_setLabelPosition:function(){},redrawImpl:function(){this.draw()},selectStyle:function(){this.everyLabel(function(a){this.label[a].setAttribute("font-weight","bold")})},unselectStyle:function(){this.everyLabel(function(a){this.label[a].setAttribute("font-weight","normal")})}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.nmrintegral"]=function(a){var c=function(a,b){this.init(a,"nmrintegral"),this.options=b||{},this.options.axis=this.options.axis||"x",this.nbHandles=2,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(c.prototype,a.prototype,{setPosition:function(){var a,b,c=this.yBaseline||30,d=this._getPosition(this.getFromData("pos")),e=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),f=this.options.axis;if(d&&e){if(this.serie.isFlipped()?(c=this.getXAxis().getPx(0)-c,a=Math.abs(d.y-e.y),b=Math.min(d.y,e.y)):(c=this.getYAxis().getPx(0)-c,a=Math.abs(d.x-e.x),b=Math.min(d.x,e.x)),this.computedBaseline=c,this.reversed=b==e.x,"x"==f){if(2>a||0>b+a||b>this.graph.getDrawingWidth())return!1}else if(2>a||0>b+a||b>this.graph.getDrawingHeight())return!1;{var g,h,i,j,k,l,b,m,n,o,p=this.serie.searchClosestValue(this.getFromData("pos")[f]),q=this.serie.searchClosestValue(this.getFromData("pos2")[f]),r="",s=0,t=1,u=0;Number.MAX_VALUE}if(!p||!q)return!1;p.xBeforeIndex>q.xBeforeIndex&&(g=p,p=q,q=g);var n,o,v,w,x,y,z,A,B,C=0,D=(this.scaling,[]);for(this.serie.isFlipped()&&(t=0,u=1),h=p.dataIndex;h<=q.dataIndex;h++){for(j=h==p.dataIndex?p.xBeforeIndexArr:0,k=h==q.dataIndex?q.xBeforeIndexArr:this.serie.data[h].length,l=0,i=j;k>=i;i+=2){if(b=this.serie.getX(this.serie.data[h][i+u]),m=this.serie.getY(this.serie.data[h][i+t]),this.serie.isFlipped()){var E=b;b=m,m=E}n||(n=b,o=m,x=this.serie.data[h][i+u],y=this.serie.data[h][i+t]),void 0!=v?(C+=(this.serie.data[h][i+u]-z)*this.serie.data[h][i+t]*.5,(b!=v||m!=w)&&(z=this.serie.data[h][i+u],v=b,w=m,D.push([b,C]),l++)):(v=b,w=m,z=this.serie.data[h][i+u],A=this.serie.data[h][i+t])}if(this.lastX=b,this.lastY=m,!(n&&o&&this.lastX&&this.lastY))return}0==C&&(C=1),this.maxPx=this.options.maxPx||50,this.ratio||(this.ratio=1);for(var F=this.maxIntegration||C,h=0,G=D.length;G>h;h++)D[h][1]=c-D[h][1]/C*this.maxPx*(C/F)*this.ratio,0==h&&(this.firstPointY=D[h][1]),r+=" L "+D[h][u]+", "+D[h][t]+" ",this.lastPointY=D[h][1];this.points=D,this.lastSum=Math.abs(C);var w=o,v=this.lastX;return B=Math.min(20,v-n),r=this.serie.isFlipped()?" M "+c+", "+n+" "+r:" M "+n+", "+c+" "+r,this.setDom("d",r),this.firstX=n,this.firstY=o,this.maxY=this.serie.getY(s),this._selected&&this.select(),this.setHandles(),!0}},setScale:function(a,b){this.maxPx=a,this.maxIntegration=b},setYBaseline:function(a){this.yBasline=a},selectStyle:function(){this.setDom("stroke-width","2px")},selectHandles:function(){},setHandles:function(){this._selected&&void 0!=this.points&&(this.addHandles(),this.handle1.setAttribute("x",this.points[0][0]),this.handle1.setAttribute("y",this.points[0][1]),this.handle2.setAttribute("x",this.points[this.points.length-1][0]-1),this.handle2.setAttribute("y",this.points[this.points.length-1][1]))}}),c}(c["./shapes/graph.shape.areaundercurve"]),c["./shapes/graph.shape.rect"]=function(a){var c=function(a,b){if(this.options=b,this.init(a),this.graph=a,this.nbHandles=4,this.options.handles=this.options.handles||{type:"corners"},!this.isLocked())switch(this.options.handles.type){case"sides":this.options.handles.sides=this.options.handles.sides||{top:!0,bottom:!0,left:!0,right:!0};var c=0;for(var d in this.options.handles.sides)this.options.handles.sides[d]&&c++;this.createHandles(c,"g").map(function(b){var c=document.createElementNS(a.ns,"rect");c.setAttribute("x","-3"),c.setAttribute("width","6"),c.setAttribute("y","-6"),c.setAttribute("height","12"),c.setAttribute("stroke","black"),c.setAttribute("fill","white"),c.setAttribute("cursor","pointer"),b.appendChild(c)});var c=1;this.handles={},this.sides=[];for(var d in this.options.handles.sides)this.options.handles.sides[d]&&(this.handles[d]=this["handle"+c],this.sides[c]=d,c++);break;default:case"corners":this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white"}),this.handle2.setAttribute("cursor","nesw-resize"),this.handle4.setAttribute("cursor","nesw-resize"),this.handle1.setAttribute("cursor","nwse-resize"),this.handle3.setAttribute("cursor","nwse-resize")}};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"rect")},setWidthPx:function(a){this.set("width",a)},setHeightPx:function(a){this.set("height",a)},setFullWidth:function(){this.set("x",Math.min(this.getXAxis().getMinPx(),this.getXAxis().getMaxPx())),this.set("width",Math.abs(this.getXAxis().getMaxPx()-this.getXAxis().getMinPx()))},setFullHeight:function(){this.set("y",Math.min(this.getYAxis().getMinPx(),this.getYAxis().getMaxPx())),this.set("height",Math.abs(this.getYAxis().getMaxPx()-this.getYAxis().getMinPx()))},setPosition:function(){var a=this.getFromData("width"),b=this.getFromData("height"),c=this._getPosition(this.getFromData("pos")),d=c.x,e=c.y;if(void 0==a||void 0==b){var f=this._getPosition(this.getFromData("pos2"));if(!f)throw"Position 2 was undefined";a=f.x-c.x,b=f.y-c.y}else a=this.graph.getPxRel(a,this.getXAxis()),b=this.graph.getPxRel(b,this.getYAxis());return d=c.x,e=c.y,this.currentX=d,this.currentY=e,this.currentW=a,this.currentH=b,this.valX=this.getXAxis().getVal(d),this.valY=this.getYAxis().getVal(d),this.valWidth=this.getXAxis().getRelVal(a),this.valHeight=this.getYAxis().getRelVal(b),this.minX=this.valX,this.minY=this.valY,this.maxX=this.valX+this.valWidth,this.maxY=this.valY+this.valHeight,0>a&&(d+=a,a*=-1),0>b&&(e+=b,b*=-1),isNaN(d)||isNaN(e)||d===!1||e===!1?!1:(this.setDom("width",a),this.setDom("height",b),this.setDom("x",d),this.setDom("y",e),this.setHandles(),this.updateMask(),!0)},getLinkingCoords:function(){return{x:this.currentX+this.currentW/2,y:this.currentY+this.currentH/2}},redrawImpl:function(){},handleCreateImpl:function(){this.resize=!0,this.handleSelected=3},handleMouseDownImpl:function(){},handleMouseUpImpl:function(){this.getFromData("pos"),this.getFromData("pos2");this.triggerChange()},handleMouseMoveImpl:function(a,b,c){if(this.moving||this.handleSelected){var d=this.getFromData("width"),e=this.getFromData("height"),f=this.getFromData("pos"),g=this.getFromData("pos2");if(g.dx&&(g.x=this.graph.deltaPosition(g.x||f.x,g.dx,this.getXAxis()),g.dx=!1),g.dy&&(g.y=this.graph.deltaPosition(g.x||f.x,g.dx,this.getXAxis()),g.dy=!1),void 0!==d&&void 0!==e){if(this.moving)return f.x=this.graph.deltaPosition(f.x,b,this.getXAxis()),f.y=this.graph.deltaPosition(f.y,c,this.getYAxis()),this.setData("pos",f),void this.setPosition();switch(this.options.handles.type){case"sides":switch(this.sides[this.handleSelected]){case"left":f.x=this.graph.deltaPosition(f.x,b,this.getXAxis()),d=this.graph.deltaPosition(d,-b,this.getXAxis());break;case"right":d=this.graph.deltaPosition(d,b,this.getXAxis());break;case"top":f.y=this.graph.deltaPosition(f.y,c,this.getYAxis()),e=this.graph.deltaPosition(e,-b,this.getYAxis());break;case"bottom":e=this.graph.deltaPosition(e,c,this.getYAxis())}break;case"corners":default:1==this.handleSelected&&(f.x=this.graph.deltaPosition(f.x,b,this.getXAxis()),f.y=this.graph.deltaPosition(f.y,c,this.getYAxis()),d=this.graph.deltaPosition(d,-b,this.getXAxis()),e=this.graph.deltaPosition(e,-c,this.getYAxis())),2==this.handleSelected&&(f.y=this.graph.deltaPosition(f.y,c,this.getYAxis()),d=this.graph.deltaPosition(d,b,this.getXAxis()),e=this.graph.deltaPosition(e,-c,this.getYAxis())),3==this.handleSelected&&(d=this.graph.deltaPosition(d,b,this.getXAxis()),e=this.graph.deltaPosition(e,c,this.getYAxis())),4==this.handleSelected&&(f.x=this.graph.deltaPosition(f.x,b,this.getXAxis()),d=this.graph.deltaPosition(d,-b,this.getXAxis()),e=this.graph.deltaPosition(e,c,this.getYAxis()))
}{this.graph.getPxRel(d,this.getXAxis()),this.graph.getPxRel(e,this.getYAxis())}this.setData("width",d),this.setData("height",e)}else{var h=(this.getXAxis().isFlipped(),this.getYAxis().isFlipped(),f.x),i=f.y,j=g.x,k=g.y;if(this.moving)return f.x=this.graph.deltaPosition(f.x,b,this.getXAxis()),f.y=this.graph.deltaPosition(f.y,c,this.getYAxis()),g.x=this.graph.deltaPosition(g.x,b,this.getXAxis()),g.y=this.graph.deltaPosition(g.y,c,this.getYAxis()),this.setData("pos",f),this.setData("pos2",g),void this.setPosition();switch(this.options.handles.type){case"sides":switch(this.sides[this.handleSelected]){case"left":f.x=this.graph.deltaPosition(f.x,b,this.getXAxis());break;case"right":g.x=this.graph.deltaPosition(g.x,b,this.getXAxis());break;case"top":f.y=this.graph.deltaPosition(f.y,c,this.getYAxis());break;case"bottom":g.y=this.graph.deltaPosition(g.y,c,this.getYAxis())}break;case"corners":default:1==this.handleSelected?(h=this.graph.deltaPosition(h,b,this.getXAxis()),i=this.graph.deltaPosition(i,c,this.getYAxis())):2==this.handleSelected?(j=this.graph.deltaPosition(j,b,this.getXAxis()),i=this.graph.deltaPosition(i,c,this.getYAxis())):3==this.handleSelected?(k=this.graph.deltaPosition(k,c,this.getYAxis()),j=this.graph.deltaPosition(j,b,this.getXAxis())):4==this.handleSelected&&(h=this.graph.deltaPosition(h,b,this.getXAxis()),k=this.graph.deltaPosition(k,c,this.getYAxis())),g.x=j,g.y=k,f.x=h,f.y=i}this.setData("pos2",g)}this.setData("pos",f),this.setPosition()}},setHandles:function(){if(!this.isLocked()&&this.handlesInDom&&void 0!=this.currentX)switch(this.options.handles.type){case"sides":this.handles.left&&this.handles.left.setAttribute("transform","translate("+this.currentX+" "+(this.currentY+this.currentH/2)+")"),this.handles.right&&this.handles.right.setAttribute("transform","translate( "+(this.currentX+this.currentW)+" "+(this.currentY+this.currentH/2)+")"),this.handles.top&&this.handles.top.setAttribute("transform","translate( "+(this.currentX+this.currentW/2)+" "+this.currentY+")"),this.handles.bottom&&this.handles.bottom.setAttribute("transform","translate( "+(this.currentX+this.currentW/2)+" "+(this.currentY+this.currentH)+")");break;case"corners":default:this.handle1.setAttribute("x",this.currentX),this.handle1.setAttribute("y",this.currentY),this.handle2.setAttribute("x",this.currentX+this.currentW),this.handle2.setAttribute("y",this.currentY),this.handle3.setAttribute("x",this.currentX+this.currentW),this.handle3.setAttribute("y",this.currentY+this.currentH),this.handle4.setAttribute("x",this.currentX),this.handle4.setAttribute("y",this.currentY+this.currentH)}},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2"),this.setDom("fill","rgba(255, 0, 0, 0.1)")}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.peakintegration2d"]=function(a){var c=function(a,b){this.options=b||{},this.init(a),this.nbHandles=4,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"rect"),this._dom.element=this},redrawImpl:function(){this.setPosition(),this.setHandles(),this.setBindableToDom(this._dom)}}),c}(c["./shapes/graph.shape.rect"]),c["./shapes/graph.shape.peakinterval"]=function(a){var c=function(a){this.init(a)};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line"),this._dom.setAttribute("marker-end","url(#verticalline"+this.graph._creation+")"),this._dom.setAttribute("marker-start","url(#verticalline"+this.graph._creation+")")},setLabelPosition:function(a){var b=this._getPosition(this.getFromData("pos")),c=this._getPosition(this.getFromData("pos2"),this.getFromData("pos"));this._setLabelPosition(a,this._getPosition(this.get("labelPosition",a),{x:(b.x+c.x)/2+"px",y:(b.y+c.y)/2+"px"}))},afterDone:function(){}}),c}(c["./shapes/graph.shape.line"]),c["./shapes/graph.shape.peakinterval2"]=function(a){var c=5,d=function(a,b){this.options=b||{},this.init(a),this.nbHandles=2,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(d.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line"),this.line1=document.createElementNS(this.graph.ns,"line"),this.line2=document.createElementNS(this.graph.ns,"line"),this.group.appendChild(this.line1),this.group.appendChild(this.line2),this.line1.setAttribute("stroke","black"),this.line2.setAttribute("stroke","black"),this._dom.element=this},redrawImpl:function(){this.setPosition(),this.setPosition2(),this.setHandles(),this.redrawLines(c),this.setBindableToDom(this._dom)},redrawLines:function(a){var b=this.findxs(),c=this._getPosition({x:b[0]}),d=this._getPosition({x:b[1]});c.x&&d.x&&this.currentPos2y&&this.currentPos1y&&(this.line1.setAttribute("x1",c.x),this.line1.setAttribute("x2",c.x),this.line2.setAttribute("x1",d.x),this.line2.setAttribute("x2",d.x),this.setLinesY(a))},setLinesY:function(a){this.line1.setAttribute("y1",this.currentPos2y-a),this.line1.setAttribute("y2",this.currentPos2y+a),this.line2.setAttribute("y1",this.currentPos1y-a),this.line2.setAttribute("y2",this.currentPos1y+a)},findxs:function(){var a=this._getPosition(this.getFromData("pos")),b=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),c=Math.abs(a.x-b.x),d=Math.min(a.x,b.x);if(this.reversed=d==b.x,2>c||0>d+c||d>this.graph.getDrawingWidth())return!1;{var e,f,g,h,i,j,d,k,l,m,n=this.serie.searchClosestValue(this.getFromData("pos").x),o=this.serie.searchClosestValue(this.getFromData("pos2").x);Number.MAX_VALUE}if(!n||!o)return!1;n.xBeforeIndex>o.xBeforeIndex&&(e=n,n=o,o=e);var l,m,p,q,r=0,s=(this.scaling,[]),t=[];for(f=n.dataIndex;f<=o.dataIndex;f++){for(h=f==n.dataIndex?n.xBeforeIndexArr:0,i=f==o.dataIndex?o.xBeforeIndexArr:this.serie.data[f].length,j=0,g=h;i>=g;g+=2)d=this.serie.data[f][g+0],k=this.serie.data[f][g+1],l||(l=d,m=k),void 0==p&&(p=d,q=k),r+=Math.abs((d-p)*(k-q)*.5),s.push(r),t.push(d),p=d,q=k,j++;if(this.lastX=d,this.lastY=k,!(l&&m&&this.lastX&&this.lastY))return!1}if(0==r)return[l,p];for(var u=.05*r,v=.95*r,w=!1,x=!1,f=0,y=s.length;y>f;f++)if(s[f]>u){w=f;break}for(var f=s.length;f>0;f--)if(s[f]<v){x=f;break}return[t[w],t[x]]},highlight:function(){this.isBindable()&&(this._dom.setAttribute("stroke-width","5"),this.setLinesY(c+2))},unhighlight:function(){this.isBindable()&&(this.setStrokeWidth(),this.setLinesY(c))}}),d}(c["./shapes/graph.shape.line"]),c["./shapes/graph.shape.rangex"]=function(a){var c=function(a){this.init(a)};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"rect"),this._dom.setAttribute("class","rangeRect"),this._dom.setAttribute("cursor","move");var a=this;this.nbHandles=2,this.createHandles(this.nbHandles,"g",{"stroke-width":"3",stroke:"transparent","pointer-events":"stroke",cursor:"ew-resize"},function(b){a._makeHandle(b)}),this.setDom("cursor","move"),this.doDraw=void 0},setPosition:function(){var a=this._getPosition(this.getFromData("pos")),b=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),c=Math.abs(a.x-b.x),d=Math.min(a.x,b.x);return this.reversed=d==b.x,2>c||0>d+c||d>this.graph.getDrawingWidth()?!1:(this.setDom("x",d),this.setDom("width",c),this.setDom("y",0),this.setDom("height",this.graph.getDrawingHeight()-this.graph.shift[0]),this.setHandles(d,c),!0)},setHandles:function(a,b){var c=this._getPosition(this.getFromData("pos")),d=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),b=Math.abs(c.x-d.x),a=Math.min(c.x,d.x);this.handle1.setAttribute("transform","translate("+(a-6)+" "+((this.graph.getDrawingHeight()-this.graph.shift[0])/2-10)+")"),this.handle2.setAttribute("transform","translate("+(a+b-6)+" "+((this.graph.getDrawingHeight()-this.graph.shift[0])/2-10)+")")},selectHandles:function(){},_makeHandle:function(a){a.setAttribute("id","rangeHandle"+this.graph._creation);var b=document.createElementNS(this.graph.ns,"rect");b.setAttribute("rx",0),b.setAttribute("ry",0),b.setAttribute("stroke","black"),b.setAttribute("fill","white"),b.setAttribute("width",10),b.setAttribute("height",20),b.setAttribute("x",0),b.setAttribute("y",0),b.setAttribute("shape-rendering","crispEdges"),b.setAttribute("cursor","ew-resize"),a.appendChild(b);var c=document.createElementNS(this.graph.ns,"line");c.setAttribute("x1",4),c.setAttribute("x2",4),c.setAttribute("y1",4),c.setAttribute("y2",18),c.setAttribute("stroke","black"),c.setAttribute("shape-rendering","crispEdges"),c.setAttribute("cursor","ew-resize"),a.appendChild(c);var c=document.createElementNS(this.graph.ns,"line");return c.setAttribute("x1",6),c.setAttribute("x2",6),c.setAttribute("y1",4),c.setAttribute("y2",18),c.setAttribute("stroke","black"),c.setAttribute("shape-rendering","crispEdges"),c.setAttribute("cursor","ew-resize"),a.appendChild(c),a}}),c}(c["./shapes/graph.shape.areaundercurve"]),c["./shapes/graph.shape.cross"]=function(a){var c=function(a,b){this.options=b||{},this.init(a),this.nbHandles=1,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(c.prototype,a.prototype,{getLength:function(){return this.options.length||10},createDom:function(){this._dom=document.createElementNS(this.graph.ns,"path"),this._dom.setAttribute("d","M -"+this.getLength()/2+" 0 h "+this.getLength()+" m -"+this.getLength()/2+" -"+this.getLength()/2+" v "+this.getLength())},setPosition:function(){var a=this._getPosition(this.getFromData("pos"));if(a.x&&a.y)return this.setDom("transform","translate( "+a.x+", "+a.y+")"),this.currentPos1x=a.x,this.currentPos1y=a.y,!0},redrawImpl:function(){this.setPosition(),this.setHandles()},handleCreateImpl:function(){},handleMouseDownImpl:function(){return this.moving=!0,!0},handleMouseUpImpl:function(){return this.triggerChange(),!0},handleMouseMoveImpl:function(a,b,c){if(!this.isLocked()){{var d=this.getFromData("pos");this.getFromData("pos2")}return this.moving&&(d.x=this.graph.deltaPosition(d.x,b,this.getXAxis()),d.y=this.graph.deltaPosition(d.y,c,this.getYAxis())),this.redrawImpl(),!0}},setHandles:function(){this.isLocked()||this._selected&&void 0!=this.currentPos1x&&(this.addHandles(),this.handle1.setAttribute("x",this.currentPos1x),this.handle1.setAttribute("y",this.currentPos1y))},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2")}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.zoom2d"]=function(a){var c=function(a,b){this.init(a),this.options=b||{},this.series=[]};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"g");var a=document.createElementNS(this.graph.ns,"rect");a.setAttribute("rx",3),a.setAttribute("ry",3),a.setAttribute("height",100),a.setAttribute("width",6),a.setAttribute("fill","rgb(150, 140, 180)"),a.setAttribute("stroke","rgb( 40, 40, 40 )"),a.setAttribute("stroke-width","1px"),a.setAttribute("x",0),a.setAttribute("y",0),this.rect=a,this._dom.appendChild(a);var b=document.createElementNS(this.graph.ns,"rect");b.setAttribute("height",5),b.setAttribute("width",12),b.setAttribute("fill","rgb(190, 180, 220)"),b.setAttribute("stroke","rgb( 40, 40, 40 )"),b.setAttribute("stroke-width","1px"),b.setAttribute("x",-3),b.setAttribute("y",0),b.setAttribute("class","positive"),b.setAttribute("cursor","pointer");var c=document.createElementNS(this.graph.ns,"rect");c.setAttribute("height",5),c.setAttribute("width",12),c.setAttribute("fill","rgb(190, 180, 220)"),c.setAttribute("stroke","rgb( 40, 40, 40 )"),c.setAttribute("stroke-width","1px"),c.setAttribute("x",-3),c.setAttribute("y",0),c.setAttribute("class","negative"),c.setAttribute("cursor","pointer"),this._dom.appendChild(b),this._dom.appendChild(c),this.handlePos=b,this.handleNeg=c},setPosition:function(){var a=this._getPosition(this.getFromData("pos"));if(a&&a.x&&a.y)return this.setDom("transform","translate("+a.x+", "+a.y+")"),!0},setHandleNeg:function(a){this.handleNeg.setAttribute("y",45*a+55)},setHandlePos:function(a){this.handlePos.setAttribute("y",45*(1-a))},redrawImpl:function(){this.setPosition()},handleCreateImpl:function(){this.resize=!0,this.handleSelected=2},handleMouseDownImpl:function(a){return this.selected="positive"==a.target.getAttribute("class")?"positive":"negative"==a.target.getAttribute("class")?"negative":!1,!0},handleMouseUpImpl:function(){return this.selected=!1,this.triggerChange(),!0},addSerie:function(a){this.series.push(a)},handleMouseMoveImpl:function(a){var c=b(this._dom).offset(),d=a.pageY-c.top;"negative"==this.selected&&(d>100?d=100:55>d&&(d=55),d=-(d-55)/45,this.series.map(function(a){a.onMouseWheel(!1,!1,d,!1)})),"positive"==this.selected&&(0>d?d=0:d>45&&(d=45),d=(45-d)/45,this.series.map(function(a){a.onMouseWheel(!1,!1,d,!0)}))},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2")},hideHandleNeg:function(){this.handleNeg.setAttribute("display","none"),this.rect.setAttribute("height",45)},showHandleNeg:function(){this.handleNeg.setAttribute("display","block"),this.rect.setAttribute("height",100)},setHandles:function(){}}),c}(c["./shapes/graph.shape"]),c["./graph.toolbar"]=function(){function a(){var a=document.createElementNS(g,"svg");return a.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),a.setAttribute("xmlns",g),a}function c(){var b=a(),c=document.createElementNS(g,"line");return c.setAttribute("x1",16),c.setAttribute("y1",3),c.setAttribute("x2",4),c.setAttribute("y2",15),c.setAttribute("stroke","#aa0000"),b.appendChild(c),b}function d(){var b=a(),c=document.createElementNS(g,"rect");return c.setAttribute("x",4),c.setAttribute("y",4),c.setAttribute("width",12),c.setAttribute("height",12),c.setAttribute("stroke","black"),c.setAttribute("fill","#dd0000"),b.appendChild(c),b}function e(){var b="M 4,18 C 8,10 14,1 18,18",c=a(),d=document.createElementNS(g,"path");d.setAttribute("d",b),d.setAttribute("stroke","black"),d.setAttribute("fill","transparent");var e=document.createElementNS(g,"path");return e.setAttribute("d",b+" Z"),e.setAttribute("stroke","red"),e.setAttribute("fill","rgba(255, 0, 0, 0.1)"),c.appendChild(e),c.appendChild(d),c}var f={buttons:["none","rect","line","areaundercurve"]},g="http://www.w3.org/2000/svg",h=function(a,c){var d=this;this.options=b.extend(!0,{},f,c),this.graph=a,this.div=b("<ul />").addClass("graph-toolbar"),this.graph.getPlugin("./graph.plugin.shape").then(function(a){d.plugin=a,d.plugin&&(d.div.on("click","li",function(){var a=b(this).attr("data-shape");d.plugin.setShape(a),b(this).parent().children().removeClass("selected"),b(this).addClass("selected")}),d.makeButtons())})};return h.prototype={makeButtons:function(){for(var a=0,b=this.options.buttons.length;b>a;a++)this.div.append(this.makeButton(this.options.buttons[a]))},makeButton:function(a){var f=b("<li />");switch(a){case"line":f.html(c()).attr("data-shape","line");break;case"rect":f.html(d()).attr("data-shape","rect");break;case"areaundercurve":f.html(e()).attr("data-shape","areaundercurve")}return f},getDom:function(){return this.div}},h}(),c["./graph.core"].getBuild=function(a){return c[a]},c["./graph.core"]};if("function"==typeof define&&define.amd)define(["jquery"],function(a){return b(a)});else if(a){if(!a.jQuery)throw"jQuery has not been loaded. Abort graph initialization.";a.Graph=b(a.jQuery)}});