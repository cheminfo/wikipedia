'use strict';define(["jquery","modules/default/defaultcontroller","src/data/structures","src/util/aceHelper"],function(a,b,c,d){"use strict";function e(){}function f(a){try{return JSON.parse(a)}catch(a){return null}}return a.extend(!0,e.prototype,b),e.prototype.moduleInformation={name:"Code editor",description:"Write code in any language and send the content to another module",author:"Micha\xEBl Zasso",date:"27.08.2014",license:"MIT"},e.prototype.references={data:{label:"String containing the code"},jsonValue:{label:"JSON-parsed value"},typedValue:{label:"The typed value"}},e.prototype.events={onEditorChange:{label:"The value in the editor has changed",refVariable:["data","jsonValue","typedValue"]},onButtonClick:{label:"The button was clicked",refAction:["data","jsonValue"],refVariable:["data","jsonValue","typedValue"]}},e.prototype.variablesIn=["data"],e.prototype.configurationStructure=function(){for(var a=c._getList(),b=a.length,e=Array(b),f=0;f<b;f++)e[f]={key:a[f],title:a[f]};const g={groups:{group:{options:{type:"list"},fields:{mode:{type:"combo",title:"Mode",options:[{title:"Text",key:"text"},{title:"Javascript",key:"javascript"},{title:"JSON",key:"json"},{title:"YAML",key:"yaml"},{title:"HTML",key:"html"},{title:"XML",key:"xml"},{title:"Markdown",key:"markdown"},{title:"LaTeX",key:"latex"}],default:"text"},outputType:{type:"combo",title:"Type of output value (optional)",options:e},btnvalue:{type:"text",title:"Button text",default:"Send script"},iseditable:{title:"Display editor",default:["editable"],type:"checkbox",options:{editable:"Show the code editor"}},hasButton:{title:"Display button",default:["button"],type:"checkbox",options:{button:"Show the button"}},variable:{title:"Variable",type:"checkbox",options:{modify:"Modify input variable"},default:[]},storeOnChange:{title:"On change",type:"checkbox",options:{store:"Store value in the preferences on change"},default:[]},debouncing:{title:"Debouncing",type:"float",default:0},script:{type:"jscode",title:"Code",mode:"html"}}}}};return g.groups.ace=d.getConfig(),d.getConfig(),g},e.prototype.configAliases=Object.assign(d.getAliases("ace"),{mode:["groups","group",0,"mode",0],btnvalue:["groups","group",0,"btnvalue",0],iseditable:["groups","group",0,"iseditable",0],hasButton:["groups","group",0,"hasButton",0],script:["groups","group",0,"script",0],outputType:["groups","group",0,"outputType",0],variable:["groups","group",0,"variable",0],storeOnChange:["groups","group",0,"storeOnChange",0],debouncing:["groups","group",0,"debouncing",0]}),e.prototype.onEditorChanged=function(a,b){!b&&this.module.getConfigurationCheckbox("variable","modify")&&"string"===DataObject.getType(this.module.view._data)&&(this.module.view._data.setValue(a,!0),this.module.model.dataTriggerChange(this.module.view._data)),this.createDataFromEvent("onEditorChange","data",a);var c=f(a);this.createDataFromEvent("onEditorChange","jsonValue",c);var d=this.getTypedValue(a);null!==d&&this.createDataFromEvent("onEditorChange","typedValue",d)},e.prototype.onButtonClick=function(a){this.createDataFromEvent("onButtonClick","data",a),this.sendActionFromEvent("onButtonClick","data",a);var b=f(a);this.createDataFromEvent("onButtonClick","jsonValue",b),this.sendActionFromEvent("onButtonClick","jsonValue",b);var c=this.getTypedValue(a);null!==c&&this.createDataFromEvent("onButtonClick","typedValue",c)},e.prototype.getTypedValue=function(a){var b=this.module.getConfiguration("outputType");return b?{type:this.module.getConfiguration("outputType"),value:a}:null},e});
