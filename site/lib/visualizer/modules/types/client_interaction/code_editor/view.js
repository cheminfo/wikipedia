"use strict";define(["modules/default/defaultview","src/util/util","ace/ace","src/util/context","jquery","lodash"],function(a,b,c,d,e,f){function g(){}return e.extend(!0,g.prototype,a,{init:function(){this._id=b.getNextUniqueId(),this._code="";var a=this.table=e("<table>").css({height:"100%",width:"100%"}),c=e("<tr>").appendTo(a).css("height","auto");this.buttonRow=e("<tr>").appendTo(a).css("height","30px"),this.editorCell=e("<td>").css("height","100%").appendTo(c),this.buttonCell=e("<td>").appendTo(this.buttonRow).css("text-align","center");var d=this.module.getConfiguration("debouncing");d>0?this.editorChangedDebounced=f.debounce(this.editorChanged,d):this.editorChangedDebounced=this.editorChanged,this.module.getDomContent().html(a)},inDom:function(){var a=this,b=this.module.getConfiguration("script")||"";if(this._code=b,this.module.getConfigurationCheckbox("iseditable","editable")){this.editable=!0,e('<div id="'+this._id+'"></div>').css("height","100%").css("width","100%").appendTo(this.editorCell),this.editor=c.edit(this._id);var d="./mode/"+this.module.getConfiguration("mode");this.editor.$blockScrolling=1/0,this.editor.getSession().setMode(d),this.editor.setValue(b,-1),this.editor.getSession().on("change",function(){a.editorChangedDebounced()}),this.editorChanged()}this.module.getConfigurationCheckbox("hasButton","button")?this.buttonCell.append(e("<span>"+this.module.getConfiguration("btnvalue")+"</span>").addClass("form-button").on("click",function(){a.module.controller.onButtonClick(a._code)})):this.buttonRow.remove(),this.resolveReady()},update:{data:function(a){this._data=a;var b=String(a.get());this._code=b,this.editable&&(this.editor.setValue(b),this.editor.scrollToLine(0),this.editor.clearSelection(),this.editorChanged())}},editorChanged:function(){var a=this.editor.getValue();this._code=a,this.module.getConfigurationCheckbox("storeOnChange","store")&&this.module.definition.configuration.groups&&(this.module.definition.configuration.groups.group[0].script[0]=a),this.module.controller.onEditorChanged(this._code)},onResize:function(){this.editor&&this.editor.resize()}}),g});