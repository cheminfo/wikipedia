define(["../../../default/defaultview"],function(Default){function view(){}return view.prototype=$.extend(!0,{},Default,{init:function(){var self=this,cfg=$.proxy(this.module.getConfiguration,this.module);if(this.dom=$("<div></div>"),this.search=$('<table class="Search" cellpadding="5" cellspacing="0"><col width="100"><col width="*"></table>').css("width","90%"),this.dom.append(this.search),this.module.getDomContent().html(this.dom),this.oldVal={},searchparams=cfg("searchparams")){for(var i in searchparams)i&&searchparams[i].label&&this.search.append("<tr><td><nobr>"+searchparams[i].label+"</nobr></td><td>"+this._makeFormEl(searchparams[i],i)+"</td></tr>");this.button=cfg("button",!1),this.button&&require(["forms/button"],function(a){self.search.append((self.buttonInst=new a(cfg("buttonlabel")||"Search",function(){self.module.controller.doSearch()})).render())}),this.search.on("keyup","input[type=text]",function(){var a=$(this).val(),b=$(this).attr("name");self.oldVal[b]&&self.oldVal[b]===a||$(this).trigger("change"),void 0!==b&&(self.module.controller.searchTerms[b]=a),self.button||self.module.controller.doSearch()}),this.search.on("change","select, input[type=text]",function(){var a=$(this).val(),b=$(this).attr("name");void 0!==b&&(self.module.controller.searchTerms[b]=a),self.button||self.module.controller.doSearch()}),this.search.on("change","input[type=checkbox]",function(){var a=$(this).is(":checked"),b=$(this).attr("name");void 0!==b&&(self.module.controller.searchTerms[b]=a),self.button||self.module.controller.doSearch()})}cfg("resultfilter")?eval("self.module.resultfilter = function(data) { try { \n "+cfg("resultfilter")+"\n } catch(_) { console.log(_); } }"):delete self.module.resultfilter,this.resolveReady()},_makeFormEl:function(a){switch(a.fieldtype){case"combo":var b,c=(a.fieldoptions||"").split(";"),d="";d+="<option "+(""==a.defaultvalue?'selected="selected" ':"")+'value=""></option>';for(var e=0,f=c.length;f>e;e++)b=c[e].split(":"),d+="<option "+(a.defaultvalue==b[0]?'selected="selected" ':"")+'value="'+b[0]+'">'+(b[1]||b[0])+"</option>";return'<select name="'+a.name+'">'+d+"</select>";case"checkbox":return'<input type="checkbox" '+(a.defaultvalue?'checked="checked"':"")+' value="1" offvalue="0" name="'+a.name+'" /></div>';default:case"text":return'<input type="text" value="'+(a.defaultvalue||"")+'" name="'+a.name+'" style="width: 100%" /></div>'}},inDom:function(){this.search.find("input:last").trigger("change")},lock:function(){this.locked=!0,this.buttonInst&&(this.buttonInst.setTitle(this.module.getConfiguration("buttonlabel_exec","Loading...")||"Loading..."),this.buttonInst.disable())},unlock:function(){this.locked=!1,this.buttonInst&&(this.buttonInst.setTitle(this.module.getConfiguration("buttonlabel","Search")||"Search"),this.buttonInst.enable())},update:{vartrigger:function(a){void 0!=a&&this.module.controller.doSearch()}},getDom:function(){return this.dom},typeToScreen:{}}),view});