"use strict";define(["jquery","modules/default/defaultview","forms/form"],function(a,b,c){function d(){}return a.extend(!0,d.prototype,b,{init:function(){this.dom=a("<div />"),this.module.getDomContent().html(this.dom),this.callback=null},inDom:function(){var b,d=this,e=this.module.getConfiguration("structure"),f=this.module.getConfiguration("tpl_file"),g=this.module.getConfiguration("tpl_html");try{b=JSON.parse(e)}catch(a){return}if(this.module.getConfigurationCheckbox("options","defaultTpl")){var h=new c({});return h.init({onValueChanged:d.onChange.bind(d)}),h.setStructure(b),h.onStructureLoaded().done(function(){h.fill()}),void h.onLoaded().done(function(){d.dom.html(h.makeDom(1)),h.inDom()})}var i;i=f?a.get(f,{}):g,a.when(i).done(function(a){var e=new c({});e.init({onValueChanged:d.onChange.bind(d)}),e.setStructure(b),e.onStructureLoaded().done(function(){e.fill({})}),e.onLoaded().done(function(){e.setTpl(a),d.dom.html(e.makeDomTpl()),e.inDom(),d.resolveReady()})})},onChange:function(a,b){this.module.controller.dataChanged(b)}}),d});