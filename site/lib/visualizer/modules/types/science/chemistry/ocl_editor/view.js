'use strict';define(["modules/default/defaultview","src/util/ui","openchemlib/openchemlib-full"],function(a,b,c){"use strict";function d(){}return $.extend(!0,d.prototype,a,{init:function(){this.editor=null},inDom:function(){this.dom=$("<div>").css({height:"99%",width:"100%"}),this.module.getDomContent().html(this.dom)},onResize:function(){this.dom.empty(),this.initEditor()},blank:{mol:function(){this.clearEditor()},molV3:function(){this.clearEditor()},smiles:function(){this.clearEditor()},actid:function(){this.clearEditor()}},onActionReceive:{setMolfile:function(a){this._currentValue&&this._currentValue.setValue?this._currentValue.setValue(a):this._currentValue=a,this._currentType="molV3",this.editor.setMolFile(a),this.setFragment()},copyMolfile:function(){const a=this.editor.getMolFileV3();b.copyToClipboard(a,{successMessage:"Molfile copied to the clipboard"})},downloadSvg:function(){let a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};const c=a.width,d=void 0===c?800:c,e=a.height,f=void 0===e?600:e,g=this.editor.getMolecule(),h=g.toSVG(d,f);b.downloadFile(h,"molecule.svg",{mimeType:"application/svg;charset=utf-8"})},downloadMolfile:function(){const a=this.editor.getMolFile();b.downloadFile(a,"molecule.mol",{mimeType:"chemical/x-mdl-molfile"})}},update:{mol:function(a){this._currentValue=a,this._currentType="mol",this.editor.setMolFile(a.get()+""),this.setFragment()},molV3:function(a){this._currentValue=a,this._currentType="molV3",this.editor.setMolFile(a.get()+""),this.setFragment()},smiles:function(a){this._currentValue=a,this._currentType="smiles",this.editor.setSmiles(a.get()+""),this.setFragment()},actid:function(a){this._currentValue=a,this._currentType="oclid";var b=a.get()+"";a.coordinates&&(b+=` ${a.coordinates}`),this.editor.setIDCode(b),this.setFragment()}},initEditor:function(){var a=this.module.controller,b=this.module.getConfigurationCheckbox("prefs","svg");this.editor=new c.StructureEditor(this.dom.get(0),b,1),this.editor.setChangeListenerCallback(this.module.controller.onChange.bind(a)),this.editor.setIDCode(`${a.currentMol.idCode} ${a.currentMol.coordinates}`),this.setFragment(),this.resolveReady()},clearEditor:function(){this._currentValue=null,this._currentType=null,this.editor.setIDCode("")},setFragment:function(){this.module.getConfigurationCheckbox("prefs","queryFeatures")?this.editor.setFragment(!0):this.editor.setFragment(!1)}}),d});
